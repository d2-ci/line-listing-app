(self.webpackChunkline_listing_app=self.webpackChunkline_listing_app||[]).push([[2143],{328:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Fe});var a=n(3135),i=n(8594),r=n(4479),l=n(6329),o=n(3338),s=n(1006),d=n.n(s),u=n(3665),c=n.n(u),p=n(2085),m=n(1475),g=n(9551),f=n(2703),v=n(8107),y=n(9308),h=n(760),S=n(7538),E=n(1054),_=n(101),z=n(969),I=n(5215),w=n(1250),T=n(9647),b=n(7646),C=n(1949),x=n(2305),V=n(6206),N=n.n(V);const D="NORMAL",k={displayDensity:{defaultValue:"NORMAL",requestable:!1,savable:!0},fontSize:{defaultValue:D,requestable:!1,savable:!0},digitGroupSeparator:{defaultValue:"SPACE",requestable:!1,savable:!0},showHierarchy:{defaultValue:!1,requestable:!1,savable:!0},skipRounding:{defaultValue:!1,requestable:!0,savable:!0}},R=e=>Object.entries(k).filter((e=>e[1].requestable)).reduce(((t,n)=>{let[a,i]=n;return void 0!==e[a]&&e[a]!==i.defaultValue&&(t[a]=e[a]),t}),{});var P=n(5633),W=n(9941),M=n.n(W),A=n(5133);new Set([A.P6,A.qI,A.xi,A.PH,A.M6]),new Set([A.zC]);const L="STATUS",Z="USER",O="programStatus",K="eventStatus",q="createdBy",F="lastUpdatedBy",U="eventDate",H="enrollmentDate",$="incidentDate",j="scheduledDate",Q="lastUpdated",B="created",G=new Set([U,H,$,j,Q]);var X=n(4805),Y=n(1517),J=n(2150);const ee="COMPLETED",te="EVENT",ne="ENROLLMENT",ae="TRACKED_ENTITY_INSTANCE",ie={[X.rx]:"ouname",[O]:"programstatus",[K]:"eventstatus",[q]:"createdbydisplayname",[F]:"lastupdatedbydisplayname",[U]:"eventdate",[H]:"enrollmentdate",[$]:"incidentdate",[j]:"scheduleddate",[Q]:"lastupdated"},re=e=>{let{showHierarchy:t}=e;const n=Object.assign({},ie);return t&&(n[X.rx]="ounamehierarchy"),n},le={[te]:U,[ne]:H},oe=(e,t)=>{let{outputType:n,type:a}=t;return e.filter((e=>!["longitude","latitude"].includes(e.dimension))).map((e=>e.dimensionType===A.cl?{...e,dimensionType:A.P6}:e.dimension===X.vi&&a===J.UU?{...e,dimension:le[n],dimensionType:A.KV}:e))},se=(J.UU,J.Zp,e=>{let{dimensionId:t,programStageId:n,programId:a,outputType:i}=e;return[i===ae?a:void 0,n,t].filter((e=>e)).join(".")}),de=(e,t)=>{let n;const[a,i,r]=(e||"").split(".").reverse();let l=r;(r||t!==ae)&&(n=i),t!==ae||r||(l=i);const[o,s]=(n||"").split("[");return{dimensionId:a,programStageId:o,...l?{programId:l}:{},repetitionIndex:(null==s?void 0:s.length)&&s.substring(0,s.indexOf("]"))}},ue=e=>{let{value:t,header:n={},visualization:a={}}=e;return n.name&&[ie.eventStatus,ie[O]].includes(de(n.name,a.type).dimensionId)?{ACTIVE:v.Z.t("Active"),CANCELLED:v.Z.t("Cancelled"),[ee]:v.Z.t("Completed"),SCHEDULE:v.Z.t("Scheduled")}[t]||t:[m.$d,m.Wt].includes(n.valueType)?t&&M()(t).format(n.name===ie.lastUpdated||n.valueType===m.Wt?"yyyy-MM-DD hh:mm":"yyyy-MM-DD"):(null==n?void 0:n.valueType)===m.H?t&&M()(t).format("yyyy-MM-DD"):(0,P.Q)(t,n.valueType||m.kl,n.optionSet?{}:{digitGroupSeparator:a.digitGroupSeparator,skipRounding:!1})},ce=function(){let{stageOffset:e,column:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!t)return"";if(Number.isInteger(e)){let n;return 0===e?n=v.Z.t("most recent"):1===e?n=v.Z.t("oldest"):e>1?n=v.Z.t("oldest {{repeatEventIndex}}",{repeatEventIndex:"+"+(e-1)}):e<0&&(n=v.Z.t("most recent {{repeatEventIndex}}",{repeatEventIndex:e})),`${t} (${n})`}return t};var pe=n(625);const me=e=>(0,pe.X)(e).some((e=>{let{dimensionType:t,dimension:n,items:a}=e;return(t===A.KV||G.has(n))&&Array.isArray(a)&&a.length>0})),ge=[B,q,F],fe=e=>G.has(e),ve=(e,t,n)=>{const a=[];return e.forEach((e=>{const i=e.dimension;var r;if(fe(i)||i===K||i===O||i===B||i===X.rx&&n===ae){if(null!==(r=e.items)&&void 0!==r&&r.length){var l;const n=null===(l=e.items)||void 0===l?void 0:l.map((e=>e.id));(i===O||fe(i))&&Array.isArray(t[i])?t[i].push(...n):i===X.rx?a.push(e):t[i]=n}}else ge.includes(i)||a.push(e)})),a},ye=e=>{const t=e.outputType,n=R(e),a=ve(e[Y.Aq],n,t),i=ve(e[Y.dQ],n,t),r=ve(e[Y.lT],n,t),l=re(e),o=[...e[Y.Aq],...e[Y.dQ]].map((e=>{var n;let{dimension:a,program:i,programStage:r,repetition:o}=e;const s=null==r?void 0:r.id;return null!=o&&null!==(n=o.indexes)&&void 0!==n&&n.length?o.indexes.map((e=>se({programId:null==i?void 0:i.id,programStageId:`${s}[${e}]`,dimensionId:l[a]||a,outputType:t}))):se({programId:null==i?void 0:i.id,programStageId:s,dimensionId:l[a]||a,outputType:t})}));return{adaptedVisualization:{[Y.Aq]:a,[Y.dQ]:i,[Y.lT]:r,outputType:t},headers:o,parameters:n}},he={[ne]:"enrollments",[te]:"events",[ae]:"trackedEntities"},Se={legendKeyContainer:"Visualization_legendKeyContainer__4CFI-",legendKeyWrapper:"Visualization_legendKeyWrapper__nVQL9",legendKey:"Visualization_legendKey__JVpFE",legendKeyScrollbox:"Visualization_legendKeyScrollbox__xeUwY",legendKeyToggle:"Visualization_legendKeyToggle__KkZxi",pluginContainer:"Visualization_pluginContainer__oXPo4",fetchContainer:"Visualization_fetchContainer__80fuv",fetching:"Visualization_fetching__7HD9F",fetchIndicator:"Visualization_fetchIndicator__I2E9y",rotation:"Visualization_rotation__x63rs",visualizationContainer:"Visualization_visualizationContainer__05bND",noTimeDimensionWarning:"Visualization_noTimeDimensionWarning__FQgNa",stickyFooter:"Visualization_stickyFooter__Dd34A",footerCell:"Visualization_footerCell__Fncu5",stickyNavigation:"Visualization_stickyNavigation__0J6KV",dataTable:"Visualization_dataTable__5lDA5",headerCell:"Visualization_headerCell__4qkrt",dimensionModalHandler:"Visualization_dimensionModalHandler__yWmOU",fontSizeLarge:"Visualization_fontSizeLarge__z2BH2",fontSizeNormal:"Visualization_fontSizeNormal__jf7Sh",fontSizeSmall:"Visualization_fontSizeSmall__FfsnC",sizeComfortable:"Visualization_sizeComfortable__Su+7Q",sizeNormal:"Visualization_sizeNormal__gHiph",sizeCompact:"Visualization_sizeCompact__8D9I5",cell:"Visualization_cell__6WA8H",emptyCell:"Visualization_emptyCell__5ufEQ",nowrap:"Visualization_nowrap__L4Sfl",undefinedCell:"Visualization_undefinedCell__LHsvF",error:"Visualization_error__18KVZ"};var Ee=n(1442);const _e="NV",ze=()=>({1:v.Z.t("Yes"),0:v.Z.t("No"),[_e]:v.Z.t("Not answered")}),Ie=(e,t)=>e?`${e}.${t}`:t,we=e=>({[X.rx]:{id:X.rx,dimensionType:A.e5,name:Te(e)}}),Te=e=>e===ae?v.Z.t("Registration org. unit"):v.Z.t("Organisation unit"),be=function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0;return"ND"===(null===(e=(t[n]||{})[a])||void 0===e?void 0:e.valueStatus)},Ce=e=>{let{rowValue:t,header:n,metaDataItems:a,isUndefined:i}=e;switch(n.valueType){case m.zU:case m.mb:return i?"":ze()[t||_e];default:var r,l;return t?n.optionSet?(null===(l=((e,t,n)=>{const a=null==n?void 0:n[e];var i;if(a)return n[null===(i=a.options.find((e=>e.code===t)))||void 0===i?void 0:i.uid]})(n.optionSet,t,a))||void 0===l?void 0:l.name)||t:(null===(r=a[t])||void 0===r?void 0:r.name)||t:t}},xe=async e=>{let{analyticsEngine:t,visualization:n,pageSize:a,page:i,relativePeriodDate:r,sortField:l,sortDirection:o,displayProperty:s}=e;const{adaptedVisualization:d,headers:u,parameters:c}=ye(n);let p=(new t.request).fromVisualization(d).withParameters({headers:u,totalPages:!1,...n.outputType!==te?{rowContext:!0}:{},...c}).withDisplayProperty(s.toUpperCase()).withPageSize(a).withPage(i).withIncludeMetadataDetails();var m;(n.outputType!==ae&&(p=p.withProgram(n.program.id).withOutputType(n.outputType)),n.outputType===te)&&(p=p.withStage(null===(m=n.programStage)||void 0===m?void 0:m.id));if(n.outputType===ae&&(p=p.withTrackedEntityType(n.trackedEntityType.id)),r&&me(n)&&(p=p.withRelativePeriodDate(r)),l)switch(o){case"asc":p=p.withAsc(l);break;case"desc":p=p.withDesc(l)}const g=(f=n.outputType,he[f]);var f;return await t[g].getQuery(p)},Ve={resource:"legendSets",params:e=>{let{ids:t}=e;return{fields:"id,displayName~rename(name),legends[id,displayName~rename(name),startValue,endValue,color]",filter:`id:in:[${t.join(",")}]`}}},Ne=async e=>{let{legendSetIds:t,dataEngine:n}=e;if(!t.length)return[];const a=await(async e=>{let{dataEngine:t,ids:n}=e;return(await t.query({legendSets:Ve},{variables:{ids:n}})).legendSets.legendSets})({dataEngine:n,ids:t});return a},De=(e,t)=>{const n={...(a=t)===ae?{...we(a),[B]:{id:B,dimensionType:A.KV,name:v.Z.t("Registration date")}}:{},[Q]:{id:Q,dimensionType:A.KV,name:v.Z.t("Last updated on")},[q]:{id:q,dimensionType:Z,name:v.Z.t("Created by")},[F]:{id:F,dimensionType:Z,name:v.Z.t("Last updated by")}};var a;const i=(e=>{let{dimensionIds:t,metadata:n,inputType:a}=e;const i=t.map((e=>{const{dimensionId:t,programStageId:i,programId:r}=de(e,a),l={...n[e],dimensionId:t,programStageId:i,programId:r};return l.id||(l.id=e),l}));return[ne,ae].includes(a)?i.map((e=>{if([A.P6,A.KV].includes(e.dimensionType||e.dimensionItemType)){const a=i.filter((t=>t.dimensionId===e.dimensionId&&t!==e&&(e.programId&&t.programId||e.programStageId&&t.programStageId)));if(a.length>0){const i=a.find((t=>t.programId===e.programId)),l=a.filter((t=>t.programId!==e.programId)).find((e=>a.find((t=>t.programStageId!==e.programStageId&&t.programId===e.programId))));var t,r;e.suffix=i||l?null===(t=n[e.programStageId])||void 0===t?void 0:t.name:null===(r=n[e.programId])||void 0===r?void 0:r.name}}else if(a===ae&&[A.e5,L].includes(e.dimensionType||e.dimensionItemType)&&e.programId){var l;e.suffix=null===(l=n[e.programId])||void 0===l?void 0:l.name}return e})):i})({dimensionIds:e.headers.map((e=>{const{dimensionId:a,programStageId:i,programId:r}=de(e.name,t),l=Object.keys(ie).find((e=>ie[e]===a)),o=se({dimensionId:[X.rx,O].includes(l)?l:a,programStageId:i,programId:r,outputType:t});return r&&[X.rx,O].includes(l)&&(n[o]=(e=>({[Ie(e,X.rx)]:{id:Ie(e,X.rx),dimensionType:A.e5,name:Te()},[Ie(e,K)]:{id:Ie(e,K),dimensionType:L,name:v.Z.t("Event status")},[Ie(e,O)]:{id:Ie(e,O),dimensionType:L,name:v.Z.t("Program status")}}))(r)[o]),o})),metadata:{...e.metaData.items,...n},inputType:t}),r=i.map((e=>{let{name:t,suffix:n,id:a}=e;return{id:a,label:n?`${t}, ${n}`:t}}));return e.headers.map(((e,n)=>{var a;const i={...e,index:n},{dimensionId:l,programId:o,programStageId:s}=de(e.name,t),d=Object.keys(ie).find((e=>ie[e]===l));return i.column=(null===(a=r.find((e=>e.id===se({dimensionId:[X.rx,O].includes(d)?d:l,programId:o,programStageId:s,outputType:t}))))||void 0===a?void 0:a.label)||i.column,i}))},ke=e=>{let{visualization:t,filters:n,isVisualizationLoading:i,displayProperty:r,onResponsesReceived:l,pageSize:o,page:s,sortField:d,sortDirection:u}=e;const c=(0,a.bQ)(),[g]=(0,p.useState)((()=>Ee.Z.getAnalytics(c))),v=(0,p.useRef)(!1),[y,h]=(0,p.useState)(!0),[S,E]=(0,p.useState)(!0),[_,z]=(0,p.useState)(void 0),[I,w]=(0,p.useState)(null),T=null==n?void 0:n.relativePeriodDate,b=(0,p.useCallback)((async()=>{try{var e,n,a;const i=await xe({analyticsEngine:g,page:s,pageSize:o,relativePeriodDate:T,sortDirection:u,sortField:d,visualization:t,displayProperty:r}),p=De(i,t.outputType),y=((e,t)=>{const n=[];for(let a=0,i=e.rows.length;a<i;a++){const i=e.rows[a],r=[];for(let n=0,l=t.length;n<l;n++){const l=t[n],o=i[l.index];r.push(Ce({rowValue:o,header:l,metaDataItems:e.metaData.items,isUndefined:be(e.rowContext,a,n)}))}n.push(r)}return n})(i,p),S=(e=>e.rowContext)(i),_=i.metaData.pager,I=[],b=p.reduce(((e,t)=>{var n;return{...e,[t.name]:null===(n=i.metaData.items[t.name])||void 0===n?void 0:n.legendSet}}),{});(null===(e=t.legend)||void 0===e?void 0:e.strategy)===f.zv&&null!==(n=t.legend.set)&&void 0!==n&&n.id?I.push(t.legend.set.id):(null===(a=t.legend)||void 0===a?void 0:a.strategy)===f.EE&&Object.values(b).filter((e=>e)).forEach((e=>I.push(e)));const C=await Ne({legendSetIds:I,dataEngine:c});C.length&&p.filter((e=>{return t=e.valueType,[m.FV,m.SA,m.y3,m.$r,m.VX,m.M7,m.iq].includes(t);var t})).forEach((e=>{switch(t.legend.strategy){case f.zv:e.legendSet=C[0];break;case f.EE:e.legendSet=C.find((t=>t.id===b[e.name]))}})),v.current&&z(void 0),v.current&&w({headers:p,rows:y,pager:_,rowContext:S}),l(i)}catch(e){v.current&&z(e)}finally{v.current&&h(!1),v.current&&E(!1)}}),[g,s,o,T,u,d,t]);return(0,p.useEffect)((()=>(v.current=!0,()=>{v.current=!1})),[]),(0,p.useEffect)((()=>{E(!0),b()}),[t,s,o,d,u,T,b]),(0,p.useEffect)((()=>{i&&(E(!1),h(!1),z(void 0),w(null))}),[i]),{loading:y,fetching:S,error:_,data:I,isGlobalLoading:i}};function Re(){return Re=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Re.apply(this,arguments)}const Pe=(e,t)=>{if(e){var n,a;return`calc(100vh - ${285+(null!==(n=null==t||null===(a=t.current)||void 0===a?void 0:a.clientHeight)&&void 0!==n?n:0)}px)`}return"100%"},We=e=>{let{offline:t,...n}=e;return t?p.createElement(y.u,{content:v.Z.t("Not available offline")},p.createElement(h.t,n)):p.createElement(h.t,n)};We.propTypes={offline:c().bool};const Me=e=>{let{filters:t,visualization:n,isVisualizationLoading:i,displayProperty:r,onResponsesReceived:l,onColumnHeaderClick:o,onError:s,forDashboard:d}=e;const u=(0,p.useRef)(null),c=(0,p.useRef)(null),h=(0,p.useRef)(null),V=(0,p.useRef)(null),D=(0,p.useRef)(null),k=(0,p.useRef)(null),P=(0,p.useRef)(null),[W,M]=(0,p.useState)([]),[A,L]=(0,p.useState)(!1),[Z,O]=(0,p.useState)({containerMaxWidth:0,paginationMaxWidth:0,noticeBoxMaxWidth:0}),[{sortField:q,sortDirection:F,pageSize:U,page:H},$]=(0,p.useReducer)(((e,t)=>({...e,...t})),{sortField:null,sortDirection:"asc",page:1,pageSize:100}),j=(0,p.useMemo)((()=>n&&(e=>{const t=oe(e[Y.Aq],e),n=oe(e[Y.dQ],e),a=oe(e[Y.lT],e);e.completedOnly&&e.outputType===te&&a.push({dimension:K,items:[{id:ee}]});const i={...e};return delete i.completedOnly,{...i,[Y.Aq]:t,[Y.dQ]:n,[Y.lT]:a}})(n)),[n]),Q=!(null==t||!t.relativePeriodDate),B=(0,p.useMemo)((()=>me(j)),[j]),G=Q&&!B,X=(0,p.useRef)(j),J=(0,p.useCallback)((()=>{var e;if(null==u||!u.current||0===u.current.clientWidth)return;const t=u.current.clientWidth,n=u.current.querySelector(".tablescrollbox"),a=n.offsetWidth-n.clientWidth,i=t-a-((null===(e=P.current)||void 0===e?void 0:e.offsetWidth)>0?P.current.offsetWidth+4:0);O({containerMaxWidth:i,paginationMaxWidth:i-a,noticeBoxMaxWidth:n.offsetWidth})}),[]),ne=(0,p.useMemo)((()=>new window.ResizeObserver(J)),[J]),ae=(0,p.useCallback)((e=>{if(null!==e)return u.current=e,ne.observe(e),ne.disconnect}),[ne]),ie=(0,p.useCallback)((e=>{if(null!==e)return ne.observe(e),ne.disconnect}),[ne]),le=(0,p.useCallback)((e=>$({page:e})),[]),{isDisconnected:se}=(0,a.Uw)(),{headers:de}=ye(j);de&&q&&(de.flat().includes(q)||$({sortField:null,sortDirection:"asc"}));const{fetching:pe,error:ge,data:fe}=ke({filters:t,visualization:j,isVisualizationLoading:i,displayProperty:r,onResponsesReceived:l,pageSize:U,page:j!==X.current?1:H,sortField:q,sortDirection:F}),ve=(0,p.useMemo)((()=>{if(!(pe&&null!=V&&V.current&&null!=D&&D.current&&null!=k&&k.current))return"calc(50% - 12px)";const e=V.current.clientHeight,t=D.current.offsetHeight,n=e-t-k.current.offsetHeight;return`${Math.round(t+n/2-12)}px`}),[pe]);if((0,p.useEffect)((()=>{X.current=j,le(1)}),[j,le]),(0,p.useEffect)((()=>{if(fe&&j){var e;const t=fe.headers.filter((e=>e.legendSet)).map((e=>e.legendSet)),n=t.filter(((e,n)=>{var a;return t.findIndex((t=>t.id===e.id))===n&&(null===(a=e.legends)||void 0===a?void 0:a.length)}));n.length?M(n):M([]),L(null===(e=j.legend)||void 0===e?void 0:e.showKey)}else M([]),L(!1)}),[fe,j]),(0,p.useEffect)((()=>{ge&&s&&s(ge)}),[ge,s]),!fe||ge)return null;const he=(e=>{switch(e){case"COMFORTABLE":return Se.sizeComfortable;case"COMPACT":return Se.sizeCompact;default:return Se.sizeNormal}})(j.displayDensity),Ee=(e=>{switch(e){case"LARGE":return Se.fontSizeLarge;case"SMALL":return Se.fontSizeSmall;default:return Se.fontSizeNormal}})(j.fontSize),_e=String(Math.max(fe.headers.length,1)),ze=e=>{let{name:t,direction:n}=e;return $({sortField:t,sortDirection:n,page:1})},Ie=re(R(j)),we=e=>{const t=ce(e),n=Number.isInteger(e.stageOffset)?e.name.replace(/\[-?\d+\]/,""):e.name;return p.createElement("span",{className:N()(Se.headerCell,Se.dimensionModalHandler),onClick:o?()=>o((e=>Object.keys(Ie).find((t=>Ie[t]===e)))(n)||n):void 0},t)},Te=e=>{var t,n;let{columnIndex:a,value:i,isUndefined:r,props:l}=e;return p.createElement(_.W,Re({},l,{key:a,className:N()(Se.cell,Ee,he,{[Se.emptyCell]:!i,[Se.nowrap]:(o=fe.headers[a],[m.FV,m.$r,m.VX,m.M7,m.iq,m.y3,m.SA,m.zf,m.$d,m.Wt,m.so].includes(o.valueType)&&!o.optionSet),[Se.undefinedCell]:r},"bordered"),backgroundColor:(null===(t=j.legend)||void 0===t?void 0:t.style)===f.UJ?(0,f.i3)(fe.headers[a].legendSet,i):void 0,dataTest:"table-cell"}),p.createElement("div",{style:(null===(n=j.legend)||void 0===n?void 0:n.style)===f.Xr?{color:(0,f.i3)(fe.headers[a].legendSet,i)}:{}},((e,t)=>(null==t?void 0:t.valueType)===m.Xw?p.createElement("a",{href:e,target:"_blank",rel:"noreferrer"},e):ue({value:e,header:t,visualization:j}))(i,fe.headers[a])));var o};return p.createElement("div",{className:Se.pluginContainer,ref:ae},p.createElement("div",{"data-test":"line-list-fetch-container",className:N()(Se.fetchContainer,{[Se.fetching]:pe}),ref:V},p.createElement("div",{className:Se.fetchIndicator,style:{top:ve}}),p.createElement("div",{className:Se.visualizationContainer,ref:ie,style:{maxWidth:Z.containerMaxWidth}},G&&p.createElement("div",{className:Se.noTimeDimensionWarning,ref:c,style:{maxWidth:Z.noticeBoxMaxWidth}},p.createElement(z.f,{warning:!0},v.Z.t("This line list may show data that was not available when the interpretation was written."))),p.createElement(I.w,{scrollHeight:Pe(Q,c),scrollWidth:"100%",width:"auto",className:N()(Se.dataTable,"push-analytics-linelist-table"),dataTest:"line-list-table",ref:h},p.createElement(w.s,{ref:D},p.createElement(T.U,null,fe.headers.map(((e,t)=>e?p.createElement(b.p,{fixed:!0,top:"0",key:e.name,name:e.name,onSortIconClick:ze,sortDirection:se?void 0:e.name===q?F:"default",sortIconTitle:v.Z.t("Sort by {{column}}",{column:ce(e)}),className:N()(Se.headerCell,Ee,he,"bordered"),dataTest:"table-header"},we(e)):p.createElement(b.p,{fixed:!0,top:"0",key:`undefined_${t}`,className:N()(Se.headerCell,Ee,he),dataTest:"table-header"}))))),p.createElement(C.R,{dataTest:"table-body"},fe.rows.map(((e,t)=>p.createElement(T.U,{key:t,dataTest:"table-row"},e.map(((e,n)=>be(fe.rowContext,t,n)?p.createElement(y.u,{content:v.Z.t("No event"),key:`${t}_${n}-tooltip`},(t=>Te({columnIndex:n,value:e,isUndefined:!0,props:t}))):Te({columnIndex:n,value:e}))))))),p.createElement(x.j,{className:Se.stickyFooter,ref:k},p.createElement(T.U,null,p.createElement(_.W,{colSpan:_e,staticStyle:!0,className:Se.footerCell},p.createElement("div",{className:N()(Se.stickyNavigation,he),style:{maxWidth:Z.paginationMaxWidth}},p.createElement(We,{offline:se,disabled:se||pe,page:fe.pager.page,pageSize:fe.pager.pageSize||100,isLastPage:fe.pager.isLastPage,onPageChange:le,onPageSizeChange:e=>$({pageSize:e,page:1}),pageSizeSelectText:v.Z.t("Rows per page"),pageLength:fe.rows.length,pageSummaryText:e=>{let{firstItem:t,lastItem:n,page:a}=e;return v.Z.t("Page {{page}}, row {{firstItem}}-{{lastItem}}",{firstItem:t,lastItem:n,page:a})}})))))))),Boolean(W.length)&&(d?p.createElement("div",{className:Se.legendKeyContainer,ref:P},p.createElement("div",{className:Se.legendKeyToggle},p.createElement(S.z,{small:!0,secondary:!0,onClick:()=>{L(!A),window.requestAnimationFrame(J)},icon:p.createElement(E.Z,null),toggled:A})),A&&p.createElement("div",{className:Se.legendKeyWrapper,"data-test":"visualization-legend-key"},p.createElement("div",{className:Se.wrapper},p.createElement(g.Z,{legendSets:W})))):A&&p.createElement("div",{className:Se.legendKeyScrollbox,"data-test":"visualization-legend-key",ref:P},p.createElement(g.Z,{legendSets:W}))))};Me.defaultProps={displayProperty:"name",isVisualizationLoading:!1,onResponsesReceived:Function.prototype},Me.propTypes={displayProperty:c().string.isRequired,isVisualizationLoading:c().bool.isRequired,visualization:c().object.isRequired,onResponsesReceived:c().func.isRequired,filters:c().object,forDashboard:c().bool,onColumnHeaderClick:c().func,onError:c().func};const Ae="READY",Le="INSTALLING";function Ze(e){let{installingWorker:t,onStateChange:n}=e;t.onstatechange=()=>{"activated"===t.state&&n(Ae)}}const Oe=()=>p.createElement(i.m,null,p.createElement(r.M,null,p.createElement(l.V,null))),Ke=e=>{let{id:t,children:n,cacheNow:i,isParentCached:r}=e;const{startRecording:l,isCached:o,remove:s}=(0,a.Of)(t);return(0,p.useEffect)((()=>{i&&l({onError:console.error})}),[i]),(0,p.useEffect)((()=>{const e=d().on("removeCachedData",{window:window.parent},(()=>s()));return()=>e.cancel()}),[s]),(0,p.useEffect)((()=>{!r&&o&&s()}),[r]),p.createElement(a.MW,{id:t,loadingMask:Oe},n)};Ke.propTypes={cacheNow:c().bool,children:c().node,id:c().string,isParentCached:c().bool};const qe=e=>{d().send(window.parent,"installationStatus",{installationStatus:e})},Fe=()=>{const[e,t]=(0,p.useState)(),n=e=>t(e.data);return(0,p.useEffect)((()=>{d().send(window.parent,"getProps").then(n).catch((e=>console.error(e))),async function(e){let{onStateChange:t}=e;if(!navigator.serviceWorker)return null;const n=await navigator.serviceWorker.getRegistration();return n?n.active?Ae:n.installing?(Ze({installingWorker:n.installing,onStateChange:t}),Le):(n.onupdatefound=()=>{t(Le);const e=n.installing;e&&Ze({installingWorker:e,onStateChange:t})},null):null}({onStateChange:qe}).then(qe);const e=d().on("newProps",{window:window.parent},n);return()=>e.cancel()}),[]),e?p.createElement("div",{style:{display:"flex",height:"100%",overflow:"hidden"}},p.createElement(Ke,{id:e.cacheId,cacheNow:e.recordOnNextLoad,isParentCached:e.isParentCached},p.createElement(Me,e)),p.createElement(o.k,{colors:!0,spacers:!0,elevations:!0})):null}},2480:()=>{}}]);