{"version":3,"sources":["D2App/components/Toolbar/VisualizationTypeSelector/styles/VisualizationTypeSelector.module.css","D2App/components/Visualization/styles/StartScreen.module.css","D2App/modules/layout.js","D2App/modules/options.js","D2App/modules/input.js","D2App/modules/orgUnit.js","D2App/modules/program.js","D2App/modules/repetition.js","D2App/modules/ui.js","D2App/modules/utils.js","D2App/modules/current.js","D2App/reducers/current.js","D2App/modules/dimensionConstants.js","D2App/modules/programTypes.js","D2App/reducers/visualization.js","D2App/modules/visualization.js","D2App/modules/mainDimensions.js","D2App/modules/timeDimensions.js","D2App/reducers/metadata.js","D2App/reducers/ui.js","D2App/actions/current.js","D2App/reducers/loader.js","D2App/modules/metadata.js","D2App/actions/metadata.js","D2App/actions/ui.js","D2App/actions/visualization.js","D2App/actions/loader.js","D2App/modules/dataStatistics.js","D2App/assets/ErrorIcons.js","D2App/modules/error.js","D2App/modules/history.js","D2App/modules/systemSettings.js","D2App/modules/userSettings.js","D2App/components/Interpretations/common/Interpretation/InterpretationDeleteButton.js","D2App/components/Interpretations/common/Interpretation/InterpretationUpdateForm.js","D2App/components/Interpretations/common/Interpretation/Interpretation.js","D2App/components/Interpretations/common/Interpretation/useLike.js","D2App/components/Interpretations/common/Interpretation/InterpretationSharingLink.js","D2App/components/Interpretations/common/Message/Message.js","D2App/components/Interpretations/common/Message/MessageButtonStrip.js","D2App/components/Interpretations/common/Message/MessageIconButton.js","D2App/components/Interpretations/common/Message/MessageInput.js","D2App/components/Interpretations/common/Message/MessageEditorContainer.js","D2App/components/Interpretations/common/Message/MessageStatsBar.js","D2App/components/Interpretations/common/UserMention/styles/UserMentionWrapper.style.js","D2App/components/Interpretations/common/UserMention/UserList.js","D2App/components/Interpretations/common/UserMention/useUserSearchResults.js","D2App/components/Interpretations/common/UserMention/UserMentionWrapper.js","D2App/components/Interpretations/common/RichTextEditor/markdownHandler.js","D2App/components/Interpretations/common/RichTextEditor/styles/RichTextEditor.style.js","D2App/components/Interpretations/common/RichTextEditor/RichTextEditor.js","D2App/components/Interpretations/InterpretationsUnit/InterpretationForm.js","D2App/components/Interpretations/InterpretationsUnit/InterpretationList.js","D2App/components/Interpretations/InterpretationsUnit/InterpretationsUnit.js","D2App/components/DetailsPanel/DetailsPanel.js","D2App/modules/conditions.js","D2App/components/UpdateButton/UpdateButton.js","D2App/modules/layoutValidation.js","D2App/components/UpdateButton/UpdateVisualizationContainer.js","D2App/components/Dialogs/AddToLayoutButton/AddToLayoutButton.js","D2App/components/Dialogs/DimensionModal.js","D2App/components/Dialogs/Conditions/AlphanumericCondition.js","D2App/components/Dialogs/Conditions/BooleanCondition.js","D2App/components/Dialogs/Conditions/DateCondition.js","D2App/api/legendSets.js","D2App/components/Dialogs/Conditions/NumericCondition.js","D2App/api/options.js","D2App/components/Dialogs/common/TransferEmptySelection.js","D2App/components/Dialogs/common/TransferLeftHeader.js","D2App/components/Dialogs/common/TransferRightHeader.js","D2App/components/Dialogs/common/TransferSourceEmptyPlaceholder.js","D2App/components/Dialogs/utils.js","D2App/components/Dialogs/Conditions/OptionSetCondition.js","D2App/components/Dialogs/Conditions/OrgUnitCondition.js","D2App/components/Dialogs/Conditions/RepeatableEvents.js","D2App/components/Dialogs/Conditions/ConditionsManager.js","D2App/components/Dialogs/DynamicDimension.js","D2App/components/Dialogs/FixedDimension.js","D2App/components/Dialogs/PeriodDimension/StartEndDate.js","D2App/components/Dialogs/PeriodDimension/PeriodDimension.js","D2App/components/Dialogs/PeriodDimension/index.js","D2App/components/Dialogs/DialogManager.js","D2App/components/MainSidebar/DimensionItem/DimensionIcon.js","D2App/components/Layout/ChipBase.js","D2App/components/MainSidebar/DimensionItem/DimensionItemBase.js","D2App/components/DndContext.js","D2App/components/Toolbar/MenuBar/MenuButton.js","D2App/components/DownloadMenu/constants.js","D2App/components/DownloadMenu/PlainDataSourceSubMenu.js","D2App/components/DownloadMenu/DownloadMenu.js","D2App/components/Visualization/useAnalyticsData.js","D2App/components/DownloadMenu/useDownloadMenu.js","D2App/components/DownloadMenu/ToolbarDownloadDropdown.js","D2App/components/DownloadMenu/ModalDownloadDropdown.js","D2App/components/Visualization/useAvailableWidth.js","D2App/components/Visualization/Visualization.js","D2App/components/Interpretations/InterpretationModal/CommentDeleteButton.js","D2App/components/Interpretations/InterpretationModal/CommentUpdateForm.js","D2App/components/Interpretations/InterpretationModal/Comment.js","D2App/components/Interpretations/InterpretationModal/CommentAddForm.js","D2App/components/Interpretations/InterpretationModal/InterpretationThread.js","D2App/components/Interpretations/InterpretationModal/useModalContentWidth.js","D2App/components/Interpretations/InterpretationModal/InterpretationModal.js","D2App/components/InterpretationModal/interpretationIdQueryParam.js","D2App/components/InterpretationModal/InterpretationModal.js","D2App/modules/axis.js","D2App/components/IconButton/IconButton.js","D2App/components/DimensionMenu/MenuItems.js","D2App/components/DimensionMenu/DimensionMenu.js","D2App/components/Layout/TooltipContent.js","D2App/components/Layout/Chip.js","D2App/components/Layout/DefaultLayout/DropZone.js","D2App/components/Layout/DefaultLayout/DefaultAxis.js","D2App/components/Layout/LineListLayout/LineListLayout.js","D2App/components/Layout/Layout.js","D2App/components/LoadingMask/LoadingMask.js","D2App/components/MainSidebar/InputPanel/InputOption.js","D2App/components/MainSidebar/InputPanel/InputPanel.js","D2App/components/MainSidebar/DimensionItem/DimensionItem.js","D2App/components/MainSidebar/MainSidebarSection.js","D2App/components/MainSidebar/SelectedDimensionsContext.js","D2App/components/MainSidebar/MainDimensions.js","D2App/components/MainSidebar/MenuItem/MenuItem.js","D2App/components/MainSidebar/ProgramDimensionsPanel/StageSelect.js","D2App/components/MainSidebar/ProgramDimensionsPanel/ProgramDimensionsFilter.js","D2App/components/MainSidebar/DimensionsList/DimensionListFields.js","D2App/components/MainSidebar/DimensionsList/DimensionsList.js","D2App/components/MainSidebar/ProgramDimensionsPanel/useProgramDimensions.js","D2App/components/MainSidebar/ProgramDimensionsPanel/ProgramDimensionsList.js","D2App/components/MainSidebar/ProgramDimensionsPanel/ProgramSelect.js","D2App/components/MainSidebar/ProgramDimensionsPanel/ProgramDimensionsPanel.js","D2App/components/MainSidebar/TimeDimensions.js","D2App/components/MainSidebar/YourDimensionsPanel/useYourDimensions.js","D2App/components/MainSidebar/YourDimensionsMenuItem.js","D2App/components/MainSidebar/YourDimensionsPanel/YourDimensionsPanel.js","D2App/components/MainSidebar/MainSidebar.js","D2App/components/TitleBar/TitleBar.js","D2App/components/VisualizationOptions/Options/SelectBaseOption.js","D2App/components/VisualizationOptions/Options/DigitGroupSeparator.js","D2App/components/VisualizationOptions/Options/DisplayDensity.js","D2App/components/VisualizationOptions/Options/FontSize.js","D2App/modules/options/tabs/style.js","D2App/components/VisualizationOptions/Options/CheckboxBaseOption.js","D2App/components/VisualizationOptions/Options/ColSubTotals.js","D2App/components/VisualizationOptions/Options/ColTotals.js","D2App/components/VisualizationOptions/Options/HideEmptyRows.js","D2App/components/VisualizationOptions/Options/RowSubTotals.js","D2App/components/VisualizationOptions/Options/RowTotals.js","D2App/components/VisualizationOptions/Options/ShowDimensionLabels.js","D2App/components/VisualizationOptions/Options/ShowHierarchy.js","D2App/components/VisualizationOptions/Options/TextBaseOption.js","D2App/components/VisualizationOptions/Options/Title.js","D2App/modules/options/sections/templates/display.js","D2App/modules/options/sections/templates/emptyData.js","D2App/modules/options/sections/templates/totals.js","D2App/components/VisualizationOptions/Options/LegendSet.js","D2App/components/VisualizationOptions/Options/LegendDisplayStrategy.js","D2App/components/VisualizationOptions/Options/RadioBaseOption.js","D2App/components/VisualizationOptions/Options/LegendDisplayStyle.js","D2App/components/VisualizationOptions/Options/ShowLegendKey.js","D2App/components/VisualizationOptions/Options/Legend.js","D2App/components/VisualizationOptions/Options/MeasureCriteria.js","D2App/modules/options/config.js","D2App/modules/options/pivotTableConfig.js","D2App/modules/options/tabs/data.js","D2App/modules/options/tabs/legend.js","D2App/modules/options/tabs/limitValues.js","D2App/modules/options/lineListConfig.js","D2App/components/VisualizationOptions/VisualizationOptionsManager.js","D2App/components/Toolbar/MenuBar/InterpretationsButton.js","D2App/components/Toolbar/MenuBar/MenuBar.js","D2App/components/Toolbar/VisualizationTypeSelector/VisualizationTypeSelector.js","D2App/components/Toolbar/Toolbar.js","D2App/components/Visualization/StartScreen.js","D2App/components/App.js","D2App/reducers/index.js","D2App/configureStore.js","D2App/middleware/metadata.js","D2App/locales/index.js","D2App/AppWrapper.js","D2App/components/Dialogs/styles/Common.module.css","D2App/components/VisualizationOptions/styles/VisualizationOptions.module.css","D2App/components/Dialogs/Conditions/styles/Condition.module.css","D2App/components/Layout/styles/Chip.module.css","D2App/components/App.module.css","D2App/components/Dialogs/Conditions/styles/ConditionsManager.module.css","D2App/components/Layout/DefaultLayout/styles/DefaultAxis.module.css","D2App/components/MainSidebar/common.module.css","D2App/components/DetailsPanel/styles/DetailsPanel.module.css","D2App/components/Dialogs/styles/DimensionModal.module.css","D2App/components/Dialogs/PeriodDimension/PeriodDimension.module.css","D2App/components/Dialogs/PeriodDimension/StartEndDate.module.css","D2App/components/DndContext.module.css","D2App/components/MainSidebar/DimensionItem/DimensionItemBase.module.css","D2App/components/Toolbar/MenuBar/styles/MenuButton.module.css","D2App/components/DownloadMenu/ModalDownloadDropdown.module.css","D2App/components/Visualization/styles/Visualization.module.css","D2App/components/IconButton/styles/IconButton.module.css","D2App/components/DimensionMenu/DimensionMenu.module.css","D2App/components/Layout/styles/Tooltip.module.css","D2App/components/Layout/DefaultLayout/styles/DropZone.module.css","D2App/components/Layout/DefaultLayout/styles/DefaultLayout.module.css","D2App/components/Layout/LineListLayout/styles/LineListLayout.module.css","D2App/components/Layout/styles/Layout.module.css","D2App/components/LoadingMask/styles/LoadingMask.module.css","D2App/components/MainSidebar/InputPanel/InputOption.module.css","D2App/components/MainSidebar/InputPanel/InputPanel.module.css","D2App/components/MainSidebar/MainSidebarSection.module.css","D2App/components/MainSidebar/MainSidebar.module.css","D2App/components/MainSidebar/MenuItem/MenuItem.module.css","D2App/components/MainSidebar/ProgramDimensionsPanel/ProgramDimensionsFilter.module.css","D2App/components/MainSidebar/DimensionsList/DimensionsList.module.css","D2App/components/MainSidebar/ProgramDimensionsPanel/ProgramDimensionsPanel.module.css","D2App/components/MainSidebar/ProgramDimensionsPanel/ProgramSelect.module.css","D2App/components/MainSidebar/YourDimensionsPanel/YourDimensionsPanel.module.css","D2App/components/TitleBar/styles/TitleBar.module.css","D2App/components/Toolbar/MenuBar/styles/InterpretationsButton.module.css","D2App/components/Toolbar/MenuBar/styles/MenuBar.module.css"],"names":["module","exports","getFilteredLayout","layout","excludedIds","_layout$AXIS_ID_COLUM","_layout$AXIS_ID_ROWS","_layout$AXIS_ID_FILTE","ids","Array","isArray","AXIS_ID_COLUMNS","filter","dim","includes","AXIS_ID_ROWS","AXIS_ID_FILTERS","LAYOUT_TYPE_LINE_LIST","getAdaptedUiLayoutByType","type","VIS_TYPE_LINE_LIST","getLineListLayout","VIS_TYPE_PIVOT_TABLE","OPTION_LEGEND_DISPLAY_STRATEGY","OPTION_LEGEND_DISPLAY_STYLE","OPTION_LEGEND_SET","DISPLAY_DENSITY_COMFORTABLE","DISPLAY_DENSITY_NORMAL","DISPLAY_DENSITY_COMPACT","FONT_SIZE_NORMAL","options","displayDensity","defaultValue","requestable","savable","fontSize","digitGroupSeparator","getOptionsForUi","Object","entries","reduce","map","_ref","option","props","getOptionsFromVisualization","visualization","pick","keys","getInputTypeFromVisualization","vis","outputType","removeLastPathSegment","path","match","length","substr","lastIndexOf","getOuPath","id","metadata","parentGraphMap","concat","undefined","getProgramFromVisualisation","_vis$program","_vis$programStage","program","stageId","programStage","getRepetitionFromVisualisation","repetitionByDimension","layoutGetAllDimensions","d","repetition","forEach","_d$programStage","dimension","parseCurrentRepetition","indexes","getAdaptedUiByType","ui","lineListUiAdapter","getUiFromVisualization","currentState","arguments","input","layoutGetAxisIdDimensionIdsObject","itemsByDimension","layoutGetDimensionIdItemIdsObject","conditions","getConditionsFromVisualization","getParentGraphMapFromVisualization","ouAxis","axisId","dimensionIds","getInverseLayout","DIMENSION_ID_ORGUNIT","find","items","orgUnit","columns","rows","filters","item","legendSet","acc","key","_key$programStage","_key$legendSet","condition","PROP_MOST_RECENT","PROP_OLDEST","getDefaultUiRepetition","every","i","Number","isFinite","Error","n","parseUiRepetition","isObject","fill","_","sort","a","b","useDebounce","value","delay","debouncedValue","setDebouncedValue","useState","useEffect","handler","setTimeout","clearTimeout","useDidUpdateEffect","fn","inputs","didMountRef","useRef","current","extractDimensionIdParts","dimensionId","rawStageId","split","reverse","programStageId","repetitionIndex","substring","indexOf","getDefaultFromUi","adaptedUi","getItemsByDimensionFromUi","getProgramFromUi","getProgramStageFromUi","getAxesFromUi","getOptionsFromUi","_ui$program","_ui$program2","_ui$program3","_ui$conditions$id","_ui$conditions$id2","dimensionCreate","result","SET_CURRENT","SET_CURRENT_FROM_UI","CLEAR_CURRENT","DEFAULT_CURRENT","sGetCurrent","state","sGetCurrentId","_state$current","sGetCurrentFromUi","DIMENSION_TYPES_PROGRAM","Set","DIMENSION_TYPE_DATA_ELEMENT","DIMENSION_TYPE_PROGRAM_ATTRIBUTE","DIMENSION_TYPE_PROGRAM_INDICATOR","DIMENSION_TYPE_CATEGORY","DIMENSION_TYPE_CATEGORY_OPTION_GROUP_SET","DIMENSION_TYPES_YOURS","DIMENSION_TYPE_ORGANISATION_UNIT_GROUP_SET","DIMENSION_TYPE_STATUS","DIMENSION_TYPE_USER","DIMENSION_ID_PROGRAM_STATUS","DIMENSION_ID_EVENT_STATUS","DIMENSION_ID_CREATED_BY","DIMENSION_ID_LAST_UPDATED_BY","DIMENSION_ID_EVENT_DATE","DIMENSION_ID_ENROLLMENT_DATE","DIMENSION_ID_INCIDENT_DATE","DIMENSION_ID_SCHEDULED_DATE","DIMENSION_ID_LAST_UPDATED","DIMENSION_IDS_TIME","getUiDimensionType","dimensionType","PROGRAM_TYPE_WITHOUT_REGISTRATION","PROGRAM_TYPE_WITH_REGISTRATION","SET_VISUALIZATION","CLEAR_VISUALIZATION","DEFAULT_VISUALIZATION","sGetVisualization","STATUS_ACTIVE","STATUS_CANCELLED","STATUS_COMPLETED","OUTPUT_TYPE_EVENT","OUTPUT_TYPE_ENROLLMENT","statusNames","i18n","t","headersMap","outputTypeTimeDimensionMap","transformDimensions","dimensions","dimensionObj","DIMENSION_TYPE_PROGRAM_DATA_ELEMENT","DIMENSION_ID_PERIOD","DIMENSION_TYPE_PERIOD","defaultRemoveDimensionProps","removeDimensionPropsBeforeSaving","axis","assign","prop","getVisualizationFromCurrent","legacy","STATE_EMPTY","STATE_SAVED","STATE_UNSAVED","STATE_DIRTY","dimensionMetadataPropMap","dataElementDimensions","attributeDimensions","programIndicatorDimensions","categoryDimensions","categoryOptionGroupSetDimensions","organisationUnitGroupSetDimensions","dataElementGroupSetDimensions","getDimensionMetadataFromVisualization","metaData","_ref2","listName","dimensionName","dimensionWrapper","getMainDimensions","DIMENSION_TYPE_ORGANISATION_UNIT","name","getIsMainDimensionDisabled","inputType","programType","NAME_PARENT_PROPERTY_PROGRAM","getTimeDimensions","nameParentProperty","nameProperty","getTimeDimensionName","stage","getDisabledTimeDimensions","disabledDimensions","displayIncidentDate","disabledReason","ADD_METADATA","CLEAR_METADATA","EMPTY_METADATA","sGetMetadata","sGetMetadataById","SET_UI_DRAGGING_ID","SET_UI_INPUT","CLEAR_UI_PROGRAM","CLEAR_UI_STAGE_ID","UPDATE_UI_PROGRAM_ID","UPDATE_UI_PROGRAM_STAGE_ID","SET_UI_OPTIONS","ADD_UI_LAYOUT_DIMENSIONS","REMOVE_UI_LAYOUT_DIMENSIONS","SET_UI_LAYOUT","SET_UI_FROM_VISUALIZATION","CLEAR_UI","SET_UI_DETAILS_PANEL_OPEN","SET_UI_ACCESSORY_PANEL_OPEN","SET_UI_EXPANDED_LAYOUT_PANEL","SET_UI_ACTIVE_MODAL_DIALOG","SET_UI_ITEMS","REMOVE_UI_ITEMS","ADD_UI_PARENT_GRAPH_MAP","SET_UI_CONDITIONS","SET_UI_REPETITION","REMOVE_UI_REPETITION","EMPTY_UI","draggingId","DEFAULT_UI","showAccessoryPanel","showDetailsPanel","showExpandedLayoutPanel","activeModalDialog","getPreselectedUi","rootOrgUnits","rootOrgUnitIds","root","USER_ORG_UNIT","sGetUi","sGetUiDraggingId","sGetUiInput","sGetUiProgram","sGetUiOptions","sGetUiLayout","sGetUiShowDetailsPanel","sGetUiShowAccessoryPanel","sGetUiType","sGetUiActiveModalDialog","sGetUiParentGraphMap","sGetUiInputType","sGetUiProgramId","sGetUiProgramStageId","sGetUiItemsByDimension","sGetUiItems","sGetDimensionIdsFromLayout","values","axisDimensionIds","sGetUiConditionsByDimension","sGetUiConditions","sGetUiRepetitionByDimension","sGetUiRepetition","renderChipsSelector","createSelector","layoutItems","flat","dataObjects","some","data","tSetCurrent","dispatch","acClearCurrent","tSetCurrentFromUi","async","getState","SET_LOAD_ERROR","CLEAR_LOAD_ERROR","SET_VISUALIZATION_LOADING","DEFAULT_LOADING","loadingError","isVisualizationLoading","sGetLoadError","loader","sGetIsVisualizationLoading","formatObject","object","obj","getDefaultMetadata","getDefaultTimeDimensionsMetadata","getDimensionById","USER_ORG_UNIT_CHILDREN","USER_ORG_UNIT_GRANDCHILDREN","getProgramAsMetadata","programStages","getDynamicTimeDimensionsMetadata","acAddMetadata","acClearMetadata","tSetInitMetadata","rootOrgUnit","acSetUiDraggingId","acClearUiProgram","acUpdateUiProgramStageId","tClearUiProgramRelatedDimensions","disabledTimeDimensionIds","idsToRemove","isProgramDimension","has","isDisabledMainDimension","isDisabledTimeDimension","acRemoveUiLayoutDimensions","acRemoveUiItems","tSetUiInput","acSetUiInput","tSetUiProgram","tClearUiStage","acSetUiOptions","acSetUiOption","acAddUiLayoutDimensions","acSetUiDetailsPanelOpen","acSetShowExpandedLayoutPanel","acSetUiOpenDimensionModal","acSetUiItems","acAddParentGraphMap","acSetVisualization","_dim$optionSet","valueType","optionSet","_dim$programStage","_dim$optionSet2","acSetLoadError","acClearLoadError","acSetVisualizationLoading","acClearAll","error","EVENT_TYPE","GenericError","React","createElement","height","viewBox","width","xmlns","transform","EmptyBox","fillRule","PeriodError","DataError","visualizationError","icon","title","description","genericServerError","genericErrorTitle","noPeriodError","createHashHistory","SYSTEM_SETTINGS_DIGIT_GROUP_SEPARATOR","SYSTEM_SETTINGS_HIDE_DAILY_PERIODS","SYSTEM_SETTINGS_HIDE_WEEKLY_PERIODS","SYSTEM_SETTINGS_HIDE_BIWEEKLY_PERIODS","SYSTEM_SETTINGS_HIDE_MONTHLY_PERIODS","SYSTEM_SETTINGS_HIDE_BIMONTHLY_PERIODS","systemSettingsKeys","USER_SETTINGS_UI_LOCALE","USER_SETTINGS_DISPLAY_PROPERTY","DERIVED_USER_SETTINGS_DISPLAY_NAME_PROPERTY","userSettingsKeys","mutation","resource","InterpretationDeleteButton","onComplete","remove","loading","useDataMutation","variables","MessageIconButton","tooltipContent","iconComponent","IconDelete16","onClick","disabled","partial","interpretationText","InterpretationUpdateForm","_ref3","close","currentUser","showSharingLink","text","setInterpretationText","update","errorText","message","className","_JSXStyle","dynamic","spacers","dp8","colors","grey100","MessageEditorContainer","RichTextEditor","inputPlaceholder","onChange","InterpretationSharingLink","MessageButtonStrip","Button","primary","small","secondary","Interpretation","interpretation","onUpdated","onDeleted","onReplyIconClick","isUpdateMode","setIsUpdateMode","showSharingDialog","setShowSharingDialog","toggleLike","isLikedByCurrentUser","toggleLikeInProgress","likeMutationRef","unlikeMutationRef","like","likeLoading","unlike","unlikeLoading","setIsLikedByCurrentUser","likedBy","useLike","shouldShowButton","access","manage","Message","created","username","user","displayName","MessageStatsBar","IconThumbUp16","selected","count","likes","IconReply16","comments","IconShare16","SharingDialog","open","onClose","IconEdit16","delete","event","stopPropagation","Fragment","dp4","grey800","children","grey900","grey600","UserAvatar","extrasmall","dateTime","moment","format","RichTextParser","Icon","Tooltip","closeDelay","content","ref","onMouseOver","onMouseOut","grey700","teal600","teal800","teal500","teal700","cx","_extends","target","source","prototype","hasOwnProperty","call","apply","this","MessageInput","forwardRef","grey500","theme","focus","dp12","medium","userMentionWrapperClasses","dp16","white","__hash","resolvedHeaderStyle","styles","UserList","users","selectedUserIndex","onUserClick","pager","u","_users$selectedUserIn","MenuItem","dense","label","active","total","pageSize","usersQuery","params","searchText","fields","order","rootJunction","getVirtualPopperReference","rects","getClientRects","lastRect","left","getBoundingClientRect","top","right","bottom","x","UserMentionWrapper","inputReference","onUserSelect","captureText","setCaptureText","capturedText","setCapturedText","cloneText","setCloneText","cloneRef","captureStartPosition","setCaptureStartPosition","setSelectedUserIndex","fetching","clear","setData","refetch","useDataQuery","lazy","debouncedRefetch","useCallback","debounce","cancel","useUserSearchResults","reset","onSelect","originalValue","newValue","slice","replace","requestAnimationFrame","setSelectionRange","onKeyDown","selectionStart","preventDefault","onInput","selectionEnd","spacePosition","filterValue","Portal","Popper","reference","placement","Card","Menu","MenuSectionHeader","hideDivider","CenteredContent","CircularLoader","defaultProps","Function","BOLD","ITALIC","LINK","MENTION","EMOJI_SMILEY_FACE","EMOJI_SAD_FACE","EMOJI_THUMBS_UP","EMOJI_THUMBS_DOWN","emojis","markdownMap","prefix","postfix","insertMarkdown","markdown","cb","start","end","marker","caretPos","padMarkers","valueArr","splice","join","trimmedText","mainClasses","toolbarClasses","grey050","grey300","dp2","tooltipAnchorClasses","emojisPopoverClasses","EmojisPopover","onInsertMarkdown","Popover","onClickOutside","IconButtonWithTooltip","Toolbar","_ref4","onTogglePreview","previewButtonDisabled","previewMode","emojisButtonRef","emojisPopoverIsOpen","setEmojisPopoverIsOpen","iconColor","IconTextBold24","color","IconTextItalic24","IconLink24","IconAt24","IconFaceAdd24","markup","_ref5","externalRef","setPreviewMode","internalRef","textareaRef","_textareaRef$current","dispatchEvent","KeyboardEvent","bubbles","Field","validationText","placeholder","ctrlKey","metaKey","convertCtrlKey","InterpretationForm","onSave","showRichTextEditor","setShowRichTextEditor","saveMutationRef","save","saveMutationInProgress","Input","onFocus","sortByCreatedDateDesc","dateA","dateB","InterpretationList","interpretations","onInterpretationClick","refresh","interpretationsByDate","groupedInterpretations","date","push","dp32","IconCalendar24","interpretationsQuery","InterpretationsUnit","isExpanded","setIsExpanded","onCompleteAction","useImperativeHandle","grey400","expanded","IconChevronUp24","IconChevronDown24","navigateToOpenModal","interpretationId","initialFocus","history","pathName","location","pathname","search","stringify","isModalOpening","connect","interpretationsUnitRef","useCachedDataQuery","classes","panel","AboutAOUnit","parseConditionsStringToArray","conditionsString","NULL_VALUE","TRUE_VALUE","FALSE_VALUE","OPERATOR_EQUAL","OPERATOR_NOT_EQUAL","OPERATOR_EMPTY","OPERATOR_NOT_EMPTY","OPERATOR_IN","CASE_INSENSITIVE_PREFIX","NOT_PREFIX","NUMERIC_OPERATORS","ALPHA_NUMERIC_OPERATORS","DATE_OPERATORS","BOOLEAN_VALUES","VALUE_TYPE_NUMBER","VALUE_TYPE_UNIT_INTERVAL","VALUE_TYPE_PERCENTAGE","VALUE_TYPE_INTEGER","VALUE_TYPE_INTEGER_POSITIVE","VALUE_TYPE_INTEGER_NEGATIVE","VALUE_TYPE_INTEGER_ZERO_OR_POSITIVE","VALUE_TYPE_TEXT","VALUE_TYPE_LONG_TEXT","VALUE_TYPE_LETTER","VALUE_TYPE_PHONE_NUMBER","VALUE_TYPE_EMAIL","VALUE_TYPE_USERNAME","VALUE_TYPE_URL","VALUE_TYPE_BOOLEAN","VALUE_TYPE_TRUE_ONLY","VALUE_TYPE_DATE","VALUE_TYPE_TIME","VALUE_TYPE_DATETIME","VALUE_TYPE_ORGANISATION_UNIT","prefixOperator","operator","isCaseSensitive","unprefixOperator","checkIsCaseSensitive","parseCondition","conditionItem","pop","getConditionsTexts","_conditionsList$","_conditionsList$2","_conditionsList$3","formatValueOptions","conditionsList","_metadata$conditions$2","legends","allLegends","legend","_allLegends$find","l","_metadata$conditions$","startsWith","code","_Object$values$find","ou","_metadata$ou","operators","getOperatorsByValueType","parts","formatValue","replaceAll","operatorName","capitalCaseOperatorName","toUpperCase","UpdateButton","validateAxis","AXIS","isValid","axisItem","dimensionIsValid","requireItems","isAxisValid","validateLineListLayout","_layout$program","validateDimension","layoutGetDimension","layoutHasTimeDimension","layoutHasProgramId","_layout$program2","Boolean","UpdateVisualizationContainer","renderComponent","useDispatch","currentFromUi","useSelector","visType","dialogId","onAddDimension","dataTest","availableAxes","getAvailableAxes","AddToLayoutButton","SplitButton","clickHandler","component","FlyoutMenu","maxWidth","axisName","getAxisNameByLayoutType","getLayoutTypeByVisType","DimensionModal","isInLayout","Modal","position","large","ModalTitle","ModalContent","modalContent","ModalActions","ButtonStrip","BaseCondition","onRemove","allowCaseSensitive","valueClassName","container","SingleSelectField","operatorSelect","SingleSelectOption","textInput","Checkbox","checked","caseSensitiveCheckbox","removeButton","PhoneNumberCondition","phoneNumberInput","LetterCondition","letterInput","CaseSensitiveAlphanumericCondition","showFalseOption","onCheckboxChange","currentValues","setValues","v","checkboxOption","BooleanCondition","TrueOnlyCondition","_value","max","dateInput","DateCondition","DateTimeCondition","TimeCondition","dataElementsQuery","trackedEntityAttributesQuery","programIndicatorsQuery","legendSetsQuery","paging","NumericCondition","_legendSet$legends","_legendSet$legends2","legendSetId","numberOfConditions","onLegendSetChange","enableDecimalSteps","availableLegendSets","_sGetMetadataById","legendSets","dataEngine","useDataEngine","fetchLegendSets","query","_ref6","onError","console","log","apiFetchLegendSetsByDimension","setOperator","fetchLegendSet","apiFetchLegendSetById","setValue","MenuDivider","numericInput","step","legendSetSelect","empty","MultiSelectField","legendSelect","startValue","MultiSelectOption","optionsQuery","optionSetId","searchTerm","page","TransferEmptySelection","transferEmptyList","TransferLeftHeader","setSearchTerm","transferLeftHeader","transferLeftTitle","InputField","TransferRightHeader","transferRightHeader","TransferSourceEmptyPlaceholder","TRANSFER_OPTIONS_WIDTH","TRANSFER_SELECTED_WIDTH","TRANSFER_HEIGHT","addMetadata","_parts$","selectedOptions","setState","nextPage","debouncedSearchTerm","fetchItems","_result$options","response","apiFetchOptions","newOptions","newOption","selectedItem","Transfer","so","loadingPicked","sourceEmptyPlaceholder","onEndReached","leftHeader","optionsWidth","selectedWidth","selectedEmptyComponent","rightHeader","renderOption","TransferOption","OrgUnitCondition","_selected$path","addParentGraphMap","roots","OrganisationUnitTree","initiallyExpanded","forMetadata","forParentGraphMap","singleSelection","isDefaultRepetition","defaultMostRecent","defaultOldest","RepeatableEvents","sRepetition","setRepetition","acSetUiRepetition","mostRecent","oldest","parseInput","parsedValue","parseInt","commonClasses","paragraph","nsSeparator","repeatableWrapper","keySeparator","repeatableInput","toString","onMostRecentChange","min","onOldestChange","TAB_CONDITIONS","TAB_REPEATABLE_EVENTS","NUMERIC_TYPES","SINGLETON_TYPES","SUPPORTED_TYPES","mapDispatchToProps","setConditionsByDimension","ownProps","_ownProps$dimension","_ownProps$dimension2","_ownProps$dimension3","_ownProps$dimension3$","dimensionIdsInLayout","currentTab","setCurrentTab","isProgramIndicator","isOptionSetCondition","canHaveLegendSets","isSupported","setConditionsList","_conditions$condition","getInitConditions","selectedLegendSet","setSelectedLegendSet","addCondition","removeCondition","conditionIndex","filteredConditionsList","index","setCondition","disableAddButton","isRepeatable","renderConditions","mainSection","getDividerContent","separator","OptionSetCondition","renderNumericCondition","renderConditionsContent","infoIcon","IconInfo16","tooltipReference","addConditionButton","inputCondition","conditionsArray","cnd","storeConditions","disableRepeatableTab","repeatable","repeatableTab","Tab","TabBar","tabBar","renderTabs","selectedIds","setUiItems","userSettings","selectedItems","_result$dimensionItem","apiFetchItemsByDimension","nameProp","newItems","dimensionItems","newItem","si","itemIds","selectUiItems","FixedDimension","ouIds","eventStatusIds","programStatusIds","ouIdHelper","removePrefix","renderStatusParagraph","setStatus","selectedItemsIds","itemId","toggle","newIds","ALL_STATUSES","verticalCheckbox","renderProgramStatus","_ref7","renderEventStatus","dimensionProps","ouUid","display","style","OrgUnitDimension","renderModalContent","StartEndDate","startDateStr","endDateStr","startDate","setStartDate","endDate","setEndDate","helpText","row","inputWidth","IconArrowRight16","OPTION_PRESETS","OPTION_START_END_DATES","segmentedControlOptions","isStartEndDate","isNaN","Date","parse","PeriodDimension","formatStartEndDate","formatter","Intl","DateTimeFormat","dateStyle","startEndDate","dateStr","useLocalizedStartEndDateFormatter","getNameFromMetadata","store","useStore","_metadata$id","useMetadataNameGetter","allDimensionIds","useMemo","useIsInLayout","excludedPeriodTypes","systemSettings","types","DAILY","WEEKLY","WEEKLYWED","WEEKLYTHU","WEEKLYSAT","WEEKLYSUN","BIWEEKLY","MONTHLY","BIMONTHLY","useExcludedPeriods","entryMethod","setEntryMethod","updatePeriodDimensionItems","uiItems","onUpdate","SegmentedControl","entry","BasePeriodDimension","selectedPeriods","DialogManager","DynamicDimension","ConditionsManager","DIMENSION_TYPE_ICONS","IconDimensionData16","IconDimensionProgramIndicator16","IconFilter16","IconDimensionCategoryOptionGroupset16","IconDimensionOrgUnitGroupset16","IconDimensionOrgUnit16","IconCheckmarkCircle16","IconUser16","IconCalendar16","DimensionIcon","ChipBase","conditionsLength","itemsLength","stageName","chipBase","leftIcon","suffix","all","defaultValue_plural","getChipSuffix","DimensionItemBase","dragging","contextMenu","dimensionItem","iconAndLabelWrapper","DIMENSION_PANEL_SOURCE","getDropzoneId","FIRST","LAST","activateAt15pixels","activationConstraint","distance","getIntersectionRatio","Math","targetArea","entryArea","intersectionArea","toFixed","sortCollisionsDesc","rectIntersectionCustom","pointerCoordinates","droppableContainers","pointerRect","y","collisions","droppableContainer","rect","intersectionRatio","getIdFromDraggingId","OuterDndContext","sourceAxis","setSourceAxis","chipItems","chipConditions","sensor","useSensor","PointerSensor","sensors","useSensors","rearrangeLayoutDimensions","sourceAxisId","sourceIndex","destinationAxisId","destinationIndex","destItems","from","newIndex","sourceList","moved","onDragCancel","DndContext","collisionDetection","onDragStart","sortable","containerId","onDragEnd","_over$data","_over$data$current","_over$data$current$so","_over$data$current2","_over$data$current2$s","_over$data$current3","_over$data$current3$s","over","isDroppingInFirstPosition","isDroppingInLastPosition","idx","addDimensionToLayout","DragOverlay","dropAnimation","_chipConditions$condi","overlay","conditionsTexts","skipRounding","chipStyles","chip","chipEmpty","getDragOverlay","MenuButton","menuButton","DOWNLOAD_TYPE_PLAIN","DOWNLOAD_TYPE_TABLE","FILE_FORMAT_CSV","FILE_FORMAT_HTML_CSS","FILE_FORMAT_XLS","ID_SCHEME_NAME","PlainDataSourceSubMenu","download","menuItemProps","DownloadMenu","analyticsApiEndpointMap","excludedDimensions","formatRowValue","rowValue","header","metaDataItems","_findOptionSetItem","_metaDataItems$rowVal","findOptionSetItem","getAnalyticsEndpoint","getAdaptedVisualization","parameters","adaptDimensions","adaptedDimensions","_dimensionObj$items","_dimensionObj$items2","isTimeDimension","adaptedColumns","adaptedRows","adaptedFilters","headers","_repetition$indexes","headerId","adaptedVisualization","useAnalyticsData","relativePeriodDate","onResponseReceived","sortField","sortDirection","isGlobalLoading","analyticsEngine","Analytics","getAnalytics","mounted","setLoading","setFetching","setError","doFetch","analyticsResponse","req","request","fromVisualization","withParameters","totalPages","withProgram","withDisplayProperty","withOutputType","withPageSize","withPage","withIncludeMetadataDetails","withRelativePeriodDate","withAsc","withDesc","analyticsApiEndpoint","getQuery","fetchAnalyticsData","h","column","extractHeaders","filteredRows","rowIndex","rowsCount","filteredRow","headerIndex","headersCount","extractRows","useDownloadMenu","baseUrl","useConfig","buttonRef","isOpen","setIsOpen","idScheme","withPath","withFormat","withTableLayout","withColumns","withRows","dataIdScheme","withOutputIdScheme","url","URL","buildUrl","window","origin","buildQuery","searchParams","append","toggleOpen","ToolbarDownloadDropdown","Layer","ModalDownloadDropdown","DropdownButton","scrollbarWidth","document","innerHTML","el","classList","add","body","appendChild","offsetWidth","clientWidth","removeChild","computeAvailableOuterWidth","isInModal","windowWidth","leftOpen","rightOpen","computeOuterWidthInModal","availableOuterWidth","computeOuterWidthInPage","Visualization","setSorting","availableInnerWidth","setWindowWidth","innerWidth","debouncedWindowWidth","setAvailableOuterWidth","onResize","addEventListener","removeEventListener","useAvailableWidth","_error$details","output","details","errorCode","sizeClass","sizeComfortable","sizeCompact","sizeNormal","getSizeClass","fontSizeClass","fontSizeLarge","fontSizeSmall","fontSizeNormal","getFontSizeClass","colSpan","String","sortData","direction","wrapper","fetchIndicator","DataTable","scrollHeight","scrollWidth","dataTable","DataTableHead","DataTableRow","DataTableColumnHeader","fixed","onSortIconClick","headerCell","headerName","isInteger","stageOffset","repeatEventIndex","dimensionModalHandler","formatCellHeader","DataTableBody","DataTableCell","cell","_metadata$value","href","rel","formatCellValue","DataTableFoot","stickyFooter","staticStyle","footerCell","stickyNavigation","Pagination","isLastPage","onPageChange","pageNum","onPageSizeChange","pageSizeNum","pageSizeSelectText","pageLength","pageSummaryText","firstItem","lastItem","commentId","CommentDeleteButton","CommentUpdateForm","commentText","setCommentText","updateMutationRef","Comment","comment","onThreadUpdated","createdBy","CommentAddForm","focusRef","InterpretationThread","onInterpretationDeleted","downloadMenuComponent","IconClock16","_focusRef$current","computeModalContentWidth","modalCSS","InterpretationModal","onInterpretationUpdate","modalContentWidth","setModalContentWidth","useModalContentWidth","modalContentCSS","isDirty","setIsDirty","shouldRenderModalContent","shouldCssHideModal","handleClose","fluid","hidden","dp24","visualisationName","NoticeBox","affectsInterpretation","parseBooleans","removeInterpretationQueryParams","parsed","parsedWithoutInterpretationId","isModalClosing","setParams","listen","_location$state","_location$state2","useInterpretationQueryParams","setIsVisualizationLoading","AnalyticsInterpretationModal","getAxisName","IconButton","onBlur","ariaOwns","ariaHaspopup","iconButton","getAxisItemLabel","isDimensionInLayout","MenuItems","currentAxisId","axisItemHandler","removeItemHandler","menuItems","applicableAxisIds","DimensionMenu","dimensionMetadata","axisLayout","getAxisIdForDimension","menuIsOpen","setMenuIsOpen","toggleMenu","e","button","IconMore16","TooltipContent","getNameList","idList","levelString","levelId","_metadata$stageId","renderItems","itemDisplayNames","itemsToRender","numberOverRenderLimit","renderAllItemsLabel","levelIds","groupIds","hasLevelPrefix","hasGroupPrefix","getItemDisplayNames","list","BEFORE","AFTER","Chip","isLast","overLastDropZone","activeIndex","attributes","listeners","isDragging","isSorting","setNodeRef","transition","useSortable","globalLoadError","insertPosition","CSS","Translate","scaleX","scaleY","random","insertBefore","insertAfter","showBlank","DropZone","firstElementId","isOver","useDroppable","draggingOver","dropZone","isEmpty","DefaultAxis","lastDropZoneId","sGetUiDimensionIdsByAxisId","renderChips","selectedProgramId","programStageNames","_program$programStage","set","Map","lastDropzone","axisContainer","SortableContext","hasDuplicates","dataElements","dataElementCount","get","getDimensionsWithStageName","Layout","defaultLayoutStyles","ct","axisGroup","lineListLayoutStyles","axisGroupLeft","defaultAxisStyles","axisContainerLeft","axisGroupRight","componentMap","LineListLayout","sGetUiShowExpandedLayoutPanel","LayoutComponent","ButtonIcon","IconChevronUp16","IconChevronDown16","overflowContainer","LoadingMask","outer","progress","InputOption","Radio","getLabelForInputType","InputPanel","visible","selectedInput","setSelectedInput","DimensionItem","draggableId","MainSidebarSection","SelectedDimensionsContext","createContext","counts","your","getIsDimensionSelected","SelectedDimensionsProvider","providerValue","allSelectedIds","allSelectedIdsSet","Provider","useSelectedDimensions","useContext","MainDimensions","mainDimensions","programId","useMainDimensions","draggableDimensions","openDelay","span","notAllowed","isCountDisabled","tabIndex","dashed","chevron","IconChevronRight16","STAGE_ALL","StageSelect","optional","stages","selectedStageId","includeShowAllOption","SingleSelect","tSetUiStage","tClearUiProgramStageDimensions","optionIcon","ProgramDimensionsFilter","setDimensionType","showStageSelect","DIMENSION_TYPE_ALL","Divider","DIMENSION_LIST_FIELDS","isEndReached","scrollTop","clientHeight","DimensionsList","programName","setIsListEndVisible","scrollBoxRef","loaderWrap","errorWrap","scrollbox","onScroll","onMouseDown","loadMoreWrap","noResults","getNoResultsMessage","ACTIONS_RESET","ACTIONS_INIT","ACTIONS_SUCCESS","ACTIONS_ERROR","ACTIONS_SET_LIST_END_VISIBLE","initialState","isListEndVisible","reducer","action","payload","createDimensionsQuery","transformResponseData","deDimensionsMapRef","shouldReset","newDuplicateFound","allDimensions","ProgramDimensionsList","engine","useReducer","fetchDimensions","isVisible","useProgramDimensions","ProgramSelect","programs","setSelectedProgramId","requiredStageSelection","selectedProgram","select","maxHeight","stretch","ProgramDimensionsPanel","called","filteredPrograms","isProgramSelectionComplete","section","bordered","helptext","TimeDimensions","timeDimensions","eventDateDim","enrollmentDateDim","incidentDateDim","lastUpdatedDim","disabledTimeDimensions","useTimeDimensions","YOUR_DIMENSIONS_RESOURCE","YOUR_DIMENSIONS_FILTER","YourDimensionsMenuItem","_data$dimensions$dime","IconFolder16","YourDimensionsPanel","setDimensions","currDimensions","useYourDimensions","TAB_INPUT","TAB_PROGRAM","TAB_YOUR","MainSidebar","selectedInputType","selectedTabId","setSelectedTabId","setOpen","newOpen","main","accessory","padded","accessoryInner","MainSidebarWithSelectedDimensionsProvider","defaultTitleClasses","getTitleText","titleState","getSuffix","titleDirty","stateProps","dispatchProps","getVisualizationState","titleText","titleClasses","titleUnsaved","getCustomTitleClasses","titleBar","_option$items$find","tabSectionOption","DigitGroupSeparator","SelectBaseOption","DisplayDensity","FontSize","inverted","ColSubTotals","CheckboxBaseOption","ColTotals","HideEmptyRows","RowSubTotals","RowTotals","ShowDimensionLabels","ShowHierarchy","TextBaseOption","Title","LegendSetSelect","loadingText","sGetUiOption","optionId","setOptions","isLoaded","setIsLoaded","LEGEND_DISPLAY_STRATEGY_BY_DATA_ITEM","LEGEND_DISPLAY_STRATEGY_FIXED","tabSectionOptionToggleable","LegendSet","LegendDisplayStyle","RadioBaseOption","LEGEND_DISPLAY_STYLE_FILL","LEGEND_DISPLAY_STYLE_TEXT","ShowLegendKey","legendDisplayStrategy","hideStyleOptions","legendEnabled","setLegendEnabled","FieldSet","UiCoreLegend","tabSectionTitle","tabSectionTitleMargin","LegendDisplayStrategy","_defineProperty","defineProperty","enumerable","configurable","writable","OperatorSelect","inputMaxWidth","ValueInput","MeasureCriteria","Component","constructor","super","defaultState","op1","v1","op2","v2","_op","_v","_op2","_v2","render","tabSectionOptionText","tabSectionOptionComplexInline","Label","paddingTop","onClear","measureCriteria","getOptionsByType","getDisplayTemplate","Children","toArray","getTotalsTemplate","getEmptyDataTemplate","Legend","getStyleTab","pivotTableConfig","VisualizationOptionsManager","dialogIsOpen","setDialogIsOpen","optionsConfig","VisualizationOptions","InterpretationsButton","iconWrapper","IconChevronRight24","IconChevronLeft24","visualizationSaveMutation","skipTranslations","skipSharing","visualizationSaveAsMutation","setCurrent","setVisualization","apiObjectName","show","showAlert","useAlert","copy","visualizationType","visTypeDisplayNames","toLocaleDateString","year","month","day","postVisualization","putVisualization","onSaveComplete","res","uid","locationObject","locationState","isSaving","statusCode","httpStatusCode","menuBar","updateButton","FileMenu","fileType","fileObject","defaultFilterVisType","onOpen","isOpening","onNew","isResetting","onRename","updatedVisualization","updatedCurrent","success","duration","onSaveAs","onDelete","deletedVisualization","deletedObject","flexGrow","IconVisualizationLinelist16","sectionToolbar","flexCt","VisualizationTypeSelector","toolbarMenubar","flexGrow1","MenuBar","mostViewedQuery","mostViewed","eventType","visualizationsQuery","visualizations","setLoadError","_data$mostViewed","eventVisualizations","useMostViewedVisualizations","inner","errorContainer","isVisualizationError","errorIcon","errorTitle","errorDescription","guide","guideItem","visIcon","VisTypeIcon","useSmall","visualizationQuery","eventVisualization","objectName","dataStatisticsMutation","favorite","App","previousLocation","setPreviousLocation","initialLoadIsComplete","setInitialLoadIsComplete","postDataStatistics","isLoading","loadVisualization","isExisting","pathParts","parseLocation","fetchError","_fetchError$details","unlisten","_location$state3","_location$state4","_location$state5","isValidLocationChange","transformedColumns","transformedRows","transformedFilters","completedOnly","transformedVisualization","transformVisualization","acSetUiFromVisualization","eventReportsApp","flexDirCol","sectionMain","mainCenter","flexBasis0","mainCenterLayout","mainCenterTitlebar","TitleBar","mainCenterCanvas","StartScreen","loadingCover","_response$rows","itemsMetadata","dimensionItemType","mainRight","DetailsPanel","CssVariables","combineReducers","transfers","newLayout","removedProperty","configureStore","middleware","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","createStore","applyMiddleware","next","meta","addResources","enTranslations","userDataViewFallback","providerDataTransformation","organisationUnits","AppWrapper","thunk","withExtraArgument","metadataMiddleware","Cypress","ReduxProvider","CachedDataQueryProvider","dataTransformation"],"mappings":"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","file":"static/js/app.d7fd15b4.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"VisualizationTypeSelector_container__1XsCk\",\"button\":\"VisualizationTypeSelector_button__2kNLq\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"outer\":\"StartScreen_outer__2nbkE\",\"inner\":\"StartScreen_inner__2exeL\",\"errorContainer\":\"StartScreen_errorContainer__u2dgL\",\"errorIcon\":\"StartScreen_errorIcon__1QTyz\",\"errorTitle\":\"StartScreen_errorTitle__2Ksw9\",\"errorDescription\":\"StartScreen_errorDescription__syq9m\",\"title\":\"StartScreen_title__2-0vP\",\"section\":\"StartScreen_section__3ITr1\",\"guide\":\"StartScreen_guide__d793i\",\"guideItem\":\"StartScreen_guideItem__13mvT\",\"visualization\":\"StartScreen_visualization__3FqSm\",\"visIcon\":\"StartScreen_visIcon__2SFAA\"};","import { AXIS_ID_COLUMNS, AXIS_ID_FILTERS, AXIS_ID_ROWS, VIS_TYPE_LINE_LIST, VIS_TYPE_PIVOT_TABLE } from '@dhis2/analytics'; // Exclude one or many dimensions from layout\n\nexport const getFilteredLayout = (layout, excludedIds) => {\n  var _layout$AXIS_ID_COLUM, _layout$AXIS_ID_ROWS, _layout$AXIS_ID_FILTE;\n\n  const ids = Array.isArray(excludedIds) ? excludedIds : [excludedIds];\n  return {\n    [AXIS_ID_COLUMNS]: ((_layout$AXIS_ID_COLUM = layout[AXIS_ID_COLUMNS]) === null || _layout$AXIS_ID_COLUM === void 0 ? void 0 : _layout$AXIS_ID_COLUM.filter(dim => !ids.includes(dim))) || [],\n    [AXIS_ID_ROWS]: ((_layout$AXIS_ID_ROWS = layout[AXIS_ID_ROWS]) === null || _layout$AXIS_ID_ROWS === void 0 ? void 0 : _layout$AXIS_ID_ROWS.filter(dim => !ids.includes(dim))) || [],\n    [AXIS_ID_FILTERS]: ((_layout$AXIS_ID_FILTE = layout[AXIS_ID_FILTERS]) === null || _layout$AXIS_ID_FILTE === void 0 ? void 0 : _layout$AXIS_ID_FILTE.filter(dim => !ids.includes(dim))) || []\n  };\n};\nexport const LAYOUT_TYPE_LINE_LIST = 'LAYOUT_TYPE_LINE_LIST';\nexport const LAYOUT_TYPE_PIVOT_TABLE = 'LAYOUT_TYPE_PIVOT_TABLE';\nexport const getAdaptedUiLayoutByType = (layout, type) => {\n  switch (type) {\n    case VIS_TYPE_LINE_LIST:\n      {\n        return getLineListLayout(layout);\n      }\n\n    case VIS_TYPE_PIVOT_TABLE:\n    default:\n      return layout;\n  }\n}; // Transform from ui.layout to line list layout format\n\nconst getLineListLayout = layout => ({\n  [AXIS_ID_COLUMNS]: [...layout[AXIS_ID_COLUMNS], ...(layout[AXIS_ID_ROWS] || [])],\n  [AXIS_ID_ROWS]: [],\n  [AXIS_ID_FILTERS]: [...layout[AXIS_ID_FILTERS]]\n}); // Accepts layout: { columns: ['dx'] }\n// Returns inverse layout: { dx: 'columns' }\n\n\nexport const getInverseLayout = layout => {\n  const entries = Object.entries(layout);\n  const map = {};\n  entries.forEach(_ref => {\n    let [axisId, dimensionIds] = _ref;\n    dimensionIds.forEach(id => {\n      map[id] = axisId;\n    });\n  });\n  return map;\n};","import pick from 'lodash-es/pick';\nexport const OPTION_LEGEND_DISPLAY_STRATEGY = 'legendDisplayStrategy';\nexport const OPTION_LEGEND_DISPLAY_STYLE = 'legendDisplayStyle';\nexport const OPTION_LEGEND_SET = 'legendSet';\nexport const OPTION_SHOW_LEGEND_KEY = 'showLegendKey';\nexport const DISPLAY_DENSITY_COMFORTABLE = 'COMFORTABLE';\nexport const DISPLAY_DENSITY_NORMAL = 'NORMAL';\nexport const DISPLAY_DENSITY_COMPACT = 'COMPACT';\nexport const FONT_SIZE_LARGE = 'LARGE';\nexport const FONT_SIZE_NORMAL = 'NORMAL';\nexport const FONT_SIZE_SMALL = 'SMALL';\nexport const options = {\n  /*\n  TODO: PIVOT TABLE OPTIONS:\n  showHierarchy: { defaultValue: false, requestable: true, savable: true },\n  showDimensionLabels: {\n      defaultValue: false,\n      requestable: false,\n      savable: true,\n  },\n  colTotals: { defaultValue: false, requestable: false, savable: true },\n  colSubTotals: { defaultValue: false, requestable: false, savable: true },\n  rowTotals: { defaultValue: false, requestable: false, savable: true },\n  rowSubTotals: { defaultValue: false, requestable: false, savable: true },\n  // FIXME: hideEmptyRowItems or hideEmptyRows ??\n  hideEmptyRowItems: {\n      defaultValue: 'NONE',\n      requestable: false,\n      savable: true,\n  },\n  hideEmptyRows: { defaultValue: false, requestable: false, savable: true },\n  // TODO: Hide n/a data\n  legend: {\n      defaultValue: {},\n      requestable: false,\n      savable: true,\n  },\n  title: { defaultValue: undefined, requestable: false, savable: true },\n  completedOnly: { defaultValue: false, requestable: true, savable: true },*/\n  displayDensity: {\n    defaultValue: DISPLAY_DENSITY_NORMAL,\n    requestable: false,\n    savable: true\n  },\n  fontSize: {\n    defaultValue: FONT_SIZE_NORMAL,\n    requestable: false,\n    savable: true\n  },\n  digitGroupSeparator: {\n    defaultValue: 'SPACE',\n    requestable: false,\n    savable: true\n  } // TODO: Limit the number of rows shown in the table\n  // TODO: Only show the [top/bottom] x rows\n\n};\nexport default options;\nexport const getOptionsForUi = () => {\n  return Object.entries({ ...options\n  }).reduce((map, _ref) => {\n    let [option, props] = _ref;\n    map[option] = props.defaultValue;\n    return map;\n  }, {});\n};\nexport const getOptionsFromVisualization = visualization => {\n  const optionsFromVisualization = { ...getOptionsForUi(),\n    ...pick(visualization, Object.keys(options))\n  };\n  return optionsFromVisualization;\n};","export const getInputTypeFromVisualization = vis => ({\n  type: vis.outputType\n});","export const removeLastPathSegment = path => {\n  // if root path, then return unprocessed path\n  if (path.match(/\\//g).length === 1) {\n    return path;\n  }\n\n  return path.substr(0, path.lastIndexOf('/'));\n};\nexport const getOuPath = (id, metadata, parentGraphMap) => {\n  if (metadata[id] && metadata[id].path) {\n    return metadata[id].path;\n  } // for root org units\n\n\n  if (parentGraphMap[id] === id || parentGraphMap[id] === '') {\n    return \"/\".concat(id);\n  }\n\n  return parentGraphMap[id] ? \"/\".concat(parentGraphMap[id], \"/\").concat(id) : undefined;\n};","export const getProgramFromVisualisation = vis => {\n  var _vis$program, _vis$programStage;\n\n  return {\n    id: (_vis$program = vis.program) === null || _vis$program === void 0 ? void 0 : _vis$program.id,\n    stageId: (_vis$programStage = vis.programStage) === null || _vis$programStage === void 0 ? void 0 : _vis$programStage.id\n  };\n};","import { layoutGetAllDimensions } from '@dhis2/analytics';\nimport { parseCurrentRepetition } from './ui.js';\nexport const getRepetitionFromVisualisation = vis => {\n  const repetitionByDimension = {};\n  layoutGetAllDimensions(vis).filter(d => d.repetition).forEach(d => {\n    var _d$programStage;\n\n    repetitionByDimension[(_d$programStage = d.programStage) !== null && _d$programStage !== void 0 && _d$programStage.id ? \"\".concat(d.programStage.id, \".\").concat(d.dimension) : d.dimension] = parseCurrentRepetition(d.repetition.indexes);\n  });\n  return repetitionByDimension;\n};","import { DIMENSION_ID_ORGUNIT, layoutGetAxisIdDimensionIdsObject, layoutGetDimensionIdItemIdsObject, VIS_TYPE_LINE_LIST, VIS_TYPE_PIVOT_TABLE } from '@dhis2/analytics';\nimport isObject from 'lodash-es/isObject';\nimport { getInputTypeFromVisualization } from './input.js';\nimport { getAdaptedUiLayoutByType, getInverseLayout } from './layout.js';\nimport { getOptionsFromVisualization } from './options.js';\nimport { removeLastPathSegment } from './orgUnit.js';\nimport { getProgramFromVisualisation } from './program.js';\nimport { getRepetitionFromVisualisation } from './repetition.js';\n\nconst lineListUiAdapter = ui => ({ ...ui,\n  layout: getAdaptedUiLayoutByType(ui.layout, VIS_TYPE_LINE_LIST)\n});\n\nexport const getAdaptedUiByType = ui => {\n  switch (ui.type) {\n    case VIS_TYPE_LINE_LIST:\n      return lineListUiAdapter(ui);\n\n    case VIS_TYPE_PIVOT_TABLE:\n    default:\n      return ui;\n  }\n};\nexport const getUiFromVisualization = function (vis) {\n  let currentState = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return { ...currentState,\n    input: getInputTypeFromVisualization(vis),\n    program: getProgramFromVisualisation(vis),\n    options: getOptionsFromVisualization(vis),\n    layout: layoutGetAxisIdDimensionIdsObject(vis),\n    itemsByDimension: layoutGetDimensionIdItemIdsObject(vis),\n    conditions: getConditionsFromVisualization(vis),\n    parentGraphMap: vis.parentGraphMap || getParentGraphMapFromVisualization(vis) || currentState.parentGraphMap,\n    repetitionByDimension: getRepetitionFromVisualisation(vis)\n  };\n};\nexport const getParentGraphMapFromVisualization = vis => {\n  const dimensionIdsByAxis = layoutGetAxisIdDimensionIdsObject(vis);\n  const inverseLayout = getInverseLayout(dimensionIdsByAxis);\n  const ouAxis = inverseLayout[DIMENSION_ID_ORGUNIT];\n\n  if (!ouAxis) {\n    return {};\n  }\n\n  const parentGraphMap = {};\n  const ouDimension = vis[ouAxis].find(dimension => dimension.dimension === DIMENSION_ID_ORGUNIT);\n  ouDimension.items.filter(orgUnit => orgUnit.path).forEach(orgUnit => {\n    if ('/' + orgUnit.id === orgUnit.path) {\n      // root org unit case\n      parentGraphMap[orgUnit.id] = '';\n    } else {\n      const path = removeLastPathSegment(orgUnit.path);\n      parentGraphMap[orgUnit.id] = path[0] === '/' ? path.substr(1) : path;\n    }\n  });\n  return parentGraphMap;\n};\n\nconst getConditionsFromVisualization = vis => [...vis.columns, ...vis.rows, ...vis.filters].filter(item => item.filter || item.legendSet).reduce((acc, key) => {\n  var _key$programStage, _key$legendSet;\n\n  return { ...acc,\n    [(_key$programStage = key.programStage) !== null && _key$programStage !== void 0 && _key$programStage.id ? \"\".concat(key.programStage.id, \".\").concat(key.dimension) : key.dimension]: {\n      condition: key.filter,\n      legendSet: (_key$legendSet = key.legendSet) === null || _key$legendSet === void 0 ? void 0 : _key$legendSet.id\n    }\n  };\n}, {}); // Repetition\n\n\nexport const PROP_MOST_RECENT = 'mostRecent';\nexport const PROP_OLDEST = 'oldest';\nexport const getDefaultCurrentRepetition = () => [];\nexport const getDefaultUiRepetition = () => ({\n  [PROP_MOST_RECENT]: 1,\n  [PROP_OLDEST]: 0\n});\nexport const PARSE_CURRENT_REPETITION_ERROR = 'parseCurrentRepetition: Invalid input';\nexport const PARSE_UI_REPETITION_ERROR = 'parseUiRepetition: Invalid input';\nexport const parseCurrentRepetition = repetition => {\n  if (!(Array.isArray(repetition) && repetition.every(i => Number.isFinite(i)))) {\n    throw new Error(PARSE_CURRENT_REPETITION_ERROR);\n  }\n\n  return repetition.length ? {\n    [PROP_MOST_RECENT]: repetition.filter(n => n < 1).length,\n    [PROP_OLDEST]: repetition.filter(n => n > 0).length\n  } : getDefaultUiRepetition();\n};\nexport const parseUiRepetition = repetition => {\n  if (!(isObject(repetition) && Number.isFinite(repetition[PROP_MOST_RECENT]) && repetition[PROP_MOST_RECENT] >= 0 && Number.isFinite(repetition[PROP_OLDEST]) && repetition[PROP_OLDEST] >= 0)) {\n    throw new Error(PARSE_UI_REPETITION_ERROR);\n  } // default\n\n\n  if (repetition[PROP_OLDEST] === 0 && [0, 1].includes(repetition[PROP_MOST_RECENT])) {\n    return getDefaultCurrentRepetition();\n  }\n\n  return [...new Array(repetition[PROP_OLDEST]).fill().map((_, i) => i + 1), ...new Array(repetition[PROP_MOST_RECENT]).fill().map((_, i) => -i + 0).sort((a, b) => a - b)];\n};","import { useState, useEffect, useRef } from 'react';\nconst DEFAULT_USER_INPUT_DELAY = 500;\nexport const useDebounce = function (value) {\n  let delay = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : DEFAULT_USER_INPUT_DELAY;\n  const [debouncedValue, setDebouncedValue] = useState(value);\n  useEffect(() => {\n    const handler = setTimeout(() => {\n      setDebouncedValue(value);\n    }, delay);\n    return () => {\n      clearTimeout(handler);\n    };\n  }, [value, delay]);\n  return debouncedValue;\n};\nexport const useDidUpdateEffect = (fn, inputs) => {\n  const didMountRef = useRef(false);\n  useEffect(() => {\n    if (didMountRef.current) {\n      fn();\n    } else {\n      didMountRef.current = true;\n    }\n  }, inputs);\n};\nexport const formatDimensionId = (dimensionId, programStageId) => programStageId ? \"\".concat(programStageId, \".\").concat(dimensionId) : dimensionId;\nexport const extractDimensionIdParts = input => {\n  const [dimensionId, rawStageId] = input.split('.').reverse();\n  const [programStageId, repetitionIndex] = (rawStageId || '').split('[');\n  return {\n    dimensionId,\n    programStageId,\n    repetitionIndex: (repetitionIndex === null || repetitionIndex === void 0 ? void 0 : repetitionIndex.length) && repetitionIndex.substring(0, repetitionIndex.indexOf(']'))\n  };\n};","import { dimensionCreate, VIS_TYPE_LINE_LIST } from '@dhis2/analytics';\nimport pick from 'lodash-es/pick';\nimport { BASE_FIELD_TYPE } from './fields.js';\nimport { getAdaptedUiLayoutByType } from './layout.js';\nimport { options } from './options.js';\nimport { parseUiRepetition } from './ui.js';\nimport { extractDimensionIdParts } from './utils.js';\nexport const getDefaultFromUi = (current, ui) => {\n  const adaptedUi = { ...ui,\n    layout: { ...getAdaptedUiLayoutByType(ui.layout, VIS_TYPE_LINE_LIST)\n    },\n    itemsByDimension: getItemsByDimensionFromUi(ui)\n  };\n  return { ...current,\n    // TODO: This turns it in to an \"update existing\" rather than a \"create from scratch\" operation, is this intentional?\n    [BASE_FIELD_TYPE]: adaptedUi.type,\n    outputType: adaptedUi.input.type,\n    ...getProgramFromUi(adaptedUi),\n    ...getProgramStageFromUi(adaptedUi),\n    ...getAxesFromUi(adaptedUi),\n    ...getOptionsFromUi(adaptedUi)\n  };\n};\nexport const getProgramFromUi = ui => {\n  var _ui$program;\n\n  return {\n    program: {\n      id: (_ui$program = ui.program) === null || _ui$program === void 0 ? void 0 : _ui$program.id\n    }\n  };\n};\nexport const getProgramStageFromUi = ui => {\n  var _ui$program2, _ui$program3;\n\n  return (_ui$program2 = ui.program) !== null && _ui$program2 !== void 0 && _ui$program2.stageId ? {\n    programStage: {\n      id: (_ui$program3 = ui.program) === null || _ui$program3 === void 0 ? void 0 : _ui$program3.stageId\n    }\n  } : {};\n};\nexport const getOptionsFromUi = ui => pick(ui.options, Object.keys(options));\nexport const getAxesFromUi = ui => Object.entries(ui.layout).reduce((layout, _ref) => {\n  let [axisId, dimensionIds] = _ref;\n  return { ...layout,\n    [axisId]: dimensionIds.map(id => {\n      var _ui$conditions$id, _ui$conditions$id2;\n\n      const {\n        dimensionId,\n        programStageId\n      } = extractDimensionIdParts(id);\n      return dimensionCreate(dimensionId, ui.itemsByDimension[id], {\n        filter: (_ui$conditions$id = ui.conditions[id]) === null || _ui$conditions$id === void 0 ? void 0 : _ui$conditions$id.condition,\n        ...(((_ui$conditions$id2 = ui.conditions[id]) === null || _ui$conditions$id2 === void 0 ? void 0 : _ui$conditions$id2.legendSet) && {\n          legendSet: {\n            id: ui.conditions[id].legendSet\n          }\n        }),\n        ...(ui.repetitionByDimension && ui.repetitionByDimension[id] && {\n          repetition: {\n            indexes: parseUiRepetition(ui.repetitionByDimension[id])\n          }\n        }),\n        ...(programStageId && {\n          programStage: {\n            id: programStageId\n          }\n        })\n      });\n    }).filter(dim => dim !== null)\n  };\n}, {});\nexport const getItemsByDimensionFromUi = ui => {\n  const result = {};\n  Object.keys(ui.itemsByDimension).forEach(key => result[key] = ui.itemsByDimension[key]);\n  return result;\n};","import { getDefaultFromUi } from '../modules/current.js';\nexport const SET_CURRENT = 'SET_CURRENT';\nexport const SET_CURRENT_FROM_UI = 'SET_CURRENT_FROM_UI';\nexport const CLEAR_CURRENT = 'CLEAR_CURRENT';\nexport const DEFAULT_CURRENT = null;\nexport default (function () {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : DEFAULT_CURRENT;\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    case SET_CURRENT:\n      {\n        return action.value;\n      }\n\n    case SET_CURRENT_FROM_UI:\n      {\n        switch (action.value.type) {\n          default:\n            {\n              return getDefaultFromUi(state, action.value);\n            }\n        }\n      }\n\n    case CLEAR_CURRENT:\n      return DEFAULT_CURRENT;\n\n    default:\n      return state;\n  }\n}); // Selectors\n\nexport const sGetCurrent = state => state.current;\nexport const sGetCurrentId = state => {\n  var _state$current;\n\n  return (_state$current = state.current) === null || _state$current === void 0 ? void 0 : _state$current.id;\n};\nexport const sGetCurrentFromUi = state => {\n  const ui = state.ui;\n\n  switch (ui.type) {\n    default:\n      {\n        return getDefaultFromUi(state.current, ui);\n      }\n  }\n};","/**PROGRAM**/\nimport { DIMENSION_TYPE_CATEGORY, DIMENSION_TYPE_CATEGORY_OPTION_GROUP_SET, DIMENSION_TYPE_DATA_ELEMENT, DIMENSION_TYPE_PROGRAM_ATTRIBUTE, DIMENSION_TYPE_PROGRAM_INDICATOR, DIMENSION_TYPE_ORGANISATION_UNIT_GROUP_SET } from '@dhis2/analytics';\nexport const DIMENSION_TYPES_PROGRAM = new Set([DIMENSION_TYPE_DATA_ELEMENT, DIMENSION_TYPE_PROGRAM_ATTRIBUTE, DIMENSION_TYPE_PROGRAM_INDICATOR, DIMENSION_TYPE_CATEGORY, DIMENSION_TYPE_CATEGORY_OPTION_GROUP_SET]);\nexport const DIMENSION_TYPES_YOURS = new Set([DIMENSION_TYPE_ORGANISATION_UNIT_GROUP_SET]);\n/**MAIN**/\n\nexport const DIMENSION_TYPE_STATUS = 'STATUS';\nexport const DIMENSION_TYPE_USER = 'USER';\n/** DIMENSION_IDS */\n\nexport const DIMENSION_ID_PROGRAM_STATUS = 'programStatus';\nexport const DIMENSION_ID_EVENT_STATUS = 'eventStatus';\nexport const DIMENSION_ID_CREATED_BY = 'createdBy';\nexport const DIMENSION_ID_LAST_UPDATED_BY = 'lastUpdatedBy';\n/**TIME - specific time dimensions**/\n\nexport const DIMENSION_ID_EVENT_DATE = 'eventDate';\nexport const DIMENSION_ID_ENROLLMENT_DATE = 'enrollmentDate';\nexport const DIMENSION_ID_INCIDENT_DATE = 'incidentDate';\nexport const DIMENSION_ID_SCHEDULED_DATE = 'scheduledDate';\nexport const DIMENSION_ID_LAST_UPDATED = 'lastUpdated';\nexport const DIMENSION_IDS_TIME = new Set([DIMENSION_ID_EVENT_DATE, DIMENSION_ID_ENROLLMENT_DATE, DIMENSION_ID_INCIDENT_DATE, DIMENSION_ID_SCHEDULED_DATE, DIMENSION_ID_LAST_UPDATED]);\nexport const getUiDimensionType = _ref => {\n  let {\n    dimensionId,\n    dimensionType\n  } = _ref;\n\n  switch (dimensionId) {\n    case DIMENSION_ID_PROGRAM_STATUS:\n    case DIMENSION_ID_EVENT_STATUS:\n      return DIMENSION_TYPE_STATUS;\n\n    case DIMENSION_ID_CREATED_BY:\n    case DIMENSION_ID_LAST_UPDATED_BY:\n      return DIMENSION_TYPE_USER;\n\n    default:\n      return dimensionType;\n  }\n};","export const PROGRAM_TYPE_WITHOUT_REGISTRATION = 'WITHOUT_REGISTRATION';\nexport const PROGRAM_TYPE_WITH_REGISTRATION = 'WITH_REGISTRATION';","export const SET_VISUALIZATION = 'SET_VISUALIZATION';\nexport const CLEAR_VISUALIZATION = 'CLEAR_VISUALIZATION';\nexport const DEFAULT_VISUALIZATION = null;\nexport default (function () {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : DEFAULT_VISUALIZATION;\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    case SET_VISUALIZATION:\n      {\n        return action.value;\n      }\n\n    case CLEAR_VISUALIZATION:\n      {\n        return DEFAULT_VISUALIZATION;\n      }\n\n    default:\n      return state;\n  }\n}); // Selectors\n\nexport const sGetVisualization = state => state.visualization;\nexport const sGetInterpretations = state => state.visualization ? state.visualization.interpretations : [];","import { AXIS_ID_COLUMNS, AXIS_ID_ROWS, AXIS_ID_FILTERS, VIS_TYPE_LINE_LIST, VIS_TYPE_PIVOT_TABLE, DIMENSION_ID_ORGUNIT, DIMENSION_ID_PERIOD, DIMENSION_TYPE_DATA_ELEMENT, DIMENSION_TYPE_PROGRAM_DATA_ELEMENT, DIMENSION_TYPE_PERIOD } from '@dhis2/analytics';\nimport i18n from '@dhis2/d2-i18n';\nimport { DEFAULT_CURRENT } from '../reducers/current.js';\nimport { DEFAULT_VISUALIZATION } from '../reducers/visualization.js';\nimport { DIMENSION_ID_CREATED_BY, DIMENSION_ID_EVENT_STATUS, DIMENSION_ID_EVENT_DATE, DIMENSION_ID_ENROLLMENT_DATE, DIMENSION_ID_INCIDENT_DATE, DIMENSION_ID_SCHEDULED_DATE, DIMENSION_ID_LAST_UPDATED, DIMENSION_ID_LAST_UPDATED_BY, DIMENSION_ID_PROGRAM_STATUS } from './dimensionConstants.js';\nimport { default as options } from './options.js';\nexport const STATUS_ACTIVE = 'ACTIVE';\nexport const STATUS_CANCELLED = 'CANCELLED';\nexport const STATUS_COMPLETED = 'COMPLETED';\nexport const OUTPUT_TYPE_EVENT = 'EVENT';\nexport const OUTPUT_TYPE_ENROLLMENT = 'ENROLLMENT';\nexport const statusNames = {\n  [STATUS_ACTIVE]: i18n.t('Active'),\n  [STATUS_CANCELLED]: i18n.t('Cancelled'),\n  [STATUS_COMPLETED]: i18n.t('Completed')\n};\nexport const headersMap = {\n  [DIMENSION_ID_ORGUNIT]: 'ouname',\n  [DIMENSION_ID_PROGRAM_STATUS]: 'programstatus',\n  [DIMENSION_ID_EVENT_STATUS]: 'eventstatus',\n  [DIMENSION_ID_CREATED_BY]: 'createdbydisplayname',\n  [DIMENSION_ID_LAST_UPDATED_BY]: 'lastupdatedbydisplayname',\n  [DIMENSION_ID_EVENT_DATE]: 'eventdate',\n  [DIMENSION_ID_ENROLLMENT_DATE]: 'enrollmentdate',\n  [DIMENSION_ID_INCIDENT_DATE]: 'incidentdate',\n  [DIMENSION_ID_SCHEDULED_DATE]: 'scheduleddate',\n  [DIMENSION_ID_LAST_UPDATED]: 'lastupdated'\n};\nexport const outputTypeTimeDimensionMap = {\n  [OUTPUT_TYPE_EVENT]: DIMENSION_ID_EVENT_DATE,\n  [OUTPUT_TYPE_ENROLLMENT]: DIMENSION_ID_ENROLLMENT_DATE\n};\nexport const transformVisualization = visualization => {\n  const transformedColumns = transformDimensions(visualization[AXIS_ID_COLUMNS], visualization);\n  const transformedRows = transformDimensions(visualization[AXIS_ID_ROWS], visualization);\n  const transformedFilters = transformDimensions(visualization[AXIS_ID_FILTERS], visualization); // convert completedOnly option to eventStatus = COMPLETED filter\n\n  if (visualization.completedOnly && visualization.outputType === OUTPUT_TYPE_EVENT) {\n    transformedFilters.push({\n      dimension: DIMENSION_ID_EVENT_STATUS,\n      items: [{\n        id: STATUS_COMPLETED\n      }]\n    });\n  }\n\n  const transformedVisualization = { ...visualization\n  };\n  delete transformedVisualization.completedOnly;\n  return { ...transformedVisualization,\n    [AXIS_ID_COLUMNS]: transformedColumns,\n    [AXIS_ID_ROWS]: transformedRows,\n    [AXIS_ID_FILTERS]: transformedFilters\n  };\n};\n\nconst transformDimensions = (dimensions, _ref) => {\n  let {\n    outputType,\n    type\n  } = _ref;\n  return dimensions.filter(dimensionObj => !['longitude', 'latitude'].includes(dimensionObj.dimension)).map(dimensionObj => {\n    if (dimensionObj.dimensionType === DIMENSION_TYPE_PROGRAM_DATA_ELEMENT) {\n      return { ...dimensionObj,\n        dimensionType: DIMENSION_TYPE_DATA_ELEMENT\n      };\n    } else if (dimensionObj.dimension === DIMENSION_ID_PERIOD && type === VIS_TYPE_LINE_LIST) {\n      return { ...dimensionObj,\n        dimension: outputTypeTimeDimensionMap[outputType],\n        dimensionType: DIMENSION_TYPE_PERIOD\n      };\n    } else {\n      return dimensionObj;\n    }\n  });\n};\n\nexport const visTypes = [{\n  type: VIS_TYPE_LINE_LIST\n}, {\n  type: VIS_TYPE_PIVOT_TABLE,\n  disabled: true\n}];\nexport const visTypeDescriptions = {\n  [VIS_TYPE_LINE_LIST]: i18n.t('List data from tracked entities and events.'),\n  [VIS_TYPE_PIVOT_TABLE]: i18n.t('Explore data with manipulatable columns, rows, and aggregations.')\n};\nconst defaultRemoveDimensionProps = ['dimensionType', 'valueType'];\n\nconst removeDimensionPropsBeforeSaving = function (axis) {\n  let props = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : defaultRemoveDimensionProps;\n  return axis === null || axis === void 0 ? void 0 : axis.map(dim => {\n    const dimension = Object.assign({}, dim);\n    props.forEach(prop => {\n      delete dimension[prop];\n    });\n    return dimension;\n  });\n};\n\nexport const getVisualizationFromCurrent = current => {\n  const visualization = Object.assign({}, current);\n  const nonSavableOptions = Object.keys(options).filter(option => !options[option].savable);\n  nonSavableOptions.forEach(option => delete visualization[option]);\n  visualization.columns = removeDimensionPropsBeforeSaving(visualization.columns);\n  visualization.filters = removeDimensionPropsBeforeSaving(visualization.filters); // When saving a copy of an AO created with the Event Reports app, remove the legacy flag.\n  // This copy won't work in Event Reports app anyway.\n  // This also unlocks the Save button on the copied (and converted to new format) AO in LL app.\n\n  delete visualization.legacy;\n  return visualization;\n};\nexport const getVisualizationState = (visualization, current) => {\n  if (current === DEFAULT_CURRENT) {\n    return STATE_EMPTY;\n  } else if (visualization === DEFAULT_VISUALIZATION) {\n    return STATE_UNSAVED;\n  } else if (current === visualization) {\n    return STATE_SAVED;\n  } else {\n    return STATE_DIRTY;\n  }\n};\nexport const STATE_EMPTY = 'EMPTY';\nexport const STATE_SAVED = 'SAVED';\nexport const STATE_UNSAVED = 'UNSAVED';\nexport const STATE_DIRTY = 'DIRTY';\nexport const dimensionMetadataPropMap = {\n  dataElementDimensions: 'dataElement',\n  attributeDimensions: 'attribute',\n  programIndicatorDimensions: 'programIndicator',\n  categoryDimensions: 'category',\n  categoryOptionGroupSetDimensions: 'categoryOptionGroupSet',\n  organisationUnitGroupSetDimensions: 'organisationUnitGroupSet',\n  dataElementGroupSetDimensions: 'dataElementGroupSet'\n}; // Loop through and collect dimension metadata from the visualization\n\nexport const getDimensionMetadataFromVisualization = visualization => Object.entries(dimensionMetadataPropMap).reduce((metaData, _ref2) => {\n  let [listName, dimensionName] = _ref2;\n  const dimensionList = visualization[listName] || [];\n  dimensionList.forEach(dimensionWrapper => {\n    const dimension = dimensionWrapper[dimensionName];\n    metaData[dimension.id] = dimension;\n  });\n  return metaData;\n}, {});\nexport const getDimensionMetadataFields = () => Object.entries(dimensionMetadataPropMap).map(_ref3 => {\n  let [listName, objectName] = _ref3;\n  return \"\".concat(listName, \"[\").concat(objectName, \"[id,name]]\");\n});","import { DIMENSION_ID_ORGUNIT, DIMENSION_TYPE_ORGANISATION_UNIT } from '@dhis2/analytics';\nimport i18n from '@dhis2/d2-i18n';\nimport { DIMENSION_ID_CREATED_BY, DIMENSION_ID_PROGRAM_STATUS, DIMENSION_ID_EVENT_STATUS, DIMENSION_ID_LAST_UPDATED_BY, DIMENSION_TYPE_STATUS, DIMENSION_TYPE_USER } from './dimensionConstants.js';\nimport { PROGRAM_TYPE_WITHOUT_REGISTRATION } from './programTypes.js';\nimport { OUTPUT_TYPE_ENROLLMENT, OUTPUT_TYPE_EVENT } from './visualization.js';\nexport const getMainDimensions = () => ({\n  [DIMENSION_ID_ORGUNIT]: {\n    id: DIMENSION_ID_ORGUNIT,\n    dimensionType: DIMENSION_TYPE_ORGANISATION_UNIT,\n    name: i18n.t('Organisation unit')\n  },\n  [DIMENSION_ID_EVENT_STATUS]: {\n    id: DIMENSION_ID_EVENT_STATUS,\n    dimensionType: DIMENSION_TYPE_STATUS,\n    name: i18n.t('Event status')\n  },\n  [DIMENSION_ID_PROGRAM_STATUS]: {\n    id: DIMENSION_ID_PROGRAM_STATUS,\n    dimensionType: DIMENSION_TYPE_STATUS,\n    name: i18n.t('Program status')\n  },\n  [DIMENSION_ID_CREATED_BY]: {\n    id: DIMENSION_ID_CREATED_BY,\n    dimensionType: DIMENSION_TYPE_USER,\n    name: i18n.t('Created by')\n  },\n  [DIMENSION_ID_LAST_UPDATED_BY]: {\n    id: DIMENSION_ID_LAST_UPDATED_BY,\n    dimensionType: DIMENSION_TYPE_USER,\n    name: i18n.t('Last updated by')\n  }\n});\nexport const getIsMainDimensionDisabled = _ref => {\n  let {\n    dimensionId,\n    inputType,\n    programType\n  } = _ref;\n\n  if (dimensionId === DIMENSION_ID_PROGRAM_STATUS && inputType === OUTPUT_TYPE_EVENT) {\n    if (!programType) {\n      return i18n.t('No program selected');\n    } else if (programType === PROGRAM_TYPE_WITHOUT_REGISTRATION) {\n      return i18n.t('Not applicable to event programs');\n    }\n  } else if (dimensionId === DIMENSION_ID_EVENT_STATUS && inputType === OUTPUT_TYPE_ENROLLMENT) {\n    return i18n.t('Not applicable to enrollments');\n  }\n\n  return false;\n};","import { DIMENSION_TYPE_PERIOD } from '@dhis2/analytics';\nimport i18n from '@dhis2/d2-i18n';\nimport { DIMENSION_ID_EVENT_DATE, DIMENSION_ID_ENROLLMENT_DATE, DIMENSION_ID_INCIDENT_DATE, // DIMENSION_ID_SCHEDULED_DATE,\nDIMENSION_ID_LAST_UPDATED } from './dimensionConstants.js';\nimport { PROGRAM_TYPE_WITH_REGISTRATION } from './programTypes.js';\nimport { OUTPUT_TYPE_EVENT, OUTPUT_TYPE_ENROLLMENT } from './visualization.js';\nconst NAME_PARENT_PROPERTY_PROGRAM = 'program';\nconst NAME_PARENT_PROPERTY_STAGE = 'stage'; // TODO: Scheduled date will be implemented soon, hopefully 2.39\n// so it was decided to keep SCHEDULED_DATE code but comment it out\n\nexport const getTimeDimensions = () => ({\n  [DIMENSION_ID_EVENT_DATE]: {\n    id: DIMENSION_ID_EVENT_DATE,\n    dimensionType: DIMENSION_TYPE_PERIOD,\n    name: i18n.t('Event date'),\n    nameParentProperty: NAME_PARENT_PROPERTY_STAGE,\n    nameProperty: 'displayExecutionDateLabel'\n  },\n  [DIMENSION_ID_ENROLLMENT_DATE]: {\n    id: DIMENSION_ID_ENROLLMENT_DATE,\n    dimensionType: DIMENSION_TYPE_PERIOD,\n    name: i18n.t('Enrollment date'),\n    nameParentProperty: NAME_PARENT_PROPERTY_PROGRAM,\n    nameProperty: 'displayEnrollmentDateLabel'\n  },\n  [DIMENSION_ID_INCIDENT_DATE]: {\n    id: DIMENSION_ID_INCIDENT_DATE,\n    dimensionType: DIMENSION_TYPE_PERIOD,\n    name: i18n.t('Incident date'),\n    nameParentProperty: NAME_PARENT_PROPERTY_PROGRAM,\n    nameProperty: 'displayIncidentDateLabel'\n  },\n\n  /***** NOT in MVP / 2.38 release *****\n  [DIMENSION_ID_SCHEDULED_DATE]: {\n      id: DIMENSION_ID_SCHEDULED_DATE,\n      dimensionType: DIMENSION_TYPE_PERIOD,\n      name: i18n.t('Due/Scheduled date'),\n      nameParentProperty: NAME_PARENT_PROPERTY_STAGE,\n      nameProperty: 'displayDueDateLabel',\n  },\n  */\n  [DIMENSION_ID_LAST_UPDATED]: {\n    id: DIMENSION_ID_LAST_UPDATED,\n    dimensionType: DIMENSION_TYPE_PERIOD,\n    name: i18n.t('Last updated on')\n  }\n});\nexport const getTimeDimensionName = (dimension, program, stage) => {\n  if (!dimension.nameParentProperty || !program) {\n    return dimension.name;\n  }\n\n  const name = dimension.nameParentProperty === NAME_PARENT_PROPERTY_PROGRAM ? program[dimension.nameProperty] : stage === null || stage === void 0 ? void 0 : stage[dimension.nameProperty];\n  return name || dimension.name;\n};\nexport const getDisabledTimeDimensions = (inputType, program\n/*, stage */\n) => {\n  switch (inputType) {\n    case OUTPUT_TYPE_EVENT:\n      {\n        const disabledDimensions = {};\n\n        if ((program === null || program === void 0 ? void 0 : program.programType) === PROGRAM_TYPE_WITH_REGISTRATION) {\n          if (program.displayIncidentDate === false) {\n            disabledDimensions[DIMENSION_ID_INCIDENT_DATE] = i18n.t('Disabled by the selected program');\n          } // if (stage.hideDueDate === false) {\n          //     disabledDimensions[DIMENSION_ID_SCHEDULED_DATE] =\n          //         i18n.t(\n          //             'Disabled by the selected program stage'\n          //         )\n          // }\n\n        } else {\n          const disabledReason = !program ? i18n.t('No program selected') : i18n.t('Not applicable to event programs');\n          disabledDimensions[DIMENSION_ID_ENROLLMENT_DATE] = disabledReason;\n          disabledDimensions[DIMENSION_ID_INCIDENT_DATE] = disabledReason;\n        }\n\n        return disabledDimensions;\n      }\n\n    case OUTPUT_TYPE_ENROLLMENT:\n      {\n        const disabledDimensions = {};\n        disabledDimensions[DIMENSION_ID_EVENT_DATE] = i18n.t('Not applicable to enrollments');\n\n        if (!program || program.displayIncidentDate === false) {\n          const disabledReason = !program ? i18n.t('No program selected') : i18n.t('Disabled by the selected program');\n          disabledDimensions[DIMENSION_ID_INCIDENT_DATE] = disabledReason;\n        }\n\n        return disabledDimensions;\n      }\n\n    default:\n      {\n        const disabledReason = i18n.t('No input type selected');\n        return {\n          [DIMENSION_ID_EVENT_DATE]: disabledReason,\n          [DIMENSION_ID_ENROLLMENT_DATE]: disabledReason,\n          [DIMENSION_ID_INCIDENT_DATE]: disabledReason,\n          [DIMENSION_ID_LAST_UPDATED]: disabledReason\n        };\n      }\n  }\n};","export const ADD_METADATA = 'ADD_METADATA';\nexport const CLEAR_METADATA = 'CLEAR_METADATA';\nconst EMPTY_METADATA = {};\nexport default (function () {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : EMPTY_METADATA;\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    case ADD_METADATA:\n      {\n        const result = { ...state\n        };\n        Object.entries(action.value).forEach(_ref => {\n          let [key, value] = _ref;\n          return result[key] = { ...result[key],\n            ...value\n          };\n        });\n        return result;\n      }\n\n    case CLEAR_METADATA:\n      return EMPTY_METADATA;\n\n    default:\n      return state;\n  }\n}); // Selectors\n\nexport const sGetMetadata = state => state.metadata;\nexport const sGetMetadataById = (state, id) => state.metadata[id];","/*eslint no-unused-vars: [\"error\", { \"ignoreRestSiblings\": true }]*/\nimport { DIMENSION_ID_ORGUNIT, USER_ORG_UNIT, VIS_TYPE_LINE_LIST } from '@dhis2/analytics';\nimport { useMemo } from 'react';\nimport { useStore, useSelector } from 'react-redux';\nimport { createSelector } from 'reselect';\nimport { DIMENSION_ID_EVENT_DATE, DIMENSION_ID_ENROLLMENT_DATE, DIMENSION_ID_INCIDENT_DATE, // DIMENSION_ID_SCHEDULED_DATE,\nDIMENSION_ID_LAST_UPDATED, DIMENSION_ID_EVENT_STATUS, DIMENSION_ID_PROGRAM_STATUS } from '../modules/dimensionConstants.js';\nimport { getFilteredLayout } from '../modules/layout.js';\nimport { getMainDimensions, getIsMainDimensionDisabled } from '../modules/mainDimensions.js';\nimport { getOptionsForUi } from '../modules/options.js';\nimport { getDisabledTimeDimensions } from '../modules/timeDimensions.js';\nimport { getAdaptedUiByType, getUiFromVisualization } from '../modules/ui.js';\nimport { OUTPUT_TYPE_EVENT } from '../modules/visualization.js';\nimport { sGetMetadata, sGetMetadataById } from './metadata.js';\nexport const SET_UI_DRAGGING_ID = 'SET_UI_DRAGGING_ID';\nexport const SET_UI_INPUT = 'SET_UI_INPUT';\nexport const CLEAR_UI_PROGRAM = 'CLEAR_UI_PROGRAM';\nexport const CLEAR_UI_STAGE_ID = 'CLEAR_UI_STAGE_ID';\nexport const UPDATE_UI_PROGRAM_ID = 'UPDATE_UI_PROGRAM_ID';\nexport const UPDATE_UI_PROGRAM_STAGE_ID = 'UPDATE_UI_PROGRAM_STAGE_ID';\nexport const SET_UI_OPTIONS = 'SET_UI_OPTIONS';\nexport const SET_UI_OPTION = 'SET_UI_OPTION';\nexport const ADD_UI_LAYOUT_DIMENSIONS = 'ADD_UI_LAYOUT_DIMENSIONS';\nexport const REMOVE_UI_LAYOUT_DIMENSIONS = 'REMOVE_UI_LAYOUT_DIMENSIONS';\nexport const SET_UI_LAYOUT = 'SET_UI_LAYOUT';\nexport const SET_UI_FROM_VISUALIZATION = 'SET_UI_FROM_VISUALIZATION';\nexport const CLEAR_UI = 'CLEAR_UI';\nexport const SET_UI_DETAILS_PANEL_OPEN = 'SET_UI_DETAILS_PANEL_OPEN';\nexport const SET_UI_ACCESSORY_PANEL_OPEN = 'SET_UI_ACCESSORY_PANEL_OPEN';\nexport const SET_UI_EXPANDED_LAYOUT_PANEL = 'SET_UI_EXPANDED_LAYOUT_PANEL';\nexport const SET_UI_ACTIVE_MODAL_DIALOG = 'SET_UI_ACTIVE_MODAL_DIALOG';\nexport const SET_UI_ITEMS = 'SET_UI_ITEMS';\nexport const REMOVE_UI_ITEMS = 'REMOVE_UI_ITEMS';\nexport const ADD_UI_PARENT_GRAPH_MAP = 'ADD_UI_PARENT_GRAPH_MAP';\nexport const SET_UI_CONDITIONS = 'SET_UI_CONDITIONS';\nexport const SET_UI_REPETITION = 'SET_UI_REPETITION';\nexport const REMOVE_UI_REPETITION = 'REMOVE_UI_REPETITION';\nconst EMPTY_UI = {\n  draggingId: null,\n  type: VIS_TYPE_LINE_LIST,\n  input: {\n    type: OUTPUT_TYPE_EVENT\n  },\n  program: {\n    id: undefined,\n    stageId: undefined\n  },\n  layout: {\n    columns: [],\n    filters: []\n  },\n  itemsByDimension: {},\n  options: {},\n  parentGraphMap: {},\n  repetitionByDimension: {}\n};\nexport const DEFAULT_UI = {\n  draggingId: null,\n  type: VIS_TYPE_LINE_LIST,\n  input: {\n    type: OUTPUT_TYPE_EVENT\n  },\n  program: {},\n  layout: {\n    // TODO: Populate the layout with the correct default dimensions, these are just temporary for testing\n    columns: [DIMENSION_ID_ORGUNIT],\n    filters: []\n  },\n  itemsByDimension: {\n    [DIMENSION_ID_ORGUNIT]: [],\n    [DIMENSION_ID_EVENT_STATUS]: [],\n    [DIMENSION_ID_PROGRAM_STATUS]: []\n  },\n  options: getOptionsForUi(),\n  showAccessoryPanel: false,\n  showDetailsPanel: false,\n  showExpandedLayoutPanel: false,\n  activeModalDialog: null,\n  parentGraphMap: {},\n  repetitionByDimension: {},\n  conditions: {}\n};\n\nconst getPreselectedUi = options => {\n  const {\n    rootOrgUnits,\n    digitGroupSeparator\n  } = options;\n  const rootOrgUnitIds = rootOrgUnits.filter(root => root.id).map(root => root.id);\n  const parentGraphMap = { ...DEFAULT_UI.parentGraphMap\n  };\n  rootOrgUnitIds.forEach(id => {\n    parentGraphMap[id] = '';\n  });\n  return { ...DEFAULT_UI,\n    options: { ...DEFAULT_UI.options,\n      digitGroupSeparator\n    },\n    itemsByDimension: { ...DEFAULT_UI.itemsByDimension,\n      [DIMENSION_ID_ORGUNIT]: [USER_ORG_UNIT]\n    },\n    parentGraphMap\n  };\n};\n\nexport default (function () {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : EMPTY_UI;\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    case SET_UI_DRAGGING_ID:\n      {\n        return { ...state,\n          draggingId: action.value\n        };\n      }\n\n    case SET_UI_INPUT:\n      {\n        return { ...state,\n          input: action.value\n        };\n      }\n\n    case CLEAR_UI_PROGRAM:\n      {\n        return { ...state,\n          program: EMPTY_UI.program\n        };\n      }\n\n    case CLEAR_UI_STAGE_ID:\n      {\n        return { ...state,\n          program: {\n            id: state.program.id,\n            stageId: undefined\n          }\n        };\n      }\n\n    case UPDATE_UI_PROGRAM_ID:\n      {\n        return { ...state,\n          program: { ...state.program,\n            id: action.value\n          }\n        };\n      }\n\n    case UPDATE_UI_PROGRAM_STAGE_ID:\n      {\n        return { ...state,\n          program: { ...state.program,\n            stageId: action.value\n          }\n        };\n      }\n\n    case SET_UI_OPTIONS:\n      {\n        return { ...state,\n          options: { ...state.options,\n            ...action.value\n          }\n        };\n      }\n    // action.value: transfer object (dimensionId:axisId) saying what to add where: { ou: 'rows' }\n    // Reducer takes care of swapping (retransfer) if dimension already exists in layout\n\n    case ADD_UI_LAYOUT_DIMENSIONS:\n      {\n        const transfers = { ...action.value\n        };\n        let newLayout = state.layout; // Add dimension ids to destination (axisId === null means remove from layout)\n\n        Object.entries(transfers).forEach(_ref => {\n          let [dimensionId, {\n            axisId,\n            index\n          }] = _ref;\n\n          if (newLayout[axisId]) {\n            // Filter out transferred dimension id (remove from source)\n            newLayout = getFilteredLayout(newLayout, [dimensionId]);\n\n            if (index === null || index === undefined) {\n              newLayout[axisId].push(dimensionId);\n            } else {\n              newLayout[axisId].splice(index, 0, dimensionId);\n            }\n          }\n        });\n        return { ...state,\n          layout: newLayout\n        };\n      }\n\n    case REMOVE_UI_LAYOUT_DIMENSIONS:\n      {\n        return { ...state,\n          layout: getFilteredLayout(state.layout, action.value)\n        };\n      }\n\n    case SET_UI_FROM_VISUALIZATION:\n      {\n        return getAdaptedUiByType(getUiFromVisualization(action.value, state));\n      }\n\n    case SET_UI_LAYOUT:\n      {\n        return { ...state,\n          layout: { ...action.value\n          }\n        };\n      }\n\n    case SET_UI_DETAILS_PANEL_OPEN:\n      {\n        return { ...state,\n          showDetailsPanel: action.value,\n\n          /*\n           * Always close left sidebar when opening the right sidebar\n           * Leave left sidebar unaffected when closing the right sidebar\n           */\n          showAccessoryPanel: action.value ? false : state.showAccessoryPanel\n        };\n      }\n\n    case SET_UI_ACCESSORY_PANEL_OPEN:\n      {\n        return { ...state,\n          showAccessoryPanel: action.value,\n\n          /*\n           * Always close right sidebar when opening the left sidebar\n           * Leave right sidebar unaffected when closing the left sidebar\n           */\n          showDetailsPanel: action.value ? false : state.showDetailsPanel\n        };\n      }\n\n    case SET_UI_EXPANDED_LAYOUT_PANEL:\n      {\n        return { ...state,\n          showExpandedLayoutPanel: action.value\n        };\n      }\n\n    case CLEAR_UI:\n      {\n        return getPreselectedUi(action.value);\n      }\n\n    case SET_UI_ACTIVE_MODAL_DIALOG:\n      {\n        return { ...state,\n          activeModalDialog: action.value || DEFAULT_UI.activeModalDialog\n        };\n      }\n\n    case SET_UI_ITEMS:\n      {\n        const {\n          dimensionId,\n          itemIds\n        } = action.value;\n        return { ...state,\n          itemsByDimension: { ...state.itemsByDimension,\n            [dimensionId]: itemIds\n          }\n        };\n      }\n\n    case REMOVE_UI_ITEMS:\n      {\n        const idsToRemove = new Set(action.value);\n        return { ...state,\n          itemsByDimension: Object.entries(state.itemsByDimension).reduce((acc, _ref2) => {\n            let [id, items] = _ref2;\n\n            if (!idsToRemove.has(id)) {\n              acc[id] = items;\n            }\n\n            return acc;\n          }, {})\n        };\n      }\n\n    case ADD_UI_PARENT_GRAPH_MAP:\n      {\n        return { ...state,\n          parentGraphMap: { ...state.parentGraphMap,\n            ...action.value\n          }\n        };\n      }\n\n    case SET_UI_CONDITIONS:\n      {\n        const {\n          dimension,\n          inputCondition,\n          legendSet\n        } = action.value;\n        return { ...state,\n          conditions: { ...state.conditions,\n            [dimension]: inputCondition.length || legendSet ? {\n              condition: inputCondition,\n              legendSet\n            } : undefined\n          }\n        };\n      }\n\n    case SET_UI_REPETITION:\n      {\n        const {\n          dimensionId,\n          repetition\n        } = action.value;\n        return { ...state,\n          repetitionByDimension: { ...state.repetitionByDimension,\n            [dimensionId]: repetition\n          }\n        };\n      }\n\n    case REMOVE_UI_REPETITION:\n      {\n        const {\n          [action.value]: removedProperty,\n          ...repetitionByDimension\n        } = { ...state.repetitionByDimension\n        };\n        return { ...state,\n          repetitionByDimension\n        };\n      }\n\n    default:\n      return state;\n  }\n}); // Selectors\n\nexport const sGetUi = state => state.ui;\nexport const sGetUiDraggingId = state => sGetUi(state).draggingId;\nexport const sGetUiInput = state => sGetUi(state).input;\nexport const sGetUiProgram = state => sGetUi(state).program;\nexport const sGetUiOptions = state => sGetUi(state).options;\nexport const sGetUiOption = () => {}; // TODO: items stored here should be flattened and reintegrated into sGetUiOptions (above)\n\nexport const sGetUiItems = state => sGetUi(state).itemsByDimension;\nexport const sGetUiLayout = state => sGetUi(state).layout;\nexport const sGetUiShowDetailsPanel = state => sGetUi(state).showDetailsPanel;\nexport const sGetUiShowAccessoryPanel = state => sGetUi(state).showAccessoryPanel;\nexport const sGetUiShowExpandedLayoutPanel = state => sGetUi(state).showExpandedLayoutPanel;\nexport const sGetUiType = state => sGetUi(state).type;\nexport const sGetUiActiveModalDialog = state => sGetUi(state).activeModalDialog;\nexport const sGetUiParentGraphMap = state => sGetUi(state).parentGraphMap;\nexport const sGetUiConditions = state => sGetUi(state).conditions || {};\nexport const sGetUiRepetition = state => sGetUi(state).repetitionByDimension || {}; // Selectors level 2\n\nexport const sGetUiInputType = state => sGetUiInput(state).type;\nexport const sGetUiProgramId = state => sGetUiProgram(state).id;\nexport const sGetUiProgramStageId = state => sGetUiProgram(state).stageId;\nexport const sGetUiItemsByDimension = (state, dimension) => sGetUiItems(state)[dimension] || DEFAULT_UI.itemsByDimension[dimension];\nexport const sGetDimensionIdsFromLayout = state => Object.values(sGetUiLayout(state)).reduce((ids, axisDimensionIds) => ids.concat(axisDimensionIds), []);\nexport const sGetUiDimensionIdsByAxisId = (state, axisId) => sGetUiLayout(state)[axisId];\nexport const sGetUiConditionsByDimension = (state, dimension) => sGetUiConditions(state)[dimension];\nexport const sGetUiRepetitionByDimension = (state, dimensionId) => sGetUiRepetition(state)[dimensionId];\nexport const renderChipsSelector = createSelector( // only render chips when all have names (from metadata) available\n[sGetUiLayout, sGetMetadata], (layout, metadata) => {\n  const layoutItems = Object.values(layout || {}).flat();\n  const dataObjects = [...Object.values(metadata || {})]; // TODO: Refactor to not use the whole metadata list\n\n  return layoutItems.every(item => dataObjects.some(data => data.id === item));\n}); // Selector based hooks\n\nexport const useMainDimensions = () => {\n  const store = useStore();\n  const programId = useSelector(sGetUiProgramId);\n  const inputType = useSelector(sGetUiInputType);\n  return useMemo(() => {\n    const {\n      metadata\n    } = store.getState();\n    const programType = programId && metadata[programId].programType;\n    return Object.values(getMainDimensions()).map(dimension => {\n      const disabledReason = getIsMainDimensionDisabled({\n        dimensionId: dimension.id,\n        inputType,\n        programType\n      });\n      return { ...dimension,\n        disabled: Boolean(disabledReason),\n        disabledReason\n      };\n    });\n  }, [programId, inputType]);\n};\nexport const useTimeDimensions = () => {\n  const store = useStore();\n  const inputType = useSelector(sGetUiInputType);\n  const programId = useSelector(sGetUiProgramId);\n  const programStageId = useSelector(sGetUiProgramStageId);\n  const eventDateDim = useSelector(state => sGetMetadataById(state, DIMENSION_ID_EVENT_DATE));\n  const enrollmentDateDim = useSelector(state => sGetMetadataById(state, DIMENSION_ID_ENROLLMENT_DATE));\n  const incidentDateDim = useSelector(state => sGetMetadataById(state, DIMENSION_ID_INCIDENT_DATE)); // const scheduledDateDim = useSelector((state) =>\n  //     sGetMetadataById(state, DIMENSION_ID_SCHEDULED_DATE)\n  // )\n\n  const lastUpdatedDim = useSelector(state => sGetMetadataById(state, DIMENSION_ID_LAST_UPDATED));\n  return useMemo(() => {\n    const {\n      metadata\n    } = store.getState();\n    const program = metadata[programId];\n    const stage = metadata[programStageId];\n    const timeDimensions = [eventDateDim, enrollmentDateDim, incidentDateDim, // scheduledDateDim,\n    lastUpdatedDim];\n\n    if (timeDimensions.every(dimension => !!dimension)) {\n      const disabledTimeDimensions = getDisabledTimeDimensions(inputType, program, stage);\n      return timeDimensions.map(dimension => ({ ...dimension,\n        disabled: Boolean(disabledTimeDimensions[dimension.id]),\n        disabledReason: disabledTimeDimensions[dimension.id]\n      }));\n    } else {\n      return null;\n    }\n  }, [inputType, programId, programStageId, eventDateDim, enrollmentDateDim, incidentDateDim, // scheduledDateDim,\n  lastUpdatedDim]);\n};","import { SET_CURRENT, CLEAR_CURRENT, SET_CURRENT_FROM_UI } from '../reducers/current.js';\nimport { sGetUi } from '../reducers/ui.js';\n\nconst acSetCurrent = value => ({\n  type: SET_CURRENT,\n  value\n});\n\nexport const tSetCurrent = visualization => dispatch => {\n  dispatch(acSetCurrent(visualization));\n};\nexport const acClearCurrent = () => ({\n  type: CLEAR_CURRENT\n});\nexport const acSetCurrentFromUi = value => ({\n  type: SET_CURRENT_FROM_UI,\n  value\n});\nexport const tSetCurrentFromUi = () => async (dispatch, getState) => {\n  const ui = sGetUi(getState());\n  dispatch(acSetCurrentFromUi(ui));\n};","export const SET_LOAD_ERROR = 'SET_LOAD_ERROR';\nexport const CLEAR_LOAD_ERROR = 'CLEAR_LOAD_ERROR';\nexport const SET_VISUALIZATION_LOADING = 'SET_VISUALIZATION_LOADING';\nexport const DEFAULT_LOADING = {\n  loadingError: null,\n  isVisualizationLoading: true\n};\nexport default (function () {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : DEFAULT_LOADING;\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    case SET_LOAD_ERROR:\n      {\n        return { ...state,\n          loadingError: action.value\n        };\n      }\n\n    case CLEAR_LOAD_ERROR:\n      return { ...state,\n        loadingError: DEFAULT_LOADING.loadingError\n      };\n\n    case SET_VISUALIZATION_LOADING:\n      return { ...state,\n        isVisualizationLoading: action.value\n      };\n\n    default:\n      return state;\n  }\n}); // Selectors\n\nexport const sGetLoadError = state => state.loader.loadingError;\nexport const sGetIsVisualizationLoading = state => state.loader.isVisualizationLoading;","import { USER_ORG_UNIT, USER_ORG_UNIT_CHILDREN, USER_ORG_UNIT_GRANDCHILDREN, DIMENSION_ID_ORGUNIT, getDimensionById, DIMENSION_TYPE_ORGANISATION_UNIT } from '@dhis2/analytics';\nimport i18n from '@dhis2/d2-i18n';\nimport { getMainDimensions } from './mainDimensions.js';\nimport { getTimeDimensions, getTimeDimensionName } from './timeDimensions.js';\nimport { statusNames } from './visualization.js';\n\nconst formatObject = object => Object.entries(object).reduce((obj, _ref) => {\n  let [key, value] = _ref;\n  return { ...obj,\n    [key]: {\n      name: value\n    }\n  };\n}, {});\n\nconst getOrganisationUnits = () => ({\n  [USER_ORG_UNIT]: i18n.t('User organisation unit'),\n  [USER_ORG_UNIT_CHILDREN]: i18n.t('User sub-units'),\n  [USER_ORG_UNIT_GRANDCHILDREN]: i18n.t('User sub-x2-units')\n});\n\nconst getFixedDimensions = () => ({\n  [DIMENSION_ID_ORGUNIT]: { ...getDimensionById(DIMENSION_ID_ORGUNIT),\n    dimensionType: DIMENSION_TYPE_ORGANISATION_UNIT\n  }\n});\n\nexport const getDefaultMetadata = () => ({ ...getMainDimensions(),\n  ...getDefaultTimeDimensionsMetadata(),\n  ...getFixedDimensions(),\n  ...formatObject(getOrganisationUnits()),\n  ...formatObject(statusNames)\n});\nexport const getDefaultTimeDimensionsMetadata = () => {\n  return Object.values(getTimeDimensions()).reduce((acc, _ref2) => {\n    let {\n      id,\n      name,\n      dimensionType\n    } = _ref2;\n    acc[id] = {\n      id,\n      name,\n      dimensionType\n    };\n    return acc;\n  }, {});\n};\nexport const getProgramAsMetadata = program => ({ ...program.programStages.reduce((acc, stage) => {\n    acc[stage.id] = stage;\n    return acc;\n  }, {}),\n  [program.id]: program\n});\nexport const getDynamicTimeDimensionsMetadata = (program, stage) => ({ ...Object.values(getTimeDimensions()).reduce((acc, dimension) => {\n    acc[dimension.id] = {\n      id: dimension.id,\n      dimensionType: dimension.dimensionType,\n      name: getTimeDimensionName(dimension, program, stage)\n    };\n    return acc;\n  }, {})\n});","import { getDefaultMetadata } from '../modules/metadata.js';\nimport { ADD_METADATA, CLEAR_METADATA } from '../reducers/metadata.js';\nexport const acAddMetadata = value => ({\n  type: ADD_METADATA,\n  value\n});\n\nconst acClearMetadata = () => ({\n  type: CLEAR_METADATA\n});\n\nexport const tSetInitMetadata = function () {\n  let rootOrgUnits = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  return dispatch => {\n    const metaData = { ...getDefaultMetadata()\n    };\n    rootOrgUnits.forEach(rootOrgUnit => {\n      if (rootOrgUnit.id) {\n        metaData[rootOrgUnit.id] = { ...rootOrgUnit,\n          path: \"/\".concat(rootOrgUnit.id)\n        };\n      }\n    });\n    dispatch(acClearMetadata());\n    dispatch(acAddMetadata(metaData));\n  };\n};","import { DIMENSION_TYPES_PROGRAM, DIMENSION_IDS_TIME, DIMENSION_ID_EVENT_STATUS, DIMENSION_ID_PROGRAM_STATUS } from '../modules/dimensionConstants.js';\nimport { getIsMainDimensionDisabled } from '../modules/mainDimensions.js';\nimport { getDefaultTimeDimensionsMetadata, getDynamicTimeDimensionsMetadata, getProgramAsMetadata } from '../modules/metadata.js';\nimport { PROGRAM_TYPE_WITH_REGISTRATION } from '../modules/programTypes.js';\nimport { getDisabledTimeDimensions } from '../modules/timeDimensions.js';\nimport { OUTPUT_TYPE_EVENT } from '../modules/visualization.js';\nimport { sGetMetadataById } from '../reducers/metadata.js';\nimport { ADD_UI_LAYOUT_DIMENSIONS, REMOVE_UI_LAYOUT_DIMENSIONS, SET_UI_DRAGGING_ID, SET_UI_LAYOUT, SET_UI_OPTION, SET_UI_OPTIONS, SET_UI_FROM_VISUALIZATION, CLEAR_UI, SET_UI_DETAILS_PANEL_OPEN, SET_UI_ACCESSORY_PANEL_OPEN, SET_UI_EXPANDED_LAYOUT_PANEL, SET_UI_ACTIVE_MODAL_DIALOG, SET_UI_ITEMS, ADD_UI_PARENT_GRAPH_MAP, SET_UI_CONDITIONS, SET_UI_REPETITION, REMOVE_UI_REPETITION, SET_UI_INPUT, UPDATE_UI_PROGRAM_ID, UPDATE_UI_PROGRAM_STAGE_ID, CLEAR_UI_PROGRAM, CLEAR_UI_STAGE_ID, REMOVE_UI_ITEMS, sGetUiProgramId, sGetUiInputType } from '../reducers/ui.js';\nexport const acSetUiDraggingId = value => ({\n  type: SET_UI_DRAGGING_ID,\n  value\n});\nexport const acSetUiInput = (value, metadata) => ({\n  type: SET_UI_INPUT,\n  value,\n  metadata\n});\nexport const acClearUiProgram = () => ({\n  type: CLEAR_UI_PROGRAM,\n  metadata: getDefaultTimeDimensionsMetadata()\n});\nexport const acClearUiStageId = metadata => ({\n  type: CLEAR_UI_STAGE_ID,\n  metadata\n});\nexport const acUpdateUiProgramId = (value, metadata) => ({\n  type: UPDATE_UI_PROGRAM_ID,\n  value,\n  metadata\n});\nexport const acUpdateUiProgramStageId = (value, metadata) => ({\n  type: UPDATE_UI_PROGRAM_STAGE_ID,\n  value,\n  metadata\n});\n\nconst tClearUiProgramRelatedDimensions = (inputType, program) => (dispatch, getState) => {\n  const {\n    ui,\n    metadata\n  } = getState();\n  const disabledTimeDimensionIds = new Set(Object.keys(getDisabledTimeDimensions(inputType, program)));\n  const idsToRemove = ui.layout.columns.concat(ui.layout.filters).filter(dimensionId => {\n    const dimension = metadata[dimensionId];\n    const isProgramDimension = DIMENSION_TYPES_PROGRAM.has(dimension.dimensionType);\n    const isDisabledMainDimension = (dimensionId === DIMENSION_ID_PROGRAM_STATUS || dimensionId === DIMENSION_ID_EVENT_STATUS) && getIsMainDimensionDisabled({\n      dimensionId,\n      inputType,\n      programType: program === null || program === void 0 ? void 0 : program.programType\n    });\n    const isDisabledTimeDimension = DIMENSION_IDS_TIME.has(dimension.id) && disabledTimeDimensionIds.has(dimension.id);\n    return isProgramDimension || isDisabledMainDimension || isDisabledTimeDimension;\n  });\n  dispatch(acRemoveUiLayoutDimensions(idsToRemove), idsToRemove);\n  dispatch(acRemoveUiItems(idsToRemove));\n};\n\nexport const tClearUiProgramStageDimensions = stageId => (dispatch, getState) => {\n  const state = getState();\n  const program = sGetMetadataById(state, sGetUiProgramId(state));\n  const needsClearing = sGetUiInputType(state) === OUTPUT_TYPE_EVENT && program.programType === PROGRAM_TYPE_WITH_REGISTRATION;\n\n  if (needsClearing) {\n    const idsToRemove = state.ui.layout.columns.concat(state.ui.layout.filters).filter(id => id.includes(\"\".concat(stageId, \".\")));\n    dispatch(acRemoveUiLayoutDimensions(idsToRemove));\n    dispatch(acRemoveUiItems(idsToRemove));\n  }\n};\nexport const tSetUiInput = value => dispatch => {\n  dispatch(acClearUiProgram());\n  dispatch(tClearUiProgramRelatedDimensions(value.type));\n  dispatch(acSetUiInput(value, getDefaultTimeDimensionsMetadata()));\n};\nexport const tSetUiProgram = _ref => {\n  let {\n    program,\n    stage\n  } = _ref;\n  return (dispatch, getState) => {\n    const inputType = sGetUiInputType(getState());\n    dispatch(acClearUiProgram());\n    dispatch(tClearUiProgramRelatedDimensions(inputType, program));\n    program && dispatch(acUpdateUiProgramId(program.id, { ...getProgramAsMetadata(program),\n      ...getDynamicTimeDimensionsMetadata(program, stage)\n    }));\n    stage && dispatch(acUpdateUiProgramStageId(stage.id));\n  };\n};\nexport const tClearUiStage = () => (dispatch, getState) => {\n  const state = getState();\n  const program = sGetMetadataById(state, sGetUiProgramId(state));\n  dispatch(acClearUiStageId(getDynamicTimeDimensionsMetadata(program)));\n};\nexport const tSetUiStage = stage => (dispatch, getState) => {\n  const state = getState();\n  const program = sGetMetadataById(state, sGetUiProgramId(state));\n  dispatch(acUpdateUiProgramStageId(stage.id, getDynamicTimeDimensionsMetadata(program, stage)));\n};\nexport const acSetUiOptions = value => ({\n  type: SET_UI_OPTIONS,\n  value\n});\nexport const acSetUiOption = value => ({\n  type: SET_UI_OPTION,\n  value\n});\nexport const acAddUiLayoutDimensions = (value, metadata) => ({\n  type: ADD_UI_LAYOUT_DIMENSIONS,\n  value,\n  metadata\n});\nexport const acRemoveUiLayoutDimensions = value => ({\n  type: REMOVE_UI_LAYOUT_DIMENSIONS,\n  value\n});\nexport const acRemoveUiItems = value => ({\n  type: REMOVE_UI_ITEMS,\n  value\n});\nexport const acSetUiLayout = value => ({\n  type: SET_UI_LAYOUT,\n  value\n});\nexport const acSetUiFromVisualization = (value, metadata) => ({\n  type: SET_UI_FROM_VISUALIZATION,\n  value,\n  metadata\n});\nexport const acClearUi = value => ({\n  type: CLEAR_UI,\n  value\n});\nexport const acSetUiDetailsPanelOpen = value => ({\n  type: SET_UI_DETAILS_PANEL_OPEN,\n  value\n});\nexport const acSetUiAccessoryPanelOpen = value => ({\n  type: SET_UI_ACCESSORY_PANEL_OPEN,\n  value\n});\nexport const acSetShowExpandedLayoutPanel = value => ({\n  type: SET_UI_EXPANDED_LAYOUT_PANEL,\n  value\n});\nexport const acSetUiOpenDimensionModal = (value, metadata) => ({\n  type: SET_UI_ACTIVE_MODAL_DIALOG,\n  value,\n  metadata\n});\nexport const acSetUiItems = (value, metadata) => ({\n  type: SET_UI_ITEMS,\n  value,\n  metadata\n});\nexport const acAddParentGraphMap = value => ({\n  type: ADD_UI_PARENT_GRAPH_MAP,\n  value\n});\nexport const acSetUiConditions = value => ({\n  type: SET_UI_CONDITIONS,\n  value\n});\nexport const acSetUiRepetition = value => ({\n  type: SET_UI_REPETITION,\n  value\n});\nexport const acRemoveUiRepetition = value => ({\n  type: REMOVE_UI_REPETITION,\n  value\n});","import { getUiDimensionType } from '../modules/dimensionConstants.js';\nimport { formatDimensionId } from '../modules/utils.js';\nimport { SET_VISUALIZATION, CLEAR_VISUALIZATION } from '../reducers/visualization.js';\nexport const acSetVisualization = value => {\n  const metadata = [...(value.columns || []), ...(value.rows || []), ...(value.filters || [])].filter(dim => {\n    var _dim$optionSet;\n\n    return dim.valueType || ((_dim$optionSet = dim.optionSet) === null || _dim$optionSet === void 0 ? void 0 : _dim$optionSet.id) || dim.dimensionType;\n  }).map(dim => {\n    var _dim$programStage, _dim$optionSet2;\n\n    const id = formatDimensionId(dim.dimension, (_dim$programStage = dim.programStage) === null || _dim$programStage === void 0 ? void 0 : _dim$programStage.id);\n    return {\n      [id]: {\n        valueType: dim.valueType,\n        optionSet: (_dim$optionSet2 = dim.optionSet) === null || _dim$optionSet2 === void 0 ? void 0 : _dim$optionSet2.id,\n        dimensionType: getUiDimensionType({\n          dimensionId: id,\n          dimensionType: dim.dimensionType\n        }),\n        id\n      }\n    };\n  });\n  return {\n    type: SET_VISUALIZATION,\n    value,\n    metadata\n  };\n};\nexport const acClearVisualization = () => ({\n  type: CLEAR_VISUALIZATION\n});","import { SET_LOAD_ERROR, CLEAR_LOAD_ERROR, SET_VISUALIZATION_LOADING } from '../reducers/loader.js';\nimport { acClearCurrent } from './current.js';\nimport { tSetInitMetadata } from './metadata.js';\nimport { acClearUi } from './ui.js';\nimport { acClearVisualization } from './visualization.js';\nexport const acSetLoadError = value => ({\n  type: SET_LOAD_ERROR,\n  value\n});\nexport const acClearLoadError = () => ({\n  type: CLEAR_LOAD_ERROR\n});\nexport const acSetVisualizationLoading = value => ({\n  type: SET_VISUALIZATION_LOADING,\n  value\n});\nexport const acClearAll = _ref => {\n  let {\n    error = null,\n    digitGroupSeparator,\n    rootOrgUnits\n  } = _ref;\n  return dispatch => {\n    if (error) {\n      dispatch(acSetLoadError(error));\n    } else {\n      dispatch(acClearLoadError());\n    }\n\n    dispatch(tSetInitMetadata(rootOrgUnits));\n    dispatch(acClearVisualization());\n    dispatch(acClearCurrent());\n    dispatch(acClearUi({\n      rootOrgUnits,\n      digitGroupSeparator\n    }));\n  };\n};","export const EVENT_TYPE = 'EVENT_VISUALIZATION_VIEW';","import React from 'react';\nexport const GenericError = () => /*#__PURE__*/React.createElement(\"svg\", {\n  height: \"96\",\n  viewBox: \"0 0 96 96\",\n  width: \"96\",\n  xmlns: \"http://www.w3.org/2000/svg\"\n}, /*#__PURE__*/React.createElement(\"g\", {\n  fill: \"#a0adba\",\n  transform: \"translate(3 3)\"\n}, /*#__PURE__*/React.createElement(\"path\", {\n  d: \"m40.5 73.5000001c0 2.4852813 2.0147186 4.5 4.5 4.5s4.5-2.0147187 4.5-4.5c0-2.4142734-1.9012365-4.3844892-4.2881643-4.4951021l-.2128322-.0048979c-2.4848234.0005384-4.4990035 2.0150507-4.4990035 4.5z\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"m48 60v-30c0-1.6568542-1.3431458-3-3-3s-3 1.3431458-3 3v30c0 1.6568542 1.3431458 3 3 3s3-1.3431458 3-3z\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"m45-2.99904788c3.8985931 0 7.4578604 2.21715778 9.1770339 5.71709169l37.8912554 77.19048409c1.3845546 2.8165473 1.2171646 6.1482722-.4427191 8.811863-1.6598833 2.6635901-4.5771005 4.2816904-7.7135702 4.2796124h-77.82201115c-3.13845856.002078-6.05567574-1.6160223-7.71555901-4.2796124-1.65988369-2.6635908-1.82727377-5.9953157-.44346379-8.8103471l37.89234295-77.19269833c1.7188306-3.49923557 5.2780979-5.71639335 9.176691-5.71639335zm0 6c-1.6106864 0-3.0811818.91600885-3.7909661 2.36100407l-37.89274459 77.19351591c-.47005356.9562122-.41322496 2.0873262.15030227 2.99161.56352731.9042839 1.5539177 1.4529206 2.62140842 1.4529206h77.8259889c1.0655018 0 2.0558922-.5486367 2.6194195-1.4529206.5635272-.9042838.6203558-2.0353978.1495577-2.9931259l-37.8916571-77.19130167c-.7101272-1.44569356-2.1806226-2.36170241-3.791309-2.36170241z\"\n})));\nexport const EmptyBox = () => /*#__PURE__*/React.createElement(\"svg\", {\n  width: \"100\",\n  height: \"100\",\n  xmlns: \"http://www.w3.org/2000/svg\"\n}, /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M96.4184693 4.6480742l-2.9759268 2.6728C91.5558812 5.2202435 88.8786031 4 86 4V0c4.0260387 0 7.7809122 1.7113874 10.4184693 4.6480742zM100 19.269042h-4l-.0000544-5.3024514c-.0043849-1.346405-.2739964-2.6517927-.7866406-3.8623659l3.6833463-1.559795c.7189815 1.6978243 1.0971493 3.5288134 1.1032837 5.4156229L100 19.269042zm0 13.9999755h-4v-10h4v10zm0 14h-4v-10h4v10zm0 14h-4v-10h4v10zm0 13.9999995h-4v-9.9999995h4v9.9999995zm-.516108 14.50858l-3.8521996-1.077292C95.8751624 87.829701 96 86.924153 96 86v-6.730983h4V86c0 1.289184-.1747984 2.557136-.516108 3.777597zM87.7213345 99.895024l-.4874961-3.970182c2.8302961-.34753 5.3578432-1.892491 6.9762006-4.213767l3.2812621 2.287645c-2.2629208 3.245799-5.802045 5.409086-9.7699666 5.896304zM73.461965 100v-4h10v4h-10zm-14 0v-4h10v4h-10zm-14 0v-4h10v4h-10zm-14 0v-4h10v4h-10zm-14 0v-4h10v4h-10zM3.17264828 94.875717l3.09219912-2.537382c1.79303608 2.185097 4.4211055 3.525451 7.2855127 3.651773l-.176231 3.996116c-4.01094422-.176885-7.69477669-2.055693-10.20148082-5.110507zM0 80.192922h4l.00006331 5.84312c.00418159 1.190127.21554574 2.348454.61951638 3.438567L.86883696 90.864547C.3022517 89.335619.0059261 87.711683.00007566 86.043095L0 80.192922zm0-13.999974h4v10H0v-10zm0-14.0000005h4v10H0v-10zm0-14h4v10H0v-10zm0-14h4v10H0v-10zM.701349 9.6140131l3.79891292 1.2523021C4.17021443 11.8675286 4 12.9209553 4 14v6.1929475H0V14c0-1.5058511.2385093-2.9819426.701349-4.3859869zM12.9113947.0417954l.3073341 3.9881757c-2.8514503.2197365-5.43930476 1.6474003-7.16021518 3.8917822l-3.1742768-2.4339201C5.29022999 2.3499781 8.91606935.3496804 12.9113947.0417954zM27.07607 0v4h-10V0h10zm14 0v4h-10V0h10zm14 0v4h-10V0h10zm14 0v4h-10V0h10zm14 0v4h-10V0h10z\",\n  fill: \"#A0ADBA\",\n  fillRule: \"nonzero\"\n}));\nexport const PeriodError = () => /*#__PURE__*/React.createElement(\"svg\", {\n  width: \"100\",\n  height: \"100\",\n  xmlns: \"http://www.w3.org/2000/svg\"\n}, /*#__PURE__*/React.createElement(\"g\", {\n  fill: \"#A0ADBA\",\n  fillRule: \"nonzero\"\n}, /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M72.9999996 82.4999997l.1996404.0048953c2.1163912.1040258 3.8003596 1.8529093 3.8003596 3.9951047 0 2.209139-1.790861 4-4 4s-4-1.790861-4-4c0-2.1421954 1.6839685-3.8910789 3.8003597-3.9951047l.1996403-.0048953zM72.9999996 60.9999997c1.5976809 0 2.9036609 1.2489199 2.9949073 2.8237272l.0050927.1762728v12c0 1.6568542-1.3431457 3-3 3-1.5976809 0-2.9036609-1.24892-2.9949073-2.8237272l-.0050927-.1762728v-12c0-1.6568543 1.3431458-3 3-3z\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M72.9999996 45.999137c-3.825395 0-7.3222315 2.1620358-9.0317655 5.5841902l-16.903516 33.8070317c-1.5642876 3.1303349-1.39639 6.8466948.4434382 9.8226487 1.8397692 2.9758587 5.0891084 4.7869921 8.5878433 4.7869921h33.808c3.498735 0 6.7480741-1.8111334 8.5878434-4.7869921 1.8398282-2.9759539 2.0077257-6.6923138.4437399-9.8220451L82.0312812 51.5823589c-1.70905-3.4211861-5.2058865-5.5832219-9.0312816-5.5832219zm0 6c1.5519828 0 2.9706677.8771492 3.6642345 2.2655352l16.904484 33.8089683c.6342155 1.2691447.5660986 2.7768914-.1803294 3.9842515-.7463845 1.20729-2.0647148 1.9421077-3.4843891 1.9421077h-33.808c-1.4196743 0-2.7380045-.7348177-3.4843891-1.9421077-.7464279-1.2073601-.8145448-2.7151068-.1800276-3.9848551l16.9036983-33.8073964c.6940508-1.3893543 2.1127357-2.2665035 3.6647184-2.2665035z\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M49.9999996-3.4e-7c27.6142375 0 50 22.38576254 50 50.00000004 0 3.4254464-.3449043 6.8082851-1.0236569 10.111998-.3334386 1.6229556-1.9194094 2.6683156-3.542365 2.334877-1.6229555-.3334386-2.6683156-1.9194094-2.334877-3.5423649.5972413-2.9069705.9008989-5.8852591.9008989-8.9045101 0-24.300529-19.699471-44.00000004-44-44.00000004S5.99999963 25.6994707 5.99999963 49.9999997c0 20.0457004 13.52123857 37.4107541 32.60787227 42.5117075 1.6006767.4277851 2.5514932 2.0721783 2.1237081 3.672855-.4277851 1.6006767-2.0721782 2.5514932-3.672855 2.1237082C15.3630605 92.5100466-3.7e-7 72.7795776-3.7e-7 49.9999997-3.7e-7 22.3857622 22.3857621-3.4e-7 49.9999996-3.4e-7z\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M31.9999996 52.4999997c-1.3807118 0-2.5-1.1192882-2.5-2.5 0-1.3254834 1.031536-2.4100387 2.3356243-2.4946824l.1643757-.0053176 15.4995614-.0008627.0004386-24.4991373c0-1.3807119 1.1192882-2.5 2.5-2.5 1.3254834 0 2.4100387 1.0315359 2.4946823 2.3356243l.0053177.1643757v27c0 1.3254834-1.0315359 2.4100386-2.3356243 2.4946823l-.1643757.0053177h-18z\"\n})));\nexport const DataError = () => /*#__PURE__*/React.createElement(\"svg\", {\n  width: \"98\",\n  height: \"97\",\n  xmlns: \"http://www.w3.org/2000/svg\"\n}, /*#__PURE__*/React.createElement(\"g\", {\n  fill: \"#A0ADBA\",\n  fillRule: \"nonzero\"\n}, /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M47.9999996-3.4e-7c26.375131 0 48 8.64933258 48 21.00093054 0 6.7822228-6.3726775 12.3999932-16.8111022 16.1776421-1.5579685.5638263-3.2780231-.2420853-3.8418493-1.8000538-.5638263-1.5579685.2420852-3.2780231 1.8000537-3.8418493 8.3196582-3.0108708 12.8528978-7.007103 12.8528978-10.535739 0-7.5352197-18.6656043-15.00093054-42-15.00093054-23.3343956 0-41.99999997 7.46571084-41.99999997 15.00093054 0 8.3458435 22.23414277 16.1998284 47.97788217 14.8410919 1.6545514-.087326 3.066622 1.1831611 3.1539481 2.8377124.087326 1.6545514-1.1831611 3.066622-2.8377125 3.1539481C25.4193432 43.3576729-3.7e-7 34.3785482-3.7e-7 21.0009302-3.7e-7 8.64933224 21.6248687-3.4e-7 47.9999996-3.4e-7z\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M92.9999996 17.9999997c1.5976809 0 2.9036609 1.2489199 2.9949073 2.8237272l.0050927.1762728v24c0 1.6568542-1.3431457 3-3 3-1.5976809 0-2.9036609-1.24892-2.9949073-2.8237272l-.0050927-.1762728v-24c0-1.6568543 1.3431458-3 3-3zM2.99999963 17.9999997c1.59768088 0 2.90366088 1.2489199 2.9949073 2.8237272l.0050927.1762728v24.0917782c0 6.7884007 15.40674827 13.7997289 36.16062537 14.9125249 1.6544777.088711 2.9237824 1.5018446 2.8350715 3.1563223-.088711 1.6544776-1.5018446 2.9237823-3.1563223 2.8350714C18.3983599 64.7388196.36378289 56.6257218.00543546 45.431923L-3.7e-7 45.0917779V20.9999997c0-1.6568543 1.34314575-3 3-3z\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M2.99999963 41.9999997c1.59768088 0 2.90366088 1.2489199 2.9949073 2.8237272l.0050927.1762728v24.011713c0 5.6006467 10.94212037 11.6895243 27.41972777 14.017794 1.6405579.2318092 2.7825744 1.7496627 2.5507652 3.3902207-.2318092 1.640558-1.7496627 2.7825745-3.3902207 2.5507653l-1.1438963-.168296C13.057544 85.989973.26320686 78.7580311.00401161 69.3047869L-3.7e-7 69.0117127v-24.011713c0-1.6568543 1.34314575-3 3-3zM70.9999996 79.4999997l.1996404.0048953c2.1163912.1040258 3.8003596 1.8529093 3.8003596 3.9951047 0 2.209139-1.790861 4-4 4s-4-1.790861-4-4c0-2.1421954 1.6839685-3.8910789 3.8003597-3.9951047l.1996403-.0048953zM70.9999996 57.9999997c1.5976809 0 2.9036609 1.2489199 2.9949073 2.8237272l.0050927.1762728v12c0 1.6568542-1.3431457 3-3 3-1.5976809 0-2.9036609-1.24892-2.9949073-2.8237272l-.0050927-.1762728v-12c0-1.6568543 1.3431458-3 3-3z\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M70.9999996 42.999137c-3.825395 0-7.3222315 2.1620358-9.0317655 5.5841902l-16.903516 33.8070317c-1.5642876 3.1303349-1.39639 6.8466948.4434382 9.8226487 1.8397692 2.9758587 5.0891084 4.7869921 8.5878433 4.7869921h33.808c3.498735 0 6.7480741-1.8111334 8.5878434-4.7869921 1.8398282-2.9759539 2.0077257-6.6923138.4437399-9.8220451L80.0312812 48.5823589c-1.70905-3.4211861-5.2058865-5.5832219-9.0312816-5.5832219zm0 6c1.5519828 0 2.9706677.8771492 3.6642345 2.2655352l16.904484 33.8089683c.6342155 1.2691447.5660986 2.7768914-.1803294 3.9842515-.7463845 1.20729-2.0647148 1.9421077-3.4843891 1.9421077h-33.808c-1.4196743 0-2.7380045-.7348177-3.4843891-1.9421077-.7464279-1.2073601-.8145448-2.7151068-.1800276-3.9848551l16.9036983-33.8073964c.6940508-1.3893543 2.1127357-2.2665035 3.6647184-2.2665035z\"\n})));","import i18n from '@dhis2/d2-i18n';\nimport { DataError, EmptyBox, GenericError, PeriodError } from '../assets/ErrorIcons.js';\n\nconst visualizationError = (icon, title, description) => ({\n  icon,\n  title,\n  description\n});\n\nexport const genericClientError = () => visualizationError(GenericError, genericErrorTitle, i18n.t('There is a problem with this visualization.'));\nexport const genericServerError = () => visualizationError(GenericError, genericErrorTitle, i18n.t('There was a problem getting the data from the server.'));\nexport const emptyResponseError = () => visualizationError(EmptyBox, i18n.t('No data available'), i18n.t('The selected dimensions didn’t return any data. There may be no data, or you may not have access to it.'));\nexport const visualizationNotFoundError = () => visualizationError(GenericError, i18n.t('Visualization not found'), i18n.t('The visualization you are trying to view could not be found, the ID could be incorrect or it could have been deleted.'));\nexport const noProgramError = () => visualizationError(EmptyBox, i18n.t('No program selected'), i18n.t('Choose a program from the Program Dimensions sidebar.'));\nexport const noColumnsError = () => visualizationError(EmptyBox, i18n.t('Columns is empty'), i18n.t('Add at least one item to Columns.'));\nexport const noOrgUnitError = () => visualizationError(DataError, i18n.t('No organisation unit selected'), i18n.t('Add at least one organisation unit to the layout.'));\nexport const noPeriodError = () => visualizationError(PeriodError, i18n.t('No time dimension selected'), i18n.t('Add at least one time dimension to the layout.'));\nexport const indicatorError = () => visualizationError(DataError, genericErrorTitle, i18n.t(\"There's a problem with at least one selected indicator\"));\nexport const dataAccessError = () => visualizationError(GenericError, i18n.t('No access'), i18n.t(\"You don't have access to the requested data\"));\nexport const getAlertTypeByStatusCode = statusCode => String(statusCode).match(/50\\d/) ? 'error' : 'warning';\nexport const genericErrorTitle = i18n.t('Something went wrong');\nexport const isVisualizationError = error => error.icon && error.title && error.description;","import { createHashHistory } from 'history';\nexport default createHashHistory();","const SYSTEM_SETTING_DATE_FORMAT = 'keyDateFormat';\nconst SYSTEM_SETTINGS_RELATIVE_PERIOD = 'keyAnalysisRelativePeriod';\nexport const SYSTEM_SETTINGS_DIGIT_GROUP_SEPARATOR = 'keyAnalysisDigitGroupSeparator';\nexport const SYSTEM_SETTINGS_HIDE_DAILY_PERIODS = 'keyHideDailyPeriods';\nexport const SYSTEM_SETTINGS_HIDE_WEEKLY_PERIODS = 'keyHideWeeklyPeriods';\nexport const SYSTEM_SETTINGS_HIDE_BIWEEKLY_PERIODS = 'keyHideBiWeeklyPeriods';\nexport const SYSTEM_SETTINGS_HIDE_MONTHLY_PERIODS = 'keyHideMonthlyPeriods';\nexport const SYSTEM_SETTINGS_HIDE_BIMONTHLY_PERIODS = 'keyHideBiMonthlyPeriods';\nexport const systemSettingsKeys = [SYSTEM_SETTING_DATE_FORMAT, SYSTEM_SETTINGS_RELATIVE_PERIOD, SYSTEM_SETTINGS_DIGIT_GROUP_SEPARATOR, SYSTEM_SETTINGS_HIDE_DAILY_PERIODS, SYSTEM_SETTINGS_HIDE_WEEKLY_PERIODS, SYSTEM_SETTINGS_HIDE_BIWEEKLY_PERIODS, SYSTEM_SETTINGS_HIDE_MONTHLY_PERIODS, SYSTEM_SETTINGS_HIDE_BIMONTHLY_PERIODS];","export const USER_SETTINGS_UI_LOCALE = 'keyUiLocale';\nexport const USER_SETTINGS_DISPLAY_PROPERTY = 'keyAnalysisDisplayProperty';\nexport const DERIVED_USER_SETTINGS_DISPLAY_NAME_PROPERTY = 'DERIVED_USER_SETTINGS_DISPLAY_NAME_PROPERTY';\nexport const userSettingsKeys = [USER_SETTINGS_UI_LOCALE, USER_SETTINGS_DISPLAY_PROPERTY];","import { useDataMutation } from '@dhis2/app-runtime';\nimport i18n from '@dhis2/d2-i18n';\nimport { IconDelete16 } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { MessageIconButton } from '../index.js';\nconst mutation = {\n  resource: 'interpretations',\n  id: _ref => {\n    let {\n      id\n    } = _ref;\n    return id;\n  },\n  type: 'delete'\n};\n\nconst InterpretationDeleteButton = _ref2 => {\n  let {\n    id,\n    onComplete\n  } = _ref2;\n  const [remove, {\n    loading\n  }] = useDataMutation(mutation, {\n    onComplete,\n    variables: {\n      id\n    }\n  });\n  return /*#__PURE__*/React.createElement(MessageIconButton, {\n    tooltipContent: i18n.t('Delete'),\n    iconComponent: IconDelete16,\n    onClick: remove,\n    disabled: loading\n  });\n};\n\nInterpretationDeleteButton.propTypes = {\n  id: PropTypes.string.isRequired,\n  onComplete: PropTypes.func.isRequired\n};\nexport { InterpretationDeleteButton };","import _JSXStyle from \"styled-jsx/style\";\nimport { useDataMutation } from '@dhis2/app-runtime';\nimport i18n from '@dhis2/d2-i18n';\nimport { Button, spacers, colors } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { useState } from 'react';\nimport { MessageEditorContainer, RichTextEditor, MessageButtonStrip, InterpretationSharingLink } from '../index.js';\nconst mutation = {\n  resource: 'interpretations',\n  type: 'update',\n  partial: false,\n  id: _ref => {\n    let {\n      id\n    } = _ref;\n    return id;\n  },\n  data: _ref2 => {\n    let {\n      interpretationText\n    } = _ref2;\n    return interpretationText;\n  }\n};\nexport const InterpretationUpdateForm = _ref3 => {\n  let {\n    close,\n    currentUser,\n    id,\n    onComplete,\n    showSharingLink,\n    text\n  } = _ref3;\n  const [interpretationText, setInterpretationText] = useState(text || '');\n  const [update, {\n    loading,\n    error\n  }] = useDataMutation(mutation, {\n    onComplete: () => {\n      onComplete();\n      close();\n    },\n    variables: {\n      id\n    }\n  });\n  const errorText = error ? error.message || i18n.t('Could not update interpretation') : '';\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: _JSXStyle.dynamic([[\"2690082310\", [spacers.dp8, spacers.dp8, colors.grey100]]]) + \" \" + \"message\"\n  }, /*#__PURE__*/React.createElement(MessageEditorContainer, {\n    currentUser: currentUser\n  }, /*#__PURE__*/React.createElement(RichTextEditor, {\n    inputPlaceholder: i18n.t('Enter interpretation text'),\n    onChange: setInterpretationText,\n    value: interpretationText,\n    disabled: loading,\n    errorText: errorText\n  }), showSharingLink && /*#__PURE__*/React.createElement(InterpretationSharingLink, {\n    id: id,\n    type: \"interpretation\"\n  }), /*#__PURE__*/React.createElement(MessageButtonStrip, null, /*#__PURE__*/React.createElement(Button, {\n    loading: loading,\n    primary: true,\n    small: true,\n    onClick: () => update({\n      interpretationText\n    })\n  }, i18n.t('Update')), /*#__PURE__*/React.createElement(Button, {\n    disabled: loading,\n    secondary: true,\n    small: true,\n    onClick: close\n  }, i18n.t('Cancel')))), /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: \"2690082310\",\n    dynamic: [spacers.dp8, spacers.dp8, colors.grey100]\n  }, [\".message.__jsx-style-dynamic-selector{padding:0 \".concat(spacers.dp8, \" \").concat(spacers.dp8, \";background-color:\").concat(colors.grey100, \";border-radius:5px;}\")]));\n};\nInterpretationUpdateForm.propTypes = {\n  close: PropTypes.func.isRequired,\n  currentUser: PropTypes.object.isRequired,\n  id: PropTypes.string.isRequired,\n  onComplete: PropTypes.func.isRequired,\n  showSharingLink: PropTypes.bool,\n  text: PropTypes.string\n};","import i18n from '@dhis2/d2-i18n';\nimport { Button, SharingDialog, IconReply16, IconShare16, IconThumbUp16, IconEdit16 } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { useState } from 'react';\nimport { Message, MessageStatsBar, MessageIconButton } from '../index.js';\nimport { InterpretationDeleteButton } from './InterpretationDeleteButton.js';\nimport { InterpretationUpdateForm } from './InterpretationUpdateForm.js';\nimport { useLike } from './useLike.js';\nexport const Interpretation = _ref => {\n  let {\n    interpretation,\n    currentUser,\n    onClick,\n    onUpdated,\n    onDeleted,\n    disabled,\n    onReplyIconClick\n  } = _ref;\n  const [isUpdateMode, setIsUpdateMode] = useState(false);\n  const [showSharingDialog, setShowSharingDialog] = useState(false);\n  const {\n    toggleLike,\n    isLikedByCurrentUser,\n    toggleLikeInProgress\n  } = useLike({\n    interpretation,\n    currentUser,\n    onComplete: onUpdated\n  });\n  const shouldShowButton = !!onClick && !disabled;\n  return isUpdateMode ? /*#__PURE__*/React.createElement(InterpretationUpdateForm, {\n    close: () => setIsUpdateMode(false),\n    id: interpretation.id,\n    showSharingLink: interpretation.access.manage,\n    onComplete: onUpdated,\n    text: interpretation.text,\n    currentUser: currentUser\n  }) : /*#__PURE__*/React.createElement(Message, {\n    text: interpretation.text,\n    created: interpretation.created,\n    username: interpretation.user.displayName\n  }, !disabled && /*#__PURE__*/React.createElement(MessageStatsBar, null, /*#__PURE__*/React.createElement(MessageIconButton, {\n    tooltipContent: isLikedByCurrentUser ? i18n.t('Unlike') : i18n.t('Like'),\n    iconComponent: IconThumbUp16,\n    onClick: toggleLike,\n    selected: isLikedByCurrentUser,\n    count: interpretation.likes,\n    disabled: toggleLikeInProgress\n  }), /*#__PURE__*/React.createElement(MessageIconButton, {\n    tooltipContent: i18n.t('Reply'),\n    iconComponent: IconReply16,\n    onClick: () => onReplyIconClick(interpretation.id),\n    count: interpretation.comments.length\n  }), interpretation.access.manage && /*#__PURE__*/React.createElement(MessageIconButton, {\n    iconComponent: IconShare16,\n    tooltipContent: i18n.t('Share'),\n    onClick: () => setShowSharingDialog(true)\n  }), showSharingDialog && /*#__PURE__*/React.createElement(SharingDialog, {\n    open: true,\n    type: 'interpretation',\n    id: interpretation.id,\n    onClose: () => setShowSharingDialog(false)\n  }), interpretation.access.update && /*#__PURE__*/React.createElement(MessageIconButton, {\n    iconComponent: IconEdit16,\n    tooltipContent: i18n.t('Edit'),\n    onClick: () => setIsUpdateMode(true)\n  }), interpretation.access.delete && /*#__PURE__*/React.createElement(InterpretationDeleteButton, {\n    id: interpretation.id,\n    onComplete: onDeleted\n  })), shouldShowButton && /*#__PURE__*/React.createElement(Button, {\n    secondary: true,\n    small: true,\n    onClick: (_, event) => {\n      event.stopPropagation();\n      onClick(interpretation.id);\n    }\n  }, i18n.t('See interpretation')));\n};\nInterpretation.propTypes = {\n  currentUser: PropTypes.object.isRequired,\n  interpretation: PropTypes.object.isRequired,\n  onDeleted: PropTypes.func.isRequired,\n  onReplyIconClick: PropTypes.func.isRequired,\n  onUpdated: PropTypes.func.isRequired,\n  disabled: PropTypes.bool,\n  onClick: PropTypes.func\n};","import { useDataMutation } from '@dhis2/app-runtime';\nimport { useEffect, useRef, useState } from 'react';\n\nconst useLike = _ref => {\n  let {\n    interpretation,\n    currentUser,\n    onComplete\n  } = _ref;\n  const resource = \"interpretations/\".concat(interpretation.id, \"/like\");\n  const likeMutationRef = useRef({\n    resource,\n    type: 'create'\n  });\n  const unlikeMutationRef = useRef({\n    resource,\n    type: 'delete'\n  });\n  const [like, {\n    loading: likeLoading\n  }] = useDataMutation(likeMutationRef.current, {\n    onComplete\n  });\n  const [unlike, {\n    loading: unlikeLoading\n  }] = useDataMutation(unlikeMutationRef.current, {\n    onComplete\n  });\n  const [isLikedByCurrentUser, setIsLikedByCurrentUser] = useState(false);\n\n  const toggleLike = () => {\n    isLikedByCurrentUser ? unlike() : like();\n  };\n\n  useEffect(() => {\n    setIsLikedByCurrentUser(interpretation.likedBy.some(likedBy => likedBy.id === currentUser.id));\n  }, [currentUser, interpretation]);\n  return {\n    isLikedByCurrentUser,\n    toggleLike,\n    toggleLikeInProgress: likeLoading || unlikeLoading\n  };\n};\n\nexport { useLike };","import _JSXStyle from \"styled-jsx/style\";\nimport i18n from '@dhis2/d2-i18n';\nimport { SharingDialog, colors, spacers } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { useState } from 'react';\n\nconst InterpretationSharingLink = _ref => {\n  let {\n    type,\n    id\n  } = _ref;\n  const [showSharingDialog, setShowSharingDialog] = useState(false);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: _JSXStyle.dynamic([[\"3990725326\", [spacers.dp4, spacers.dp8, colors.grey800]]]) + \" \" + \"container\"\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    onClick: () => setShowSharingDialog(true),\n    className: _JSXStyle.dynamic([[\"3990725326\", [spacers.dp4, spacers.dp8, colors.grey800]]]) + \" \" + \"link\"\n  }, i18n.t('Manage sharing'))), showSharingDialog && /*#__PURE__*/React.createElement(SharingDialog, {\n    open: true,\n    type: type,\n    id: id,\n    onClose: () => setShowSharingDialog(false)\n  }), /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: \"3990725326\",\n    dynamic: [spacers.dp4, spacers.dp8, colors.grey800]\n  }, [\".container.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end;gap:\".concat(spacers.dp4, \";margin-top:\").concat(spacers.dp8, \";font-size:13px;color:\").concat(colors.grey800, \";cursor:pointer;}\"), \".link.__jsx-style-dynamic-selector{-webkit-text-decoration:underline;text-decoration:underline;}\"]));\n};\n\nInterpretationSharingLink.propTypes = {\n  id: PropTypes.string,\n  type: PropTypes.string\n};\nexport { InterpretationSharingLink };","import _JSXStyle from \"styled-jsx/style\";\nimport { Parser as RichTextParser } from '@dhis2/d2-ui-rich-text';\nimport { UserAvatar, spacers, colors } from '@dhis2/ui';\nimport moment from 'moment';\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nconst Message = _ref => {\n  let {\n    children,\n    text,\n    created,\n    username\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"li\", {\n    className: _JSXStyle.dynamic([[\"2436588813\", [spacers.dp8, colors.grey100, spacers.dp8, colors.grey900, colors.grey600, colors.grey900, spacers.dp8]]]) + \" \" + \"container\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: _JSXStyle.dynamic([[\"2436588813\", [spacers.dp8, colors.grey100, spacers.dp8, colors.grey900, colors.grey600, colors.grey900, spacers.dp8]]]) + \" \" + \"header\"\n  }, /*#__PURE__*/React.createElement(UserAvatar, {\n    name: username,\n    extrasmall: true\n  }), username, /*#__PURE__*/React.createElement(\"time\", {\n    dateTime: created,\n    className: _JSXStyle.dynamic([[\"2436588813\", [spacers.dp8, colors.grey100, spacers.dp8, colors.grey900, colors.grey600, colors.grey900, spacers.dp8]]])\n  }, moment(created).format('lll'))), /*#__PURE__*/React.createElement(\"div\", {\n    className: _JSXStyle.dynamic([[\"2436588813\", [spacers.dp8, colors.grey100, spacers.dp8, colors.grey900, colors.grey600, colors.grey900, spacers.dp8]]]) + \" \" + \"content\"\n  }, /*#__PURE__*/React.createElement(RichTextParser, null, text)), /*#__PURE__*/React.createElement(\"div\", {\n    className: _JSXStyle.dynamic([[\"2436588813\", [spacers.dp8, colors.grey100, spacers.dp8, colors.grey900, colors.grey600, colors.grey900, spacers.dp8]]]) + \" \" + \"footer\"\n  }, children), /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: \"2436588813\",\n    dynamic: [spacers.dp8, colors.grey100, spacers.dp8, colors.grey900, colors.grey600, colors.grey900, spacers.dp8]\n  }, [\".container.__jsx-style-dynamic-selector{padding:\".concat(spacers.dp8, \";background-color:\").concat(colors.grey100, \";border-radius:5px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;gap:\").concat(spacers.dp8, \";}\"), \".header.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;gap:6px;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;font-size:13px;line-height:16px;color:\".concat(colors.grey900, \";}\"), \".header.__jsx-style-dynamic-selector time.__jsx-style-dynamic-selector{font-size:12px;color:\".concat(colors.grey600, \";}\"), \".content.__jsx-style-dynamic-selector{font-size:14px;line-height:19px;color:\".concat(colors.grey900, \";}\"), \".content.__jsx-style-dynamic-selector p:first-child{margin:0;}\", \".footer.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;gap:\".concat(spacers.dp8, \";}\")]));\n};\n\nMessage.propTypes = {\n  children: PropTypes.node.isRequired,\n  created: PropTypes.string.isRequired,\n  text: PropTypes.string.isRequired,\n  username: PropTypes.string.isRequired\n};\nexport { Message };","import _JSXStyle from \"styled-jsx/style\";\nimport { spacers } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nconst MessageButtonStrip = _ref => {\n  let {\n    children\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: _JSXStyle.dynamic([[\"1819118406\", [spacers.dp8, spacers.dp8]]]) + \" \" + \"container\"\n  }, children, /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: \"1819118406\",\n    dynamic: [spacers.dp8, spacers.dp8]\n  }, [\".container.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;gap:\".concat(spacers.dp8, \";margin-top:\").concat(spacers.dp8, \";}\")]));\n};\n\nMessageButtonStrip.propTypes = {\n  children: PropTypes.node.isRequired\n};\nexport { MessageButtonStrip };","import _JSXStyle from \"styled-jsx/style\";\nimport { Tooltip, colors, spacers } from '@dhis2/ui';\nimport cx from 'classnames';\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nconst MessageIconButton = _ref => {\n  let {\n    tooltipContent,\n    disabled,\n    onClick,\n    selected,\n    count,\n    iconComponent: Icon\n  } = _ref;\n  return /*#__PURE__*/React.createElement(Tooltip, {\n    closeDelay: 200,\n    content: tooltipContent\n  }, _ref2 => {\n    let {\n      ref,\n      onMouseOver,\n      onMouseOut\n    } = _ref2;\n    return /*#__PURE__*/React.createElement(\"span\", {\n      ref: ref,\n      onMouseOver: onMouseOver,\n      onMouseOut: onMouseOut,\n      className: _JSXStyle.dynamic([[\"3807261824\", [spacers.dp4, colors.grey700, colors.teal600, colors.grey900, colors.teal800, colors.teal500, colors.teal700]]]) + \" \" + \"wrapper\"\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      onClick: event => {\n        event.stopPropagation();\n        onClick();\n      },\n      disabled: disabled,\n      className: _JSXStyle.dynamic([[\"3807261824\", [spacers.dp4, colors.grey700, colors.teal600, colors.grey900, colors.teal800, colors.teal500, colors.teal700]]]) + \" \" + (cx('button', {\n        selected\n      }) || \"\")\n    }, count && count, /*#__PURE__*/React.createElement(Icon, null)), /*#__PURE__*/React.createElement(_JSXStyle, {\n      id: \"3807261824\",\n      dynamic: [spacers.dp4, colors.grey700, colors.teal600, colors.grey900, colors.teal800, colors.teal500, colors.teal700]\n    }, [\".wrapper.__jsx-style-dynamic-selector{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;}\", \".button.__jsx-style-dynamic-selector{all:unset;cursor:pointer;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;gap:\".concat(spacers.dp4, \";-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;font-size:12px;line-height:14px;color:\").concat(colors.grey700, \";}\"), \".button.selected.__jsx-style-dynamic-selector{color:\".concat(colors.teal600, \";font-weight:500;}\"), \".button.__jsx-style-dynamic-selector:hover{color:\".concat(colors.grey900, \";}\"), \".button.selected.__jsx-style-dynamic-selector:hover{color:\".concat(colors.teal800, \";}\"), \".button.selected.__jsx-style-dynamic-selector svg{color:\".concat(colors.teal500, \";}\"), \".button.selected.__jsx-style-dynamic-selector:hover svg{color:\".concat(colors.teal700, \";}\")]));\n  });\n};\n\nMessageIconButton.propTypes = {\n  iconComponent: PropTypes.oneOfType([PropTypes.object, PropTypes.func]).isRequired,\n  tooltipContent: PropTypes.string.isRequired,\n  count: PropTypes.number,\n  disabled: PropTypes.bool,\n  selected: PropTypes.bool,\n  onClick: PropTypes.func\n};\nexport { MessageIconButton };","import _JSXStyle from \"styled-jsx/style\";\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport { theme, colors } from '@dhis2/ui';\nimport React, { forwardRef } from 'react';\nconst MessageInput = /*#__PURE__*/forwardRef((props, ref) => /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"input\", _extends({\n  ref: ref\n}, props, {\n  className: _JSXStyle.dynamic([[\"2769305849\", [colors.grey900, colors.grey500, theme.focus, colors.grey100, colors.grey500, theme.disabled]]]) + \" \" + (props && props.className != null && props.className || \"input\")\n})), /*#__PURE__*/React.createElement(_JSXStyle, {\n  id: \"2769305849\",\n  dynamic: [colors.grey900, colors.grey500, theme.focus, colors.grey100, colors.grey500, theme.disabled]\n}, [\".input.__jsx-style-dynamic-selector{width:100%;box-sizing:border-box;font-size:14px;line-height:16px;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text;color:\".concat(colors.grey900, \";background-color:white;padding:12px 11px 10px;outline:0;border:1px solid \").concat(colors.grey500, \";border-radius:3px;box-shadow:inset 0 1px 2px 0 rgba(48,54,60,0.1);text-overflow:ellipsis;}\"), \"input.__jsx-style-dynamic-selector:focus{outline:none;box-shadow:0 0 0 3px \".concat(theme.focus, \";}\"), \"input.disabled.__jsx-style-dynamic-selector{background-color:\".concat(colors.grey100, \";border-color:\").concat(colors.grey500, \";color:\").concat(theme.disabled, \";cursor:not-allowed;}\")])));\nMessageInput.displayName = 'MessageInput';\nexport { MessageInput };","import _JSXStyle from \"styled-jsx/style\";\nimport { UserAvatar, spacers } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nconst MessageEditorContainer = _ref => {\n  let {\n    children,\n    currentUser\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: _JSXStyle.dynamic([[\"3807884305\", [spacers.dp8, spacers.dp12]]]) + \" \" + \"container\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: _JSXStyle.dynamic([[\"3807884305\", [spacers.dp8, spacers.dp12]]]) + \" \" + \"avatar\"\n  }, /*#__PURE__*/React.createElement(UserAvatar, {\n    name: currentUser.name,\n    medium: true\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: _JSXStyle.dynamic([[\"3807884305\", [spacers.dp8, spacers.dp12]]]) + \" \" + \"editor\"\n  }, children), /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: \"3807884305\",\n    dynamic: [spacers.dp8, spacers.dp12]\n  }, [\".container.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;gap:\".concat(spacers.dp8, \";margin-top:\").concat(spacers.dp12, \";}\"), \".avatar.__jsx-style-dynamic-selector{-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;}\", \".editor.__jsx-style-dynamic-selector{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}\"]));\n};\n\nMessageEditorContainer.propTypes = {\n  currentUser: PropTypes.object.isRequired,\n  children: PropTypes.node\n};\nexport { MessageEditorContainer };","import _JSXStyle from \"styled-jsx/style\";\nimport { spacers } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nconst MessageStatsBar = _ref => {\n  let {\n    children\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: _JSXStyle.dynamic([[\"2534339265\", [spacers.dp12]]]) + \" \" + \"container\"\n  }, children, /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: \"2534339265\",\n    dynamic: [spacers.dp12]\n  }, [\".container.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;gap:\".concat(spacers.dp12, \";}\")]));\n};\n\nMessageStatsBar.propTypes = {\n  children: PropTypes.node.isRequired\n};\nexport { MessageStatsBar };","import _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nimport { colors, spacers } from '@dhis2/ui';\n\n/*\n * Note that the clone and clone > pre styles have been chosen\n * to emulate the styles of the textarea. If we decide to make\n * changes there, they should be refelcted here too.\n */\nexport const userMentionWrapperClasses = [\".wrapper.jsx-1289989717{position:relative;}\", \".clone.jsx-1289989717{position:absolute;visibility:hidden;inset:0;box-sizing:border-box;padding:\".concat(spacers.dp8, \" \").concat(spacers.dp12, \";border:1px solid \").concat(colors.grey500, \";font-size:14px;line-height:\").concat(spacers.dp16, \";z-index:1;pointer-events:none;}\"), \".clone.jsx-1289989717>pre.jsx-1289989717{display:inline;word-wrap:break-word;overflow-wrap:break-word;font:inherit;margin:0;}\", \".container.jsx-1289989717{background-color:\".concat(colors.white, \";max-height:180px;overflow:auto;}\")];\nuserMentionWrapperClasses.__hash = \"1289989717\";\nexport const resolvedHeaderStyle = {\n  styles: /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: \"4275958396\"\n  }, [\".jsx-4275958396{position:-webkit-sticky;position:sticky;top:0;}\"]),\n  className: \"jsx-4275958396\"\n};","import i18n from '@dhis2/d2-i18n';\nimport { MenuItem } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nexport const UserList = _ref => {\n  let {\n    users,\n    selectedUserIndex,\n    onUserClick,\n    pager\n  } = _ref;\n  return /*#__PURE__*/React.createElement(React.Fragment, null, users.map(u => {\n    var _users$selectedUserIn;\n\n    return /*#__PURE__*/React.createElement(MenuItem, {\n      dense: true,\n      key: u.id,\n      onClick: onUserClick(u),\n      label: \"\".concat(u.displayName, \" (\").concat(u.username, \")\"),\n      active: ((_users$selectedUserIn = users[selectedUserIndex]) === null || _users$selectedUserIn === void 0 ? void 0 : _users$selectedUserIn.id) === u.id\n    });\n  }), pager.total > pager.pageSize && /*#__PURE__*/React.createElement(MenuItem, {\n    dense: true,\n    disabled: true,\n    label: i18n.t('Too many results. Try refining the search.')\n  }));\n};\nUserList.propTypes = {\n  pager: PropTypes.object.isRequired,\n  selectedUserIndex: PropTypes.number.isRequired,\n  users: PropTypes.array.isRequired,\n  onUserClick: PropTypes.func.isRequired\n};","import { useDataQuery } from '@dhis2/app-runtime';\nimport debounce from 'lodash/debounce';\nimport { useCallback, useEffect, useState } from 'react';\nconst usersQuery = {\n  users: {\n    resource: 'users/gist',\n    params: _ref => {\n      let {\n        searchText\n      } = _ref;\n      return {\n        fields: 'id,displayName,username',\n        order: 'firstName,surname',\n        total: true,\n        filter: \"username:ilike:\".concat(searchText, \",firstName:ilike:\").concat(searchText, \",surname:ilike:\").concat(searchText, \",email:ilike:\").concat(searchText),\n        rootJunction: 'OR'\n      };\n    }\n  }\n};\nexport const useUserSearchResults = _ref2 => {\n  let {\n    searchText\n  } = _ref2;\n  const [{\n    users,\n    pager\n  }, setData] = useState({\n    users: [],\n    pager: {}\n  });\n  const {\n    data,\n    fetching,\n    refetch\n  } = useDataQuery(usersQuery, {\n    lazy: true\n  });\n  const debouncedRefetch = useCallback(debounce(refetch, 250), [refetch]);\n  useEffect(() => {\n    if (searchText.length) {\n      debouncedRefetch({\n        searchText\n      });\n    }\n\n    return () => debouncedRefetch.cancel();\n  }, [searchText]);\n  useEffect(() => {\n    if (data) {\n      setData(data.users);\n    }\n  }, [data]);\n  return {\n    users,\n    pager,\n    fetching,\n    clear: () => setData({\n      users: [],\n      pager: {}\n    })\n  };\n};","import _JSXStyle from \"styled-jsx/style\";\nimport i18n from '@dhis2/d2-i18n';\nimport { CenteredContent, CircularLoader, Menu, MenuSectionHeader, MenuItem, Popper, Card, Portal } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { useState, useRef } from 'react';\nimport { resolvedHeaderStyle, userMentionWrapperClasses } from './styles/UserMentionWrapper.style.js';\nimport { UserList } from './UserList.js';\nimport { useUserSearchResults } from './useUserSearchResults.js';\nconst AT_SYMBOL_WIDTH = 14;\n\nconst getVirtualPopperReference = ref => {\n  const rects = ref.current.getClientRects();\n  const lastRect = rects[rects.length - 1];\n  const left = lastRect.left + lastRect.width - AT_SYMBOL_WIDTH;\n  return {\n    getBoundingClientRect: () => ({\n      top: lastRect.top,\n      right: lastRect.right,\n      bottom: lastRect.bottom,\n      left,\n      width: AT_SYMBOL_WIDTH,\n      height: lastRect.height,\n      x: left\n    })\n  };\n};\n\nexport const UserMentionWrapper = _ref => {\n  let {\n    children,\n    inputReference,\n    onUserSelect\n  } = _ref;\n  const [captureText, setCaptureText] = useState(false);\n  const [capturedText, setCapturedText] = useState('');\n  const [cloneText, setCloneText] = useState('');\n  const cloneRef = useRef(null);\n  const [captureStartPosition, setCaptureStartPosition] = useState(null);\n  const [selectedUserIndex, setSelectedUserIndex] = useState(0);\n  const {\n    users,\n    pager,\n    fetching,\n    clear\n  } = useUserSearchResults({\n    searchText: capturedText\n  });\n\n  const reset = () => {\n    setCaptureText(false);\n    setCapturedText('');\n    setCloneText('');\n    setCaptureStartPosition(null);\n    setSelectedUserIndex(0);\n    clear();\n  }; // event bubbles up from the input/textarea\n\n\n  const onInput = _ref2 => {\n    let {\n      target\n    } = _ref2;\n    const {\n      selectionEnd,\n      value\n    } = target;\n\n    if (captureText) {\n      clear();\n      const spacePosition = value.indexOf(' ', captureStartPosition - 1);\n      const filterValue = value.substring(captureStartPosition, spacePosition > 0 ? spacePosition : selectionEnd + 1);\n\n      if (filterValue !== capturedText) {\n        setCapturedText(filterValue);\n      } else if (filterValue.length === 0) {\n        setCapturedText('');\n        clear();\n      }\n    }\n  }; // event bubbles up from the wrapped input/textarea\n\n\n  const onKeyDown = _ref3 => {\n    let {\n      key,\n      target\n    } = _ref3;\n    const {\n      selectionStart\n    } = target;\n\n    if (!captureText && key === '@') {\n      setCaptureText(true);\n      setCaptureStartPosition(selectionStart + 1);\n      setCloneText(target.value.substring(0, selectionStart) + '@');\n    } else if (captureText) {\n      if (key === ' ' || key === 'Backspace' && selectionStart <= captureStartPosition) {\n        reset();\n      } else if (users.length) {\n        switch (key) {\n          case 'Enter':\n            event.preventDefault();\n\n            if (selectedUserIndex >= 0) {\n              onSelect(users[selectedUserIndex]);\n            }\n\n            break;\n\n          case 'ArrowDown':\n            event.preventDefault();\n\n            if (selectedUserIndex < users.length - 1) {\n              setSelectedUserIndex(selectedUserIndex + 1);\n            }\n\n            break;\n\n          case 'ArrowUp':\n            event.preventDefault();\n\n            if (selectedUserIndex > 0) {\n              setSelectedUserIndex(selectedUserIndex - 1);\n            }\n\n            break;\n\n          default: // other key strokes, typically the text typed\n          // the onInput event handler set on the input element is triggering the user lookup\n\n        }\n      }\n    }\n  };\n\n  const onSelect = user => {\n    const originalValue = inputReference.current.value;\n    const newValue = \"\".concat(originalValue.slice(0, captureStartPosition - 1)).concat(originalValue.slice(captureStartPosition - 1).replace(/^@\\w*/, \"@\".concat(user.username, \" \")));\n    reset(); // typically for connected components we want the state to be updated too\n    // but the logic belongs to the wrapped component, so we just invoke the supplied callback\n\n    if (onUserSelect) {\n      onUserSelect(newValue);\n    } // need to refocus on the input/textarea\n\n\n    inputReference.current.focus(); // position the cursor at the end\n\n    requestAnimationFrame(() => inputReference.current.setSelectionRange(-1, -1), 0);\n  };\n\n  const onClick = user => () => onSelect(user);\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    onKeyDown: onKeyDown,\n    onInput: onInput,\n    className: \"jsx-\".concat(userMentionWrapperClasses.__hash) + \" \" + \"wrapper\"\n  }, children, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"jsx-\".concat(userMentionWrapperClasses.__hash) + \" \" + \"clone\"\n  }, /*#__PURE__*/React.createElement(\"pre\", {\n    ref: cloneRef,\n    className: \"jsx-\".concat(userMentionWrapperClasses.__hash)\n  }, cloneText)), captureText && /*#__PURE__*/React.createElement(Portal, null, /*#__PURE__*/React.createElement(Popper, {\n    reference: getVirtualPopperReference(cloneRef),\n    placement: \"top-start\"\n  }, /*#__PURE__*/React.createElement(Card, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"jsx-\".concat(userMentionWrapperClasses.__hash) + \" \" + \"container\"\n  }, /*#__PURE__*/React.createElement(Menu, {\n    dense: true\n  }, /*#__PURE__*/React.createElement(MenuSectionHeader, {\n    className: resolvedHeaderStyle.className,\n    dense: true,\n    hideDivider: true,\n    label: capturedText === '' ? i18n.t('Search for a user') : i18n.t('Searching for \"{{searchText}}\"', {\n      searchText: capturedText\n    })\n  }), fetching && /*#__PURE__*/React.createElement(MenuItem, {\n    label: /*#__PURE__*/React.createElement(CenteredContent, null, /*#__PURE__*/React.createElement(CircularLoader, {\n      small: true\n    }))\n  }), !fetching && users.length > 0 && /*#__PURE__*/React.createElement(UserList, {\n    users: users,\n    selectedUserIndex: selectedUserIndex,\n    onUserClick: onClick,\n    pager: pager\n  }), capturedText && !fetching && users.length === 0 && /*#__PURE__*/React.createElement(MenuItem, {\n    dense: true,\n    disabled: true,\n    label: i18n.t('No results found')\n  })))))), /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: userMentionWrapperClasses.__hash\n  }, userMentionWrapperClasses), resolvedHeaderStyle.styles);\n};\nUserMentionWrapper.defaultProps = {\n  onUserSelect: Function.prototype\n};\nUserMentionWrapper.propTypes = {\n  inputReference: PropTypes.object.isRequired,\n  onUserSelect: PropTypes.func.isRequired,\n  children: PropTypes.node\n};\nexport default UserMentionWrapper;","export const BOLD = 'bold';\nexport const ITALIC = 'italic';\nexport const LINK = 'link';\nexport const MENTION = 'mention';\nexport const EMOJI_SMILEY_FACE = 'smileyFace';\nexport const EMOJI_SAD_FACE = 'sadFace';\nexport const EMOJI_THUMBS_UP = 'thumbsUp';\nexport const EMOJI_THUMBS_DOWN = 'thumsDown';\nexport const emojis = {\n  [EMOJI_SMILEY_FACE]: ':-)',\n  [EMOJI_SAD_FACE]: ':-(',\n  [EMOJI_THUMBS_UP]: ':+1',\n  [EMOJI_THUMBS_DOWN]: ':-1'\n};\nconst markdownMap = {\n  [ITALIC]: {\n    prefix: '_',\n    postfix: '_'\n  },\n  [BOLD]: {\n    prefix: '*',\n    postfix: '*'\n  },\n  [LINK]: {\n    prefix: '[',\n    postfix: '](https://link-url)'\n  },\n  [MENTION]: {\n    prefix: '@'\n  },\n  [EMOJI_SMILEY_FACE]: {\n    prefix: emojis[EMOJI_SMILEY_FACE]\n  },\n  [EMOJI_SAD_FACE]: {\n    prefix: emojis[EMOJI_SAD_FACE]\n  },\n  [EMOJI_THUMBS_UP]: {\n    prefix: emojis[EMOJI_THUMBS_UP]\n  },\n  [EMOJI_THUMBS_DOWN]: {\n    prefix: emojis[EMOJI_THUMBS_DOWN]\n  }\n};\n\nconst trim = str => {\n  const leftSpaces = /^\\s+/;\n  const rightSpaces = /\\s+$/;\n  return str.replace(leftSpaces, '').replace(rightSpaces, '');\n};\n\nexport const insertMarkdown = (markdown, target, cb) => {\n  const {\n    selectionStart: start,\n    selectionEnd: end,\n    value\n  } = target;\n  const marker = markdownMap[markdown] || null;\n\n  if (!marker || !cb || start < 0) {\n    return;\n  }\n\n  let newValue;\n  let caretPos = end + 1;\n\n  const padMarkers = text => {\n    // is caret between two markers (i.e., \"**\" or \"__\")? Then do not add padding\n    if (start === end && value.length && start > 0) {\n      if (value[start - 1] === markdownMap[BOLD].prefix && value[start] === markdownMap[BOLD].prefix || value[start - 1] === markdownMap[ITALIC].prefix && value[start] === markdownMap[ITALIC].prefix) {\n        return text;\n      }\n    }\n\n    if (value.length && start > 0 && value[start - 1] !== ' ') {\n      text = \" \".concat(text);\n      ++caretPos;\n    }\n\n    if (value.length && end !== value.length && value[end] !== ' ') {\n      text = \"\".concat(text, \" \");\n    }\n\n    return text;\n  };\n\n  if (start === end) {\n    //no text\n    const valueArr = value.split('');\n    let markdown = marker.prefix;\n\n    if (marker.postfix) {\n      markdown += marker.postfix;\n    }\n\n    valueArr.splice(start, 0, padMarkers(markdown));\n    newValue = valueArr.join('');\n  } else {\n    const text = value.slice(start, end);\n    const trimmedText = trim(text); // TODO really needed?\n    // adjust caretPos based on trimmed text selection\n\n    caretPos = caretPos - (text.length - trimmedText.length) + 1;\n    let markdown = \"\".concat(marker.prefix).concat(trimmedText);\n\n    if (marker.postfix) {\n      markdown += marker.postfix;\n    }\n\n    newValue = [value.slice(0, start), padMarkers(markdown), value.slice(end)].join('');\n  }\n\n  cb(newValue, caretPos);\n};\nexport const convertCtrlKey = (event, cb) => {\n  const {\n    key,\n    ctrlKey,\n    metaKey\n  } = event;\n\n  if (key === 'b' && (ctrlKey || metaKey)) {\n    event.preventDefault();\n    insertMarkdown(BOLD, event.target, cb);\n  } else if (key === 'i' && (ctrlKey || metaKey)) {\n    event.preventDefault();\n    insertMarkdown(ITALIC, event.target, cb);\n  }\n};","import { colors, spacers, theme } from '@dhis2/ui';\nexport const mainClasses = [\".container.jsx-2278350860{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:100%;}\", \".preview.jsx-2278350860{font-size:14px;line-height:19px;color:\".concat(colors.grey900, \";}\"), \".textarea.jsx-2278350860{width:100%;box-sizing:border-box;padding:\".concat(spacers.dp8, \" \").concat(spacers.dp12, \";color:\").concat(colors.grey900, \";background-color:\").concat(colors.white, \";border:1px solid \").concat(colors.grey500, \";border-radius:3px;box-shadow:inset 0 0 0 1px rgba(102,113,123,0.15), inset 0 1px 2px 0 rgba(102,113,123,0.1);outline:0;font-size:14px;line-height:\").concat(spacers.dp16, \";-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text;}\"), \".textarea.jsx-2278350860:focus{outline:none;box-shadow:0 0 0 3px \".concat(theme.focus, \";}\"), \".textarea.jsx-2278350860:disabled{background-color:\".concat(colors.grey100, \";border-color:\").concat(colors.grey500, \";color:\").concat(theme.disabled, \";cursor:not-allowed;}\")];\nmainClasses.__hash = \"2278350860\";\nexport const toolbarClasses = [\".toolbar.jsx-1189800463{background:\".concat(colors.grey050, \";border-radius:3px;border:1px solid \").concat(colors.grey300, \";margin-bottom:\").concat(spacers.dp4, \";}\"), \".actionsWrapper.jsx-1189800463{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;gap:\".concat(spacers.dp4, \";-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:\").concat(spacers.dp4, \";}\"), \".mainActions.jsx-1189800463{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;gap:\".concat(spacers.dp4, \";margin-top:\").concat(spacers.dp2, \";}\"), \".sideActions.jsx-1189800463{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-left:auto;}\", \".previewWrapper.jsx-1189800463{margin:\".concat(spacers.dp4, \";text-align:right;}\")];\ntoolbarClasses.__hash = \"1189800463\";\nexport const tooltipAnchorClasses = [\".tooltip.jsx-2182400256{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}\"];\ntooltipAnchorClasses.__hash = \"2182400256\";\nexport const emojisPopoverClasses = [\".emojisList.jsx-2802175370{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;gap:\".concat(spacers.dp8, \";list-style-type:none;margin:0 \").concat(spacers.dp4, \" 0 \").concat(spacers.dp8, \";padding:0;}\"), \".emojisList.jsx-2802175370 li.jsx-2802175370{cursor:pointer;}\"];\nemojisPopoverClasses.__hash = \"2802175370\";","import _JSXStyle from \"styled-jsx/style\";\nimport i18n from '@dhis2/d2-i18n';\nimport { Parser as RichTextParser } from '@dhis2/d2-ui-rich-text';\nimport { Button, Popover, Tooltip, Field, IconAt24, IconFaceAdd24, IconLink24, IconTextBold24, IconTextItalic24, colors } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { forwardRef, useRef, useEffect, useState } from 'react';\nimport { UserMentionWrapper } from '../UserMention/UserMentionWrapper.js';\nimport { convertCtrlKey, insertMarkdown, emojis, EMOJI_SMILEY_FACE, EMOJI_SAD_FACE, EMOJI_THUMBS_UP, EMOJI_THUMBS_DOWN, BOLD, ITALIC, LINK, MENTION } from './markdownHandler.js';\nimport { mainClasses, toolbarClasses, tooltipAnchorClasses, emojisPopoverClasses } from './styles/RichTextEditor.style.js';\n\nconst EmojisPopover = _ref => {\n  let {\n    onInsertMarkdown,\n    onClose,\n    reference\n  } = _ref;\n  return /*#__PURE__*/React.createElement(Popover, {\n    reference: reference,\n    onClickOutside: onClose\n  }, /*#__PURE__*/React.createElement(\"ul\", {\n    className: \"jsx-\".concat(emojisPopoverClasses.__hash) + \" \" + \"emojisList\"\n  }, /*#__PURE__*/React.createElement(\"li\", {\n    onClick: () => onInsertMarkdown(EMOJI_SMILEY_FACE),\n    className: \"jsx-\".concat(emojisPopoverClasses.__hash)\n  }, /*#__PURE__*/React.createElement(RichTextParser, null, emojis[EMOJI_SMILEY_FACE])), /*#__PURE__*/React.createElement(\"li\", {\n    onClick: () => onInsertMarkdown(EMOJI_SAD_FACE),\n    className: \"jsx-\".concat(emojisPopoverClasses.__hash)\n  }, /*#__PURE__*/React.createElement(RichTextParser, null, emojis[EMOJI_SAD_FACE])), /*#__PURE__*/React.createElement(\"li\", {\n    onClick: () => onInsertMarkdown(EMOJI_THUMBS_UP),\n    className: \"jsx-\".concat(emojisPopoverClasses.__hash)\n  }, /*#__PURE__*/React.createElement(RichTextParser, null, emojis[EMOJI_THUMBS_UP])), /*#__PURE__*/React.createElement(\"li\", {\n    onClick: () => onInsertMarkdown(EMOJI_THUMBS_DOWN),\n    className: \"jsx-\".concat(emojisPopoverClasses.__hash)\n  }, /*#__PURE__*/React.createElement(RichTextParser, null, emojis[EMOJI_THUMBS_DOWN]))), /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: emojisPopoverClasses.__hash\n  }, emojisPopoverClasses));\n};\n\nEmojisPopover.propTypes = {\n  onClose: PropTypes.func.isRequired,\n  onInsertMarkdown: PropTypes.func.isRequired,\n  reference: PropTypes.object\n};\n\nconst IconButtonWithTooltip = _ref2 => {\n  let {\n    tooltipContent,\n    disabled,\n    icon,\n    onClick\n  } = _ref2;\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Tooltip, {\n    content: tooltipContent,\n    placement: \"bottom\",\n    closeDelay: 200\n  }, _ref3 => {\n    let {\n      ref,\n      onMouseOver,\n      onMouseOut\n    } = _ref3;\n    return /*#__PURE__*/React.createElement(\"span\", {\n      ref: ref,\n      onMouseOver: onMouseOver,\n      onMouseOut: onMouseOut,\n      className: \"jsx-\".concat(tooltipAnchorClasses.__hash) + \" \" + \"tooltip\"\n    }, /*#__PURE__*/React.createElement(Button, {\n      secondary: true,\n      small: true,\n      disabled: disabled,\n      icon: icon,\n      onClick: onClick\n    }));\n  }), /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: tooltipAnchorClasses.__hash\n  }, tooltipAnchorClasses));\n};\n\nIconButtonWithTooltip.propTypes = {\n  disabled: PropTypes.bool,\n  icon: PropTypes.node,\n  tooltipContent: PropTypes.string,\n  onClick: PropTypes.func\n};\n\nconst Toolbar = _ref4 => {\n  let {\n    disabled,\n    onInsertMarkdown,\n    onTogglePreview,\n    previewButtonDisabled,\n    previewMode\n  } = _ref4;\n  const emojisButtonRef = useRef();\n  const [emojisPopoverIsOpen, setEmojisPopoverIsOpen] = useState(false);\n  const iconColor = disabled ? colors.grey600 : colors.grey700;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"jsx-\".concat(tooltipAnchorClasses.__hash, \" jsx-\").concat(toolbarClasses.__hash) + \" \" + \"toolbar\"\n  }, !previewMode ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"jsx-\".concat(tooltipAnchorClasses.__hash, \" jsx-\").concat(toolbarClasses.__hash) + \" \" + \"actionsWrapper\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"jsx-\".concat(tooltipAnchorClasses.__hash, \" jsx-\").concat(toolbarClasses.__hash) + \" \" + \"mainActions\"\n  }, /*#__PURE__*/React.createElement(IconButtonWithTooltip, {\n    tooltipContent: i18n.t('Bold text'),\n    disabled: disabled,\n    icon: /*#__PURE__*/React.createElement(IconTextBold24, {\n      color: iconColor\n    }),\n    onClick: () => onInsertMarkdown(BOLD)\n  }), /*#__PURE__*/React.createElement(IconButtonWithTooltip, {\n    tooltipContent: i18n.t('Italic text'),\n    disabled: disabled,\n    icon: /*#__PURE__*/React.createElement(IconTextItalic24, {\n      color: iconColor\n    }),\n    onClick: () => onInsertMarkdown(ITALIC)\n  }), /*#__PURE__*/React.createElement(IconButtonWithTooltip, {\n    tooltipContent: i18n.t('Link to a URL'),\n    disabled: disabled,\n    icon: /*#__PURE__*/React.createElement(IconLink24, {\n      color: iconColor\n    }),\n    onClick: () => onInsertMarkdown(LINK)\n  }), /*#__PURE__*/React.createElement(IconButtonWithTooltip, {\n    tooltipContent: i18n.t('Mention a user'),\n    disabled: disabled,\n    icon: /*#__PURE__*/React.createElement(IconAt24, {\n      color: iconColor\n    }),\n    onClick: () => onInsertMarkdown(MENTION)\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    ref: emojisButtonRef,\n    className: \"jsx-\".concat(tooltipAnchorClasses.__hash, \" jsx-\").concat(toolbarClasses.__hash) + \" \" + \"tooltip\"\n  }, /*#__PURE__*/React.createElement(IconButtonWithTooltip, {\n    tooltipContent: i18n.t('Add emoji'),\n    disabled: disabled,\n    icon: /*#__PURE__*/React.createElement(IconFaceAdd24, {\n      color: iconColor\n    }),\n    onClick: () => setEmojisPopoverIsOpen(true)\n  })), emojisPopoverIsOpen && /*#__PURE__*/React.createElement(EmojisPopover, {\n    onClose: () => setEmojisPopoverIsOpen(false),\n    onInsertMarkdown: markup => {\n      onInsertMarkdown(markup);\n      setEmojisPopoverIsOpen(false);\n    },\n    reference: emojisButtonRef\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"jsx-\".concat(tooltipAnchorClasses.__hash, \" jsx-\").concat(toolbarClasses.__hash) + \" \" + \"sideActions\"\n  }, /*#__PURE__*/React.createElement(Button, {\n    secondary: true,\n    small: true,\n    disabled: previewButtonDisabled || disabled,\n    onClick: onTogglePreview\n  }, i18n.t('Preview')))) : /*#__PURE__*/React.createElement(\"div\", {\n    className: \"jsx-\".concat(tooltipAnchorClasses.__hash, \" jsx-\").concat(toolbarClasses.__hash) + \" \" + \"previewWrapper\"\n  }, /*#__PURE__*/React.createElement(Button, {\n    secondary: true,\n    small: true,\n    onClick: onTogglePreview,\n    disabled: disabled\n  }, i18n.t('Back to write mode'))), /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: tooltipAnchorClasses.__hash\n  }, tooltipAnchorClasses), /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: toolbarClasses.__hash\n  }, toolbarClasses));\n};\n\nToolbar.propTypes = {\n  previewButtonDisabled: PropTypes.bool.isRequired,\n  previewMode: PropTypes.bool.isRequired,\n  onInsertMarkdown: PropTypes.func.isRequired,\n  onTogglePreview: PropTypes.func.isRequired,\n  disabled: PropTypes.bool\n};\nexport const RichTextEditor = /*#__PURE__*/forwardRef((_ref5, externalRef) => {\n  let {\n    value,\n    disabled,\n    inputPlaceholder,\n    onChange,\n    errorText\n  } = _ref5;\n  const [previewMode, setPreviewMode] = useState(false);\n  const internalRef = useRef();\n  const textareaRef = externalRef || internalRef;\n  useEffect(() => {\n    var _textareaRef$current;\n\n    return (_textareaRef$current = textareaRef.current) === null || _textareaRef$current === void 0 ? void 0 : _textareaRef$current.focus();\n  }, [textareaRef.current]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"jsx-\".concat(mainClasses.__hash) + \" \" + \"container\"\n  }, /*#__PURE__*/React.createElement(Toolbar, {\n    onInsertMarkdown: markdown => {\n      insertMarkdown(markdown, textareaRef.current, (text, caretPos) => {\n        onChange(text);\n        textareaRef.current.focus();\n        textareaRef.current.selectionEnd = caretPos;\n      });\n\n      if (markdown === MENTION) {\n        textareaRef.current.dispatchEvent(new KeyboardEvent('keydown', {\n          key: '@',\n          bubbles: true\n        }));\n      }\n    },\n    onTogglePreview: () => setPreviewMode(!previewMode),\n    previewMode: previewMode,\n    previewButtonDisabled: !value,\n    disabled: disabled\n  }), previewMode ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"jsx-\".concat(mainClasses.__hash) + \" \" + \"preview\"\n  }, /*#__PURE__*/React.createElement(RichTextParser, null, value)) : /*#__PURE__*/React.createElement(Field, {\n    error: !!errorText,\n    validationText: errorText\n  }, /*#__PURE__*/React.createElement(UserMentionWrapper, {\n    onUserSelect: onChange,\n    inputReference: textareaRef\n  }, /*#__PURE__*/React.createElement(\"textarea\", {\n    ref: textareaRef,\n    placeholder: inputPlaceholder,\n    disabled: disabled,\n    value: value,\n    onChange: event => onChange(event.target.value),\n    onKeyDown: event => convertCtrlKey(event, onChange),\n    className: \"jsx-\".concat(mainClasses.__hash) + \" \" + \"textarea\"\n  }))), /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: mainClasses.__hash\n  }, mainClasses));\n});\nRichTextEditor.displayName = 'RichTextEditor';\nRichTextEditor.propTypes = {\n  value: PropTypes.string.isRequired,\n  onChange: PropTypes.func.isRequired,\n  disabled: PropTypes.bool,\n  errorText: PropTypes.string,\n  inputPlaceholder: PropTypes.string\n};","import { useDataMutation } from '@dhis2/app-runtime';\nimport i18n from '@dhis2/d2-i18n';\nimport { Button, Input } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { useRef, useState } from 'react';\nimport { RichTextEditor, MessageEditorContainer, MessageButtonStrip } from '../common/index.js';\nexport const InterpretationForm = _ref => {\n  let {\n    type,\n    id,\n    currentUser,\n    disabled,\n    onSave\n  } = _ref;\n  const [showRichTextEditor, setShowRichTextEditor] = useState(false);\n  const [interpretationText, setInterpretationText] = useState('');\n  const saveMutationRef = useRef({\n    resource: \"interpretations/\".concat(type, \"/\").concat(id),\n    type: 'create',\n    data: _ref2 => {\n      let {\n        interpretationText\n      } = _ref2;\n      return interpretationText;\n    }\n  });\n  const [save, {\n    loading: saveMutationInProgress\n  }] = useDataMutation(saveMutationRef.current, {\n    onComplete: () => {\n      setShowRichTextEditor(false);\n      setInterpretationText('');\n      onSave();\n    }\n  });\n  const inputPlaceholder = i18n.t('Write an interpretation');\n  return /*#__PURE__*/React.createElement(MessageEditorContainer, {\n    currentUser: currentUser\n  }, showRichTextEditor ? /*#__PURE__*/React.createElement(\"div\", null, /*#__PURE__*/React.createElement(RichTextEditor, {\n    disabled: saveMutationInProgress,\n    inputPlaceholder: inputPlaceholder,\n    onChange: setInterpretationText,\n    value: interpretationText\n  }), /*#__PURE__*/React.createElement(MessageButtonStrip, null, /*#__PURE__*/React.createElement(Button, {\n    primary: true,\n    small: true,\n    disabled: saveMutationInProgress,\n    onClick: () => save({\n      interpretationText\n    })\n  }, i18n.t('Post interpretation')), /*#__PURE__*/React.createElement(Button, {\n    secondary: true,\n    small: true,\n    disabled: saveMutationInProgress,\n    onClick: () => {\n      setInterpretationText('');\n      setShowRichTextEditor(false);\n    }\n  }, i18n.t('Cancel')))) : /*#__PURE__*/React.createElement(Input, {\n    onFocus: () => setShowRichTextEditor(true),\n    placeholder: inputPlaceholder,\n    disabled: disabled\n  }));\n};\nInterpretationForm.propTypes = {\n  currentUser: PropTypes.object,\n  disabled: PropTypes.bool,\n  id: PropTypes.string,\n  type: PropTypes.string,\n  onSave: PropTypes.func\n};","import _JSXStyle from \"styled-jsx/style\";\nimport { IconCalendar24, colors, spacers } from '@dhis2/ui';\nimport moment from 'moment';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { Interpretation } from '../common/index.js';\n\nconst sortByCreatedDateDesc = (a, b) => {\n  const dateA = a.created;\n  const dateB = b.created;\n\n  if (dateA < dateB) {\n    return 1;\n  }\n\n  if (dateA > dateB) {\n    return -1;\n  }\n\n  return 0;\n};\n\nexport const InterpretationList = _ref => {\n  let {\n    currentUser,\n    interpretations,\n    onInterpretationClick,\n    onReplyIconClick,\n    refresh,\n    disabled\n  } = _ref;\n  const interpretationsByDate = interpretations.reduce((groupedInterpretations, interpretation) => {\n    const date = interpretation.created.split('T')[0];\n\n    if (date in groupedInterpretations) {\n      groupedInterpretations[date].push(interpretation);\n    } else {\n      groupedInterpretations[date] = [interpretation];\n    }\n\n    return groupedInterpretations;\n  }, {});\n  return /*#__PURE__*/React.createElement(\"ol\", {\n    className: _JSXStyle.dynamic([[\"4058400613\", [spacers.dp8, spacers.dp8, spacers.dp16, colors.grey800, spacers.dp12, spacers.dp12, spacers.dp32, spacers.dp4]]]) + \" \" + \"interpretation-groups\"\n  }, Object.keys(interpretationsByDate).sort().reverse().map(date => /*#__PURE__*/React.createElement(\"li\", {\n    key: date,\n    className: _JSXStyle.dynamic([[\"4058400613\", [spacers.dp8, spacers.dp8, spacers.dp16, colors.grey800, spacers.dp12, spacers.dp12, spacers.dp32, spacers.dp4]]])\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: _JSXStyle.dynamic([[\"4058400613\", [spacers.dp8, spacers.dp8, spacers.dp16, colors.grey800, spacers.dp12, spacers.dp12, spacers.dp32, spacers.dp4]]]) + \" \" + \"date-section\"\n  }, /*#__PURE__*/React.createElement(IconCalendar24, {\n    color: colors.grey600\n  }), /*#__PURE__*/React.createElement(\"time\", {\n    dateTime: date,\n    className: _JSXStyle.dynamic([[\"4058400613\", [spacers.dp8, spacers.dp8, spacers.dp16, colors.grey800, spacers.dp12, spacers.dp12, spacers.dp32, spacers.dp4]]]) + \" \" + \"date-header\"\n  }, moment(date).format('ll'))), /*#__PURE__*/React.createElement(\"ol\", {\n    className: _JSXStyle.dynamic([[\"4058400613\", [spacers.dp8, spacers.dp8, spacers.dp16, colors.grey800, spacers.dp12, spacers.dp12, spacers.dp32, spacers.dp4]]]) + \" \" + \"interpretation-list\"\n  }, interpretationsByDate[date].sort(sortByCreatedDateDesc).map(interpretation => /*#__PURE__*/React.createElement(Interpretation, {\n    key: interpretation.id,\n    interpretation: interpretation,\n    currentUser: currentUser,\n    onClick: onInterpretationClick,\n    onReplyIconClick: onReplyIconClick,\n    onDeleted: refresh,\n    onUpdated: refresh,\n    disabled: disabled\n  }))))), /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: \"4058400613\",\n    dynamic: [spacers.dp8, spacers.dp8, spacers.dp16, colors.grey800, spacers.dp12, spacers.dp12, spacers.dp32, spacers.dp4]\n  }, [\".date-section.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;gap:\".concat(spacers.dp8, \";-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-bottom:\").concat(spacers.dp8, \";}\"), \".date-header.__jsx-style-dynamic-selector{font-size:14px;font-weight:500;line-height:\".concat(spacers.dp16, \";color:\").concat(colors.grey800, \";}\"), \".interpretation-groups.__jsx-style-dynamic-selector{margin:0;padding:0;padding-top:\".concat(spacers.dp12, \";list-style:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;gap:\").concat(spacers.dp12, \";}\"), \".interpretation-list.__jsx-style-dynamic-selector{margin:0;padding-left:\".concat(spacers.dp32, \";list-style:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;gap:\").concat(spacers.dp4, \";}\")]));\n};\nInterpretationList.propTypes = {\n  currentUser: PropTypes.object.isRequired,\n  interpretations: PropTypes.array.isRequired,\n  refresh: PropTypes.func.isRequired,\n  onInterpretationClick: PropTypes.func.isRequired,\n  onReplyIconClick: PropTypes.func.isRequired,\n  disabled: PropTypes.bool\n};","import _JSXStyle from \"styled-jsx/style\";\nimport { useDataQuery } from '@dhis2/app-runtime';\nimport i18n from '@dhis2/d2-i18n';\nimport { CircularLoader, IconChevronDown24, IconChevronUp24, colors, spacers } from '@dhis2/ui';\nimport cx from 'classnames';\nimport PropTypes from 'prop-types';\nimport React, { useEffect, useState, useImperativeHandle, forwardRef } from 'react';\nimport { InterpretationForm } from './InterpretationForm.js';\nimport { InterpretationList } from './InterpretationList.js';\nconst interpretationsQuery = {\n  interpretations: {\n    resource: 'interpretations',\n    params: _ref => {\n      let {\n        type,\n        id\n      } = _ref;\n      return {\n        fields: ['access', 'id', 'user[displayName]', 'created', 'text', 'comments[id]', 'likes', 'likedBy[id]'],\n        filter: \"\".concat(type, \".id:eq:\").concat(id)\n      };\n    }\n  }\n};\nexport const InterpretationsUnit = /*#__PURE__*/forwardRef((_ref2, ref) => {\n  let {\n    currentUser,\n    type,\n    id,\n    onInterpretationClick,\n    onReplyIconClick,\n    disabled\n  } = _ref2;\n  const [isExpanded, setIsExpanded] = useState(true);\n  const {\n    data,\n    loading,\n    fetching,\n    refetch\n  } = useDataQuery(interpretationsQuery, {\n    lazy: true\n  });\n\n  const onCompleteAction = () => {\n    refetch({\n      type,\n      id\n    });\n  };\n\n  useImperativeHandle(ref, () => ({\n    refresh: onCompleteAction\n  }), []);\n  useEffect(() => {\n    if (id) {\n      refetch({\n        type,\n        id\n      });\n    }\n  }, [type, id]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: _JSXStyle.dynamic([[\"4120713286\", [spacers.dp16, colors.grey400, colors.white, spacers.dp32, colors.grey900]]]) + \" \" + (cx('container', {\n      expanded: isExpanded\n    }) || \"\")\n  }, fetching && !loading && /*#__PURE__*/React.createElement(\"div\", {\n    className: _JSXStyle.dynamic([[\"4120713286\", [spacers.dp16, colors.grey400, colors.white, spacers.dp32, colors.grey900]]]) + \" \" + \"fetching-loader\"\n  }, /*#__PURE__*/React.createElement(CircularLoader, {\n    small: true\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    onClick: () => setIsExpanded(!isExpanded),\n    className: _JSXStyle.dynamic([[\"4120713286\", [spacers.dp16, colors.grey400, colors.white, spacers.dp32, colors.grey900]]]) + \" \" + \"header\"\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: _JSXStyle.dynamic([[\"4120713286\", [spacers.dp16, colors.grey400, colors.white, spacers.dp32, colors.grey900]]]) + \" \" + \"title\"\n  }, i18n.t('Interpretations')), isExpanded ? /*#__PURE__*/React.createElement(IconChevronUp24, {\n    color: colors.grey700\n  }) : /*#__PURE__*/React.createElement(IconChevronDown24, {\n    color: colors.grey700\n  })), isExpanded && /*#__PURE__*/React.createElement(React.Fragment, null, loading && /*#__PURE__*/React.createElement(\"div\", {\n    className: _JSXStyle.dynamic([[\"4120713286\", [spacers.dp16, colors.grey400, colors.white, spacers.dp32, colors.grey900]]]) + \" \" + \"loader\"\n  }, /*#__PURE__*/React.createElement(CircularLoader, {\n    small: true\n  })), data && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(InterpretationForm, {\n    currentUser: currentUser,\n    type: type,\n    id: id,\n    onSave: onCompleteAction,\n    disabled: disabled\n  }), /*#__PURE__*/React.createElement(InterpretationList, {\n    currentUser: currentUser,\n    interpretations: data.interpretations.interpretations,\n    onInterpretationClick: onInterpretationClick,\n    onReplyIconClick: onReplyIconClick,\n    refresh: onCompleteAction,\n    disabled: disabled\n  }))), /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: \"4120713286\",\n    dynamic: [spacers.dp16, colors.grey400, colors.white, spacers.dp32, colors.grey900]\n  }, [\".container.__jsx-style-dynamic-selector{position:relative;padding:\".concat(spacers.dp16, \";border-bottom:1px solid \").concat(colors.grey400, \";background-color:\").concat(colors.white, \";}\"), \".fetching-loader.__jsx-style-dynamic-selector{position:absolute;inset:0px;background-color:rgba(255,255,255,0.8);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;z-index:1;}\", \".expanded.__jsx-style-dynamic-selector{padding-bottom:\".concat(spacers.dp32, \";}\"), \".loader.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}\", \".header.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;cursor:pointer;}\", \".title.__jsx-style-dynamic-selector{font-size:16px;font-weight:500;line-height:21px;color:\".concat(colors.grey900, \";}\")]));\n});\nInterpretationsUnit.displayName = 'InterpretationsUnit';\nInterpretationsUnit.defaultProps = {\n  onInterpretationClick: Function.prototype\n};\nInterpretationsUnit.propTypes = {\n  currentUser: PropTypes.object.isRequired,\n  id: PropTypes.string.isRequired,\n  type: PropTypes.string.isRequired,\n  disabled: PropTypes.bool,\n  onInterpretationClick: PropTypes.func,\n  onReplyIconClick: PropTypes.func\n};","import { AboutAOUnit, useCachedDataQuery } from '@dhis2/analytics';\nimport PropTypes from 'prop-types';\nimport { stringify } from 'query-string';\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport history from '../../modules/history.js';\nimport { sGetCurrent } from '../../reducers/current.js';\nimport { sGetLoadError } from '../../reducers/loader.js';\nimport { InterpretationsUnit } from '../Interpretations/InterpretationsUnit/index.js';\nimport classes from './styles/DetailsPanel.module.css';\n\nconst navigateToOpenModal = (interpretationId, initialFocus) => {\n  history.push({\n    pathName: history.location.pathname,\n    search: \"?\".concat(stringify({\n      interpretationId,\n      initialFocus\n    }))\n  }, {\n    isModalOpening: true\n  });\n};\n\nconst DetailsPanel = _ref => {\n  let {\n    interpretationsUnitRef,\n    visualization,\n    disabled\n  } = _ref;\n  const {\n    currentUser\n  } = useCachedDataQuery();\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.panel\n  }, /*#__PURE__*/React.createElement(AboutAOUnit, {\n    type: \"eventVisualizations\",\n    id: visualization.id\n  }), /*#__PURE__*/React.createElement(InterpretationsUnit, {\n    ref: interpretationsUnitRef,\n    type: \"eventVisualization\",\n    id: visualization.id,\n    currentUser: currentUser,\n    onInterpretationClick: interpretationId => navigateToOpenModal(interpretationId),\n    onReplyIconClick: interpretationId => navigateToOpenModal(interpretationId, true),\n    disabled: disabled\n  }));\n};\n\nDetailsPanel.propTypes = {\n  interpretationsUnitRef: PropTypes.object.isRequired,\n  visualization: PropTypes.object.isRequired,\n  disabled: PropTypes.bool\n};\n\nconst mapStateToProps = state => ({\n  visualization: sGetCurrent(state),\n  disabled: !!sGetLoadError(state)\n});\n\nexport default connect(mapStateToProps)(DetailsPanel);","import { formatValue, DIMENSION_TYPE_PROGRAM_INDICATOR } from '@dhis2/analytics';\nimport i18n from '@dhis2/d2-i18n'; // parse e.g. 'LT:25:GT:15' to ['LT:25', 'GT:15']\n\nexport const parseConditionsStringToArray = conditionsString => (conditionsString === null || conditionsString === void 0 ? void 0 : conditionsString.match(/[^:]+:[^:]+/g)) || conditionsString || []; // parse e.g. ['LT:25', 'GT:15'] to 'LT:25:GT:15'\n\nexport const parseConditionsArrayToString = conditionsArray => conditionsArray.join(':');\nexport const NULL_VALUE = 'NV';\nexport const TRUE_VALUE = '1';\nexport const FALSE_VALUE = '0';\nexport const OPERATOR_EQUAL = 'EQ';\nexport const OPERATOR_GREATER = 'GT';\nexport const OPERATOR_GREATER_OR_EQUAL = 'GE';\nexport const OPERATOR_LESS = 'LT';\nexport const OPERATOR_LESS_OR_EQUAL = 'LE';\nexport const OPERATOR_NOT_EQUAL = '!EQ';\nexport const OPERATOR_EMPTY = \"EQ:\".concat(NULL_VALUE);\nexport const OPERATOR_NOT_EMPTY = \"NE:\".concat(NULL_VALUE);\nexport const OPERATOR_IN = 'IN';\nexport const OPERATOR_CONTAINS = 'LIKE';\nexport const OPERATOR_NOT_CONTAINS = '!LIKE';\nexport const CASE_INSENSITIVE_PREFIX = 'I';\nexport const NOT_PREFIX = '!';\nexport const NUMERIC_OPERATORS = {\n  [OPERATOR_EQUAL]: i18n.t('equal to (=)'),\n  [OPERATOR_GREATER]: i18n.t('greater than (>)'),\n  [OPERATOR_GREATER_OR_EQUAL]: i18n.t('greater than or equal to (≥)'),\n  [OPERATOR_LESS]: i18n.t('less than (<)'),\n  [OPERATOR_LESS_OR_EQUAL]: i18n.t('less than or equal to (≤)'),\n  [OPERATOR_NOT_EQUAL]: i18n.t('not equal to (≠)'),\n  [OPERATOR_EMPTY]: i18n.t('is empty / null'),\n  [OPERATOR_NOT_EMPTY]: i18n.t('is not empty / not null')\n};\nexport const ALPHA_NUMERIC_OPERATORS = {\n  [OPERATOR_EQUAL]: i18n.t('exactly'),\n  [OPERATOR_NOT_EQUAL]: i18n.t('is not'),\n  [OPERATOR_CONTAINS]: i18n.t('contains'),\n  [OPERATOR_NOT_CONTAINS]: i18n.t('does not contain'),\n  [OPERATOR_EMPTY]: i18n.t('is empty / null'),\n  [OPERATOR_NOT_EMPTY]: i18n.t('is not empty / not null')\n};\nexport const DATE_OPERATORS = {\n  [OPERATOR_EQUAL]: i18n.t('exactly'),\n  [OPERATOR_NOT_EQUAL]: i18n.t('is not'),\n  [OPERATOR_GREATER]: i18n.t('after'),\n  [OPERATOR_GREATER_OR_EQUAL]: i18n.t('after or including'),\n  [OPERATOR_LESS]: i18n.t('before'),\n  [OPERATOR_LESS_OR_EQUAL]: i18n.t('before or including'),\n  [OPERATOR_EMPTY]: i18n.t('is empty / null'),\n  [OPERATOR_NOT_EMPTY]: i18n.t('is not empty / not null')\n};\nexport const BOOLEAN_VALUES = {\n  [TRUE_VALUE]: i18n.t('Yes'),\n  [FALSE_VALUE]: i18n.t('No'),\n  [NULL_VALUE]: i18n.t('Not answered')\n};\nexport const VALUE_TYPE_NUMBER = 'NUMBER';\nexport const VALUE_TYPE_UNIT_INTERVAL = 'UNIT_INTERVAL';\nexport const VALUE_TYPE_PERCENTAGE = 'PERCENTAGE';\nexport const VALUE_TYPE_INTEGER = 'INTEGER';\nexport const VALUE_TYPE_INTEGER_POSITIVE = 'INTEGER_POSITIVE';\nexport const VALUE_TYPE_INTEGER_NEGATIVE = 'INTEGER_NEGATIVE';\nexport const VALUE_TYPE_INTEGER_ZERO_OR_POSITIVE = 'INTEGER_ZERO_OR_POSITIVE';\nexport const VALUE_TYPE_TEXT = 'TEXT';\nexport const VALUE_TYPE_LONG_TEXT = 'LONG_TEXT';\nexport const VALUE_TYPE_LETTER = 'LETTER';\nexport const VALUE_TYPE_PHONE_NUMBER = 'PHONE_NUMBER';\nexport const VALUE_TYPE_EMAIL = 'EMAIL';\nexport const VALUE_TYPE_USERNAME = 'USERNAME';\nexport const VALUE_TYPE_URL = 'URL';\nexport const VALUE_TYPE_BOOLEAN = 'BOOLEAN';\nexport const VALUE_TYPE_TRUE_ONLY = 'TRUE_ONLY';\nexport const VALUE_TYPE_DATE = 'DATE';\nexport const VALUE_TYPE_TIME = 'TIME';\nexport const VALUE_TYPE_DATETIME = 'DATETIME';\nexport const VALUE_TYPE_ORGANISATION_UNIT = 'ORGANISATION_UNIT';\nexport const API_TIME_DIVIDER = '.';\nexport const UI_TIME_DIVIDER = ':';\nexport const API_DATETIME_DIVIDER = 'T';\nexport const UI_DATETIME_DIVIDER = ' ';\nexport const prefixOperator = (operator, isCaseSensitive) => {\n  if (isCaseSensitive) {\n    // e.g. LIKE -> LIKE\n    return operator;\n  } else {\n    if (operator[0] === NOT_PREFIX) {\n      // e.g. !LIKE -> !ILIKE\n      return \"\".concat(NOT_PREFIX).concat(CASE_INSENSITIVE_PREFIX).concat(operator.substring(1));\n    } else {\n      // e.g. LIKE -> ILIKE\n      return \"\".concat(CASE_INSENSITIVE_PREFIX).concat(operator);\n    }\n  }\n};\nexport const unprefixOperator = operator => {\n  const isCaseSensitive = checkIsCaseSensitive(operator);\n\n  if (isCaseSensitive) {\n    // e.g. LIKE -> LIKE, !LIKE -> !LIKE\n    return operator;\n  } else {\n    if (operator[0] === NOT_PREFIX) {\n      // e.g. !ILIKE -> !LIKE\n      return \"\".concat(NOT_PREFIX).concat(operator.substring(2));\n    } else {\n      // e.g. ILIKE -> LIKE\n      return \"\".concat(operator.substring(1));\n    }\n  }\n};\nexport const checkIsCaseSensitive = operator => {\n  if (operator[0] === NOT_PREFIX) {\n    // !LIKE, !ILIKE, !EQ, !IEQ\n    return operator[1] !== CASE_INSENSITIVE_PREFIX;\n  } else {\n    // LIKE, ILIKE, EQ, IEQ\n    return operator[0] !== CASE_INSENSITIVE_PREFIX;\n  }\n};\n\nconst getOperatorsByValueType = valueType => {\n  switch (valueType) {\n    case VALUE_TYPE_LETTER:\n    case VALUE_TYPE_TEXT:\n    case VALUE_TYPE_LONG_TEXT:\n    case VALUE_TYPE_EMAIL:\n    case VALUE_TYPE_USERNAME:\n    case VALUE_TYPE_URL:\n    case VALUE_TYPE_PHONE_NUMBER:\n      {\n        return ALPHA_NUMERIC_OPERATORS;\n      }\n\n    case VALUE_TYPE_DATE:\n    case VALUE_TYPE_TIME:\n    case VALUE_TYPE_DATETIME:\n      {\n        return DATE_OPERATORS;\n      }\n\n    case VALUE_TYPE_NUMBER:\n    case VALUE_TYPE_UNIT_INTERVAL:\n    case VALUE_TYPE_PERCENTAGE:\n    case VALUE_TYPE_INTEGER:\n    case VALUE_TYPE_INTEGER_POSITIVE:\n    case VALUE_TYPE_INTEGER_NEGATIVE:\n    case VALUE_TYPE_INTEGER_ZERO_OR_POSITIVE:\n    default:\n      {\n        return NUMERIC_OPERATORS;\n      }\n  }\n};\n\nconst parseCondition = conditionItem => conditionItem.split(':').pop().split(';');\n\nexport const getConditionsTexts = _ref => {\n  var _conditionsList$, _conditionsList$2, _conditionsList$3;\n\n  let {\n    conditions = {},\n    metadata = {},\n    dimension = {},\n    formatValueOptions = {}\n  } = _ref;\n  const conditionsList = parseConditionsStringToArray(conditions.condition);\n\n  if (conditions.legendSet) {\n    if (!(conditionsList !== null && conditionsList !== void 0 && conditionsList.length)) {\n      var _metadata$conditions$;\n\n      return [(_metadata$conditions$ = metadata[conditions.legendSet]) === null || _metadata$conditions$ === void 0 ? void 0 : _metadata$conditions$.name];\n    } else {\n      var _metadata$conditions$2;\n\n      const legends = parseCondition(conditionsList[0]);\n      const allLegends = ((_metadata$conditions$2 = metadata[conditions.legendSet]) === null || _metadata$conditions$2 === void 0 ? void 0 : _metadata$conditions$2.legends) || [];\n      const legendNames = legends.map(legend => {\n        var _allLegends$find;\n\n        return (_allLegends$find = allLegends.find(l => l.id === legend)) === null || _allLegends$find === void 0 ? void 0 : _allLegends$find.name;\n      });\n      return legendNames;\n    }\n  }\n\n  if (dimension.optionSet && (_conditionsList$ = conditionsList[0]) !== null && _conditionsList$ !== void 0 && _conditionsList$.startsWith(OPERATOR_IN)) {\n    const items = parseCondition(conditionsList[0]);\n    const itemNames = items.map(code => {\n      var _Object$values$find;\n\n      return (_Object$values$find = Object.values(metadata).find(item => item.code === code)) === null || _Object$values$find === void 0 ? void 0 : _Object$values$find.name;\n    });\n    return itemNames;\n  }\n\n  if ([VALUE_TYPE_BOOLEAN, VALUE_TYPE_TRUE_ONLY].includes(dimension.valueType) && (_conditionsList$2 = conditionsList[0]) !== null && _conditionsList$2 !== void 0 && _conditionsList$2.startsWith(OPERATOR_IN)) {\n    const values = parseCondition(conditionsList[0]);\n    const valueNames = values.map(value => BOOLEAN_VALUES[value]);\n    return valueNames;\n  }\n\n  if (dimension.valueType === VALUE_TYPE_ORGANISATION_UNIT && (_conditionsList$3 = conditionsList[0]) !== null && _conditionsList$3 !== void 0 && _conditionsList$3.startsWith(OPERATOR_EQUAL)) {\n    const ous = parseCondition(conditionsList[0]);\n    const ouNames = ous.map(ou => {\n      var _metadata$ou;\n\n      return (_metadata$ou = metadata[ou]) === null || _metadata$ou === void 0 ? void 0 : _metadata$ou.name;\n    });\n    return ouNames;\n  }\n\n  const operators = getOperatorsByValueType(dimension.valueType);\n  const parsedConditions = conditionsList.map(condition => {\n    let operator, value;\n\n    if (condition.includes(NULL_VALUE)) {\n      operator = condition;\n    } else {\n      const parts = condition.split(':');\n      const valueType = dimension.dimensionType === DIMENSION_TYPE_PROGRAM_INDICATOR ? VALUE_TYPE_NUMBER : dimension.valueType;\n      operator = unprefixOperator(parts[0]);\n      value = formatValue(parts[1], valueType, formatValueOptions);\n    }\n\n    if (value && [VALUE_TYPE_TIME, VALUE_TYPE_DATETIME].includes(dimension.valueType)) {\n      value = value.replaceAll(API_TIME_DIVIDER, UI_TIME_DIVIDER);\n    }\n\n    if (value && dimension.valueType === VALUE_TYPE_DATETIME) {\n      value = value.replaceAll(API_DATETIME_DIVIDER, UI_DATETIME_DIVIDER);\n    }\n\n    const operatorName = operators[operator];\n    const capitalCaseOperatorName = operatorName[0].toUpperCase() + operatorName.substring(1);\n    return value ? \"\".concat(capitalCaseOperatorName, \": \").concat(value) : capitalCaseOperatorName;\n  });\n  return parsedConditions;\n};","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport i18n from '@dhis2/d2-i18n';\nimport { Button } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nconst UpdateButton = _ref => {\n  let {\n    onClick,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(Button, _extends({}, props, {\n    onClick: onClick,\n    type: \"button\",\n    primary: true\n  }), i18n.t('Update'));\n};\n\nUpdateButton.propTypes = {\n  onClick: PropTypes.func.isRequired\n};\nexport default UpdateButton;","import { AXIS, dimensionIsValid, layoutGetDimension, VIS_TYPE_LINE_LIST, DIMENSION_ID_ORGUNIT } from '@dhis2/analytics';\nimport { DIMENSION_IDS_TIME } from './dimensionConstants.js';\nimport { noColumnsError, noOrgUnitError, noPeriodError, noProgramError } from './error.js'; // Layout validation helper functions\n\nconst isAxisValid = axis => AXIS.isValid(axis) && axis.some(axisItem => dimensionIsValid(axisItem, {\n  requireItems: false\n}));\n\nconst validateDimension = (dimension, error, requireItems) => {\n  if (!(dimension && dimensionIsValid(dimension, {\n    requireItems\n  }))) {\n    throw error;\n  }\n};\n\nconst validateAxis = (axis, error) => {\n  if (!isAxisValid(axis)) {\n    throw error;\n  }\n};\n\nconst validateLineListLayout = layout => {\n  var _layout$program;\n\n  validateAxis(layout.columns, noColumnsError());\n  validateDimension(layoutGetDimension(layout, DIMENSION_ID_ORGUNIT), noOrgUnitError(), true);\n  let layoutHasTimeDimension = false;\n  DIMENSION_IDS_TIME.forEach(dimensionId => {\n    const dimension = layoutGetDimension(layout, dimensionId);\n\n    if (dimension && dimensionIsValid(dimension, {\n      requireItems: true\n    })) {\n      layoutHasTimeDimension = true;\n    }\n  });\n\n  if (!layoutHasTimeDimension) {\n    throw noPeriodError();\n  }\n\n  if (!(layout !== null && layout !== void 0 && (_layout$program = layout.program) !== null && _layout$program !== void 0 && _layout$program.id)) {\n    throw noProgramError();\n  }\n};\n\nexport const validateLayout = layout => {\n  switch (layout.type) {\n    case VIS_TYPE_LINE_LIST:\n    default:\n      return validateLineListLayout(layout);\n  }\n};\nexport const layoutHasProgramId = layout => {\n  var _layout$program2;\n\n  if (!layout) {\n    return false;\n  }\n\n  switch (layout.type) {\n    case VIS_TYPE_LINE_LIST:\n    default:\n      return Boolean((_layout$program2 = layout.program) === null || _layout$program2 === void 0 ? void 0 : _layout$program2.id);\n  }\n};\nexport const aoCreatedInEventReportsApp = layout => layout.legacy;","import { useSelector, useDispatch } from 'react-redux';\nimport { tSetCurrentFromUi, acClearCurrent } from '../../actions/current.js';\nimport { acSetLoadError, acClearLoadError, acSetVisualizationLoading } from '../../actions/loader.js';\nimport { acSetShowExpandedLayoutPanel } from '../../actions/ui.js';\nimport { genericClientError } from '../../modules/error.js';\nimport { layoutHasProgramId, validateLayout } from '../../modules/layoutValidation.js';\nimport { sGetCurrentFromUi } from '../../reducers/current.js';\n\nconst UpdateVisualizationContainer = _ref => {\n  let {\n    renderComponent\n  } = _ref;\n  const dispatch = useDispatch();\n  const currentFromUi = useSelector(sGetCurrentFromUi);\n\n  const onClick = () => {\n    try {\n      validateLayout(currentFromUi);\n      dispatch(acClearLoadError());\n      dispatch(acSetVisualizationLoading(true));\n    } catch (error) {\n      dispatch(acSetLoadError(error || genericClientError()));\n    }\n\n    if (layoutHasProgramId(currentFromUi)) {\n      dispatch(tSetCurrentFromUi());\n    } else {\n      dispatch(acClearCurrent());\n    }\n\n    dispatch(acSetShowExpandedLayoutPanel(false));\n  };\n\n  return renderComponent(onClick);\n};\n\nexport default UpdateVisualizationContainer;","import { getAvailableAxes, getAxisNameByLayoutType, getLayoutTypeByVisType } from '@dhis2/analytics';\nimport i18n from '@dhis2/d2-i18n';\nimport { SplitButton, FlyoutMenu, MenuItem, Button } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { acAddUiLayoutDimensions } from '../../../actions/ui.js';\nimport { sGetUiActiveModalDialog, sGetUiType } from '../../../reducers/ui.js';\n\nconst AddToLayoutButton = _ref => {\n  let {\n    dialogId,\n    visType,\n    onAddDimension,\n    onClick,\n    dataTest\n  } = _ref;\n  const availableAxes = getAvailableAxes(visType);\n  const AddToLayoutButton = availableAxes.length > 1 ? SplitButton : Button;\n\n  const clickHandler = axisId => {\n    onAddDimension({\n      [dialogId]: {\n        axisId\n      }\n    });\n    onClick();\n  };\n\n  const renderMenu = () => /*#__PURE__*/React.createElement(FlyoutMenu, {\n    maxWidth: \"380px\",\n    dataTest: \"\".concat(dataTest, \"-flyout-menu\")\n  }, getAvailableAxes(visType).slice(1).map(axis => /*#__PURE__*/React.createElement(MenuItem, {\n    key: axis,\n    dataTest: \"\".concat(dataTest, \"-flyout-menu-option-\").concat(axis),\n    onClick: () => clickHandler(axis),\n    label: i18n.t(\"Add to {{axisName}}\", {\n      axisName: getAxisNameByLayoutType(axis, getLayoutTypeByVisType(visType))\n    })\n  })));\n\n  return /*#__PURE__*/React.createElement(AddToLayoutButton, {\n    component: availableAxes.length > 1 ? renderMenu() : null,\n    onClick: () => clickHandler(availableAxes[0]),\n    dataTest: dataTest\n  }, i18n.t(\"Add to {{axisName}}\", {\n    axisName: getAxisNameByLayoutType(availableAxes[0], getLayoutTypeByVisType(visType))\n  }));\n};\n\nAddToLayoutButton.propTypes = {\n  dialogId: PropTypes.string.isRequired,\n  visType: PropTypes.string.isRequired,\n  onAddDimension: PropTypes.func.isRequired,\n  onClick: PropTypes.func.isRequired,\n  dataTest: PropTypes.string\n};\n\nconst mapStateToProps = state => ({\n  visType: sGetUiType(state),\n  dialogId: sGetUiActiveModalDialog(state)\n});\n\nexport default connect(mapStateToProps, {\n  onAddDimension: acAddUiLayoutDimensions\n})(AddToLayoutButton);","import i18n from '@dhis2/d2-i18n';\nimport { Modal, ModalContent, ModalActions, ButtonStrip, ModalTitle, Button } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport UpdateButton from '../UpdateButton/UpdateButton.js';\nimport UpdateVisualizationContainer from '../UpdateButton/UpdateVisualizationContainer.js';\nimport AddToLayoutButton from './AddToLayoutButton/AddToLayoutButton.js';\nimport classes from './styles/DimensionModal.module.css';\n\nconst DimensionModal = _ref => {\n  let {\n    children,\n    dataTest,\n    isInLayout,\n    onClose,\n    title\n  } = _ref;\n\n  const onClick = handler => {\n    onClose();\n    handler();\n  };\n\n  return /*#__PURE__*/React.createElement(Modal, {\n    onClose: onClose,\n    dataTest: \"\".concat(dataTest),\n    position: \"top\",\n    large: true\n  }, /*#__PURE__*/React.createElement(ModalTitle, {\n    dataTest: \"\".concat(dataTest, \"-title}\")\n  }, title), /*#__PURE__*/React.createElement(ModalContent, {\n    dataTest: \"\".concat(dataTest, \"-content\"),\n    className: classes.modalContent\n  }, children), /*#__PURE__*/React.createElement(ModalActions, {\n    dataTest: \"\".concat(dataTest, \"-actions\")\n  }, /*#__PURE__*/React.createElement(ButtonStrip, null, /*#__PURE__*/React.createElement(Button, {\n    type: \"button\",\n    secondary: true,\n    onClick: onClose,\n    dataTest: \"\".concat(dataTest, \"-action-cancel\")\n  }, i18n.t('Hide')), isInLayout ? /*#__PURE__*/React.createElement(UpdateVisualizationContainer, {\n    renderComponent: handler => /*#__PURE__*/React.createElement(UpdateButton, {\n      onClick: () => onClick(handler),\n      dataTest: \"\".concat(dataTest, \"-action-confirm\")\n    })\n  }) : /*#__PURE__*/React.createElement(AddToLayoutButton, {\n    onClick: onClose,\n    dataTest: \"\".concat(dataTest, \"-action-confirm\")\n  }))));\n};\n\nDimensionModal.propTypes = {\n  onClose: PropTypes.func.isRequired,\n  children: PropTypes.node,\n  dataTest: PropTypes.string,\n  isInLayout: PropTypes.bool,\n  title: PropTypes.node\n};\nexport default DimensionModal;","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport i18n from '@dhis2/d2-i18n';\nimport { SingleSelectField, SingleSelectOption, Button, Input, Checkbox } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { useEffect } from 'react';\nimport { NULL_VALUE, CASE_INSENSITIVE_PREFIX, OPERATOR_NOT_EMPTY, OPERATOR_EMPTY, ALPHA_NUMERIC_OPERATORS, prefixOperator, unprefixOperator, checkIsCaseSensitive } from '../../../modules/conditions.js';\nimport classes from './styles/Condition.module.css';\n\nconst BaseCondition = _ref => {\n  let {\n    condition,\n    onChange,\n    onRemove,\n    allowCaseSensitive,\n    valueClassName\n  } = _ref;\n  let operator, value, isCaseSensitive;\n  useEffect(() => {\n    if (!(condition !== null && condition !== void 0 && condition.length)) {\n      onChange(\"\".concat(CASE_INSENSITIVE_PREFIX, \":\"));\n    }\n  }, [condition]);\n\n  if (condition.includes(NULL_VALUE)) {\n    operator = condition;\n  } else {\n    const parts = condition.split(':');\n    isCaseSensitive = checkIsCaseSensitive(parts[0]);\n    operator = unprefixOperator(parts[0]);\n    value = parts[1];\n  }\n\n  const setOperator = input => {\n    if (input.includes(NULL_VALUE)) {\n      onChange(\"\".concat(input));\n    } else {\n      onChange(\"\".concat(prefixOperator(input, isCaseSensitive), \":\").concat(value || ''));\n    }\n  };\n\n  const setValue = input => {\n    onChange(\"\".concat(prefixOperator(operator, isCaseSensitive), \":\").concat(input || ''));\n  };\n\n  const toggleCaseSensitive = cs => {\n    onChange(\"\".concat(prefixOperator(operator, cs), \":\").concat(value || ''));\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.container\n  }, /*#__PURE__*/React.createElement(SingleSelectField, {\n    selected: operator,\n    placeholder: i18n.t('Choose a condition type'),\n    dense: true,\n    onChange: _ref2 => {\n      let {\n        selected\n      } = _ref2;\n      return setOperator(selected);\n    },\n    className: classes.operatorSelect\n  }, Object.entries(ALPHA_NUMERIC_OPERATORS).map(_ref3 => {\n    let [key, value] = _ref3;\n    return /*#__PURE__*/React.createElement(SingleSelectOption, {\n      key: key,\n      value: key,\n      label: value\n    });\n  })), operator && !operator.includes(NULL_VALUE) && /*#__PURE__*/React.createElement(Input, {\n    value: value,\n    type: \"text\",\n    onChange: _ref4 => {\n      let {\n        value\n      } = _ref4;\n      return setValue(value);\n    },\n    className: valueClassName || classes.textInput,\n    dense: true\n  }), allowCaseSensitive && ![OPERATOR_EMPTY, OPERATOR_NOT_EMPTY].includes(operator) && /*#__PURE__*/React.createElement(Checkbox, {\n    checked: isCaseSensitive,\n    label: i18n.t('Case sensitive'),\n    onChange: _ref5 => {\n      let {\n        checked\n      } = _ref5;\n      return toggleCaseSensitive(checked);\n    },\n    dense: true,\n    className: classes.caseSensitiveCheckbox\n  }), /*#__PURE__*/React.createElement(Button, {\n    type: \"button\",\n    small: true,\n    secondary: true,\n    onClick: onRemove,\n    className: classes.removeButton\n  }, i18n.t('Remove')));\n};\n\nBaseCondition.propTypes = {\n  condition: PropTypes.string.isRequired,\n  onChange: PropTypes.func.isRequired,\n  onRemove: PropTypes.func.isRequired,\n  allowCaseSensitive: PropTypes.bool,\n  valueClassName: PropTypes.object\n};\nexport const PhoneNumberCondition = props => /*#__PURE__*/React.createElement(BaseCondition, _extends({\n  valueClassName: classes.phoneNumberInput\n}, props));\nexport const LetterCondition = props => /*#__PURE__*/React.createElement(BaseCondition, _extends({\n  valueClassName: classes.letterInput,\n  allowCaseSensitive: true\n}, props));\nexport const CaseSensitiveAlphanumericCondition = props => /*#__PURE__*/React.createElement(BaseCondition, _extends({\n  allowCaseSensitive: true\n}, props));","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport { Checkbox } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { OPERATOR_IN, NULL_VALUE, TRUE_VALUE, FALSE_VALUE, BOOLEAN_VALUES } from '../../../modules/conditions.js';\nimport classes from './styles/Condition.module.css';\n\nconst BaseCondition = _ref => {\n  let {\n    condition,\n    onChange,\n    showFalseOption\n  } = _ref;\n  const parts = condition.split(':');\n  const values = parts[1] || '';\n\n  const onCheckboxChange = (input, checked) => {\n    const currentValues = values.length ? values.split(';') : [];\n\n    if (checked) {\n      setValues([...currentValues, input].join(';'));\n    } else {\n      setValues(currentValues.filter(v => v !== input).join(';'));\n    }\n  };\n\n  const setValues = input => {\n    onChange(\"\".concat(OPERATOR_IN, \":\").concat(input || ''));\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.container\n  }, /*#__PURE__*/React.createElement(Checkbox, {\n    checked: values.includes(TRUE_VALUE),\n    label: BOOLEAN_VALUES[TRUE_VALUE],\n    onChange: _ref2 => {\n      let {\n        checked\n      } = _ref2;\n      return onCheckboxChange(TRUE_VALUE, checked);\n    },\n    dense: true,\n    className: classes.checkboxOption\n  }), showFalseOption && /*#__PURE__*/React.createElement(Checkbox, {\n    checked: values.includes(FALSE_VALUE),\n    label: BOOLEAN_VALUES[FALSE_VALUE],\n    onChange: _ref3 => {\n      let {\n        checked\n      } = _ref3;\n      return onCheckboxChange(FALSE_VALUE, checked);\n    },\n    dense: true,\n    className: classes.checkboxOption\n  }), /*#__PURE__*/React.createElement(Checkbox, {\n    checked: values.includes(NULL_VALUE),\n    label: BOOLEAN_VALUES[NULL_VALUE],\n    onChange: _ref4 => {\n      let {\n        checked\n      } = _ref4;\n      return onCheckboxChange(NULL_VALUE, checked);\n    },\n    dense: true,\n    className: classes.checkboxOption\n  }));\n};\n\nBaseCondition.propTypes = {\n  condition: PropTypes.string.isRequired,\n  onChange: PropTypes.func.isRequired,\n  showFalseOption: PropTypes.bool\n};\nexport const BooleanCondition = props => /*#__PURE__*/React.createElement(BaseCondition, _extends({\n  showFalseOption: true\n}, props));\nexport const TrueOnlyCondition = props => /*#__PURE__*/React.createElement(BaseCondition, props);","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport i18n from '@dhis2/d2-i18n';\nimport { SingleSelectField, SingleSelectOption, Button, Input } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { NULL_VALUE, DATE_OPERATORS, UI_TIME_DIVIDER, API_TIME_DIVIDER } from '../../../modules/conditions.js';\nimport classes from './styles/Condition.module.css';\nconst TYPE_DATE = 'date';\nconst TYPE_DATETIME = 'datetime-local';\nconst TYPE_TIME = 'time';\n\nconst BaseCondition = _ref => {\n  var _value;\n\n  let {\n    condition,\n    onChange,\n    onRemove,\n    type,\n    max\n  } = _ref;\n  let operator, value;\n\n  if (condition.includes(NULL_VALUE)) {\n    operator = condition;\n  } else {\n    const parts = condition.split(':');\n    operator = parts[0];\n    value = parts[1];\n  }\n\n  const setOperator = input => {\n    if (input.includes(NULL_VALUE)) {\n      onChange(\"\".concat(input));\n    } else {\n      onChange(\"\".concat(input, \":\").concat(value || ''));\n    }\n  };\n\n  const setValue = input => {\n    onChange(\"\".concat(operator, \":\").concat((input === null || input === void 0 ? void 0 : input.replaceAll(UI_TIME_DIVIDER, API_TIME_DIVIDER)) || ''));\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.container\n  }, /*#__PURE__*/React.createElement(SingleSelectField, {\n    selected: operator,\n    placeholder: i18n.t('Choose a condition type'),\n    dense: true,\n    onChange: _ref2 => {\n      let {\n        selected\n      } = _ref2;\n      return setOperator(selected);\n    },\n    className: classes.operatorSelect\n  }, Object.entries(DATE_OPERATORS).map(_ref3 => {\n    let [key, value] = _ref3;\n    return /*#__PURE__*/React.createElement(SingleSelectOption, {\n      key: key,\n      value: key,\n      label: value\n    });\n  })), operator && !operator.includes(NULL_VALUE) && /*#__PURE__*/React.createElement(Input, {\n    value: (_value = value) === null || _value === void 0 ? void 0 : _value.replaceAll(API_TIME_DIVIDER, UI_TIME_DIVIDER),\n    type: type,\n    onChange: _ref4 => {\n      let {\n        value\n      } = _ref4;\n      return setValue(value);\n    },\n    className: classes.dateInput,\n    max: max,\n    dense: true\n  }), /*#__PURE__*/React.createElement(Button, {\n    type: \"button\",\n    small: true,\n    secondary: true,\n    onClick: onRemove,\n    className: classes.removeButton\n  }, i18n.t('Remove')));\n};\n\nBaseCondition.propTypes = {\n  condition: PropTypes.string.isRequired,\n  type: PropTypes.string.isRequired,\n  onChange: PropTypes.func.isRequired,\n  onRemove: PropTypes.func.isRequired,\n  max: PropTypes.string\n};\nexport const DateCondition = props => /*#__PURE__*/React.createElement(BaseCondition, _extends({\n  type: TYPE_DATE,\n  max: \"9999-12-31\"\n}, props));\nexport const DateTimeCondition = props => /*#__PURE__*/React.createElement(BaseCondition, _extends({\n  type: TYPE_DATETIME,\n  max: \"9999-12-31T23:59:59\"\n}, props));\nexport const TimeCondition = props => /*#__PURE__*/React.createElement(BaseCondition, _extends({\n  type: TYPE_TIME\n}, props));","import { DIMENSION_TYPE_DATA_ELEMENT, DIMENSION_TYPE_PROGRAM_ATTRIBUTE, DIMENSION_TYPE_PROGRAM_INDICATOR } from '@dhis2/analytics';\nimport { extractDimensionIdParts } from '../modules/utils.js';\nconst dataElementsQuery = {\n  resource: 'dataElements',\n  id: _ref => {\n    let {\n      id\n    } = _ref;\n    return id;\n  },\n  params: {\n    fields: 'legendSets[id,name]'\n  }\n};\nconst trackedEntityAttributesQuery = {\n  resource: 'trackedEntityAttributes',\n  id: _ref2 => {\n    let {\n      id\n    } = _ref2;\n    return id;\n  },\n  params: {\n    fields: 'legendSets[id,name]'\n  }\n};\nconst programIndicatorsQuery = {\n  resource: 'programIndicators',\n  id: _ref3 => {\n    let {\n      id\n    } = _ref3;\n    return id;\n  },\n  params: {\n    fields: 'legendSets[id,name]'\n  }\n};\nconst legendSetsQuery = {\n  resource: 'legendSets',\n  id: _ref4 => {\n    let {\n      id\n    } = _ref4;\n    return id;\n  },\n  params: {\n    fields: ['id', 'displayName~rename(name)', 'legends[id,displayName~rename(name),startValue,endValue]'],\n    paging: 'false'\n  }\n};\nexport const apiFetchLegendSetById = async _ref5 => {\n  let {\n    dataEngine,\n    id\n  } = _ref5;\n  const response = await dataEngine.query({\n    legendSet: legendSetsQuery\n  }, {\n    variables: {\n      id\n    },\n    onError: error => console.log('Error: ', error)\n  });\n  return response.legendSet;\n};\nexport const apiFetchLegendSetsByDimension = async _ref6 => {\n  let {\n    dataEngine,\n    dimensionId,\n    dimensionType\n  } = _ref6;\n  let query;\n\n  switch (dimensionType) {\n    case DIMENSION_TYPE_DATA_ELEMENT:\n      query = dataElementsQuery;\n      break;\n\n    case DIMENSION_TYPE_PROGRAM_ATTRIBUTE:\n      query = trackedEntityAttributesQuery;\n      break;\n\n    case DIMENSION_TYPE_PROGRAM_INDICATOR:\n      query = programIndicatorsQuery;\n      break;\n\n    default:\n      throw new Error(\"\".concat(dimensionType, \" is not a valid dimension type\"));\n  }\n\n  const {\n    dimensionId: id\n  } = extractDimensionIdParts(dimensionId);\n  const response = await dataEngine.query({\n    legendSets: query\n  }, {\n    variables: {\n      id\n    },\n    onError: error => console.log('Error: ', error)\n  });\n  return response.legendSets.legendSets;\n};","import { useDataEngine } from '@dhis2/app-runtime';\nimport i18n from '@dhis2/d2-i18n';\nimport { SingleSelectField, SingleSelectOption, Button, Input, MultiSelectField, MultiSelectOption, MenuDivider } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { acAddMetadata } from '../../../actions/metadata.js';\nimport { apiFetchLegendSetById, apiFetchLegendSetsByDimension } from '../../../api/legendSets.js';\nimport { NUMERIC_OPERATORS, OPERATOR_IN } from '../../../modules/conditions.js';\nimport { sGetMetadataById } from '../../../reducers/metadata.js';\nimport classes from './styles/Condition.module.css';\nconst NULL_VALUE = 'NV';\n\nconst NumericCondition = _ref => {\n  var _legendSet$legends, _value, _legendSet$legends2;\n\n  let {\n    condition,\n    onChange,\n    onRemove,\n    legendSetId,\n    numberOfConditions,\n    onLegendSetChange,\n    enableDecimalSteps,\n    dimension\n  } = _ref;\n  let operator, value;\n  const dispatch = useDispatch();\n  const availableLegendSets = useSelector(state => {\n    var _sGetMetadataById;\n\n    return (_sGetMetadataById = sGetMetadataById(state, dimension.id)) === null || _sGetMetadataById === void 0 ? void 0 : _sGetMetadataById.legendSets;\n  });\n\n  const setAvailableLegendSets = legendSets => dispatch(acAddMetadata({\n    [dimension.id]: {\n      legendSets\n    }\n  }));\n\n  const legendSet = useSelector(state => sGetMetadataById(state, legendSetId));\n\n  const setLegendSet = input => dispatch(acAddMetadata({\n    [input.id]: input\n  }));\n\n  const dataEngine = useDataEngine();\n\n  const fetchLegendSets = async () => {\n    const result = await apiFetchLegendSetsByDimension({\n      dataEngine,\n      dimensionId: dimension.id,\n      dimensionType: dimension.dimensionType\n    });\n    setAvailableLegendSets(result);\n  };\n\n  useEffect(() => {\n    if (operator === OPERATOR_IN && !availableLegendSets) {\n      fetchLegendSets();\n    }\n  }, []);\n\n  if (condition.includes(NULL_VALUE)) {\n    operator = condition;\n  } else if (legendSetId && !condition) {\n    operator = OPERATOR_IN;\n  } else {\n    const parts = condition.split(':');\n    operator = parts[0];\n    value = parts[1];\n  }\n\n  const onOperatorChange = input => {\n    if (input === OPERATOR_IN && !availableLegendSets) {\n      fetchLegendSets();\n    }\n\n    setOperator(input);\n  };\n\n  const setOperator = input => {\n    if (input.includes(NULL_VALUE)) {\n      onChange(\"\".concat(input));\n    } else if (input === OPERATOR_IN || operator === OPERATOR_IN) {\n      onChange(\"\".concat(input, \":\"));\n    } else {\n      onChange(\"\".concat(input, \":\").concat(value || ''));\n    }\n\n    if (!input.includes(OPERATOR_IN) && legendSetId) {\n      onLegendSetChange();\n    }\n  };\n\n  useEffect(() => {\n    const fetchLegendSet = async () => {\n      const result = await apiFetchLegendSetById({\n        dataEngine,\n        id: legendSetId\n      });\n      setLegendSet(result);\n    };\n\n    if (legendSetId && !legendSet) {\n      fetchLegendSet();\n    }\n  }, [legendSetId]);\n\n  const setValue = input => onChange(\"\".concat(operator, \":\").concat(input || ''));\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.container\n  }, /*#__PURE__*/React.createElement(SingleSelectField, {\n    selected: operator,\n    placeholder: i18n.t('Choose a condition type'),\n    dense: true,\n    onChange: _ref2 => {\n      let {\n        selected\n      } = _ref2;\n      return onOperatorChange(selected);\n    },\n    className: classes.operatorSelect\n  }, Object.entries(NUMERIC_OPERATORS).map(_ref3 => {\n    let [key, value] = _ref3;\n    return /*#__PURE__*/React.createElement(SingleSelectOption, {\n      key: key,\n      value: key,\n      label: value\n    });\n  }), /*#__PURE__*/React.createElement(MenuDivider, {\n    dense: true\n  }), /*#__PURE__*/React.createElement(SingleSelectOption, {\n    key: OPERATOR_IN,\n    value: OPERATOR_IN,\n    label: i18n.t('is one of preset options'),\n    disabled: numberOfConditions > 1\n  })), operator && !operator.includes(NULL_VALUE) && operator !== OPERATOR_IN && /*#__PURE__*/React.createElement(Input, {\n    value: value,\n    type: \"number\",\n    onChange: _ref4 => {\n      let {\n        value\n      } = _ref4;\n      return setValue(value);\n    },\n    className: classes.numericInput,\n    dense: true,\n    step: enableDecimalSteps ? '0.1' : '1'\n  }), operator === OPERATOR_IN && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(SingleSelectField, {\n    selected: availableLegendSets && legendSetId,\n    className: classes.legendSetSelect,\n    placeholder: !availableLegendSets ? i18n.t('Loading...') : i18n.t('Choose a set of options'),\n    dense: true,\n    onChange: _ref5 => {\n      let {\n        selected\n      } = _ref5;\n      onLegendSetChange(selected);\n      setValue(null);\n    },\n    loading: !availableLegendSets,\n    empty: i18n.t('No preset option sets for this data item')\n  }, availableLegendSets === null || availableLegendSets === void 0 ? void 0 : availableLegendSets.map(item => /*#__PURE__*/React.createElement(SingleSelectOption, {\n    key: item.id,\n    value: item.id,\n    label: item.name\n  }))), legendSetId && /*#__PURE__*/React.createElement(MultiSelectField, {\n    placeholder: !legendSet ? i18n.t('Loading...') : i18n.t('Choose options'),\n    onChange: _ref6 => {\n      let {\n        selected\n      } = _ref6;\n      return setValue(selected.join(';'));\n    },\n    className: classes.legendSelect,\n    selected: (legendSet === null || legendSet === void 0 ? void 0 : (_legendSet$legends = legendSet.legends) === null || _legendSet$legends === void 0 ? void 0 : _legendSet$legends.length) && ((_value = value) === null || _value === void 0 ? void 0 : _value.length) && value.split(';') || [],\n    dense: true,\n    loading: !legendSet\n  }, (legendSet === null || legendSet === void 0 ? void 0 : (_legendSet$legends2 = legendSet.legends) === null || _legendSet$legends2 === void 0 ? void 0 : _legendSet$legends2.length) && legendSet.legends.sort((a, b) => a.startValue - b.startValue).map(legend => /*#__PURE__*/React.createElement(MultiSelectOption, {\n    key: legend.id,\n    value: legend.id,\n    label: legend.name\n  })))), /*#__PURE__*/React.createElement(Button, {\n    type: \"button\",\n    small: true,\n    secondary: true,\n    onClick: onRemove,\n    className: classes.removeButton\n  }, i18n.t('Remove')));\n};\n\nNumericCondition.propTypes = {\n  condition: PropTypes.string.isRequired,\n  numberOfConditions: PropTypes.number.isRequired,\n  onChange: PropTypes.func.isRequired,\n  onLegendSetChange: PropTypes.func.isRequired,\n  onRemove: PropTypes.func.isRequired,\n  dimension: PropTypes.shape({\n    dimensionType: PropTypes.string,\n    id: PropTypes.string\n  }),\n  enableDecimalSteps: PropTypes.bool,\n  legendSetId: PropTypes.string\n};\nexport default NumericCondition;","const optionsQuery = {\n  resource: 'options',\n  params: _ref => {\n    let {\n      optionSetId,\n      searchTerm,\n      page\n    } = _ref;\n    const filters = [\"optionSet.id:eq:\".concat(optionSetId)];\n\n    if (searchTerm) {\n      filters.push(\"name:ilike:\".concat(searchTerm));\n    }\n\n    return {\n      fields: 'code,name,id',\n      filter: filters,\n      paging: true,\n      page\n    };\n  }\n};\nexport const apiFetchOptions = async _ref2 => {\n  let {\n    dataEngine,\n    searchTerm,\n    optionSetId,\n    page\n  } = _ref2;\n  const optionsData = await dataEngine.query({\n    options: optionsQuery\n  }, {\n    variables: {\n      searchTerm,\n      optionSetId,\n      page\n    },\n    onError: error => console.log('Error: ', error)\n  });\n  const response = optionsData.options;\n  return {\n    options: response.options,\n    nextPage: response.pager.nextPage ? response.pager.page + 1 : null\n  };\n};","import i18n from '@dhis2/d2-i18n';\nimport React from 'react';\nimport classes from '../styles/Common.module.css';\nexport const TransferEmptySelection = () => /*#__PURE__*/React.createElement(\"p\", {\n  className: classes.transferEmptyList\n}, i18n.t('No items selected'));","import i18n from '@dhis2/d2-i18n';\nimport { InputField } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport classes from '../styles/Common.module.css';\nexport const TransferLeftHeader = _ref => {\n  let {\n    searchTerm,\n    setSearchTerm,\n    dataTest\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.transferLeftHeader\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    className: classes.transferLeftTitle\n  }, i18n.t('Available options')), /*#__PURE__*/React.createElement(InputField, {\n    value: searchTerm,\n    onChange: _ref2 => {\n      let {\n        value\n      } = _ref2;\n      return setSearchTerm(value);\n    },\n    placeholder: i18n.t('Filter options'),\n    dataTest: \"\".concat(dataTest, \"-filter-input-field\"),\n    dense: true,\n    initialFocus: true,\n    type: 'search'\n  }));\n};\nTransferLeftHeader.propTypes = {\n  dataTest: PropTypes.string,\n  searchTerm: PropTypes.string,\n  setSearchTerm: PropTypes.func\n};","import i18n from '@dhis2/d2-i18n';\nimport React from 'react';\nimport classes from '../styles/Common.module.css';\nexport const TransferRightHeader = () => /*#__PURE__*/React.createElement(\"p\", {\n  className: classes.transferRightHeader\n}, i18n.t('Selected options'));","import i18n from '@dhis2/d2-i18n';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport classes from '../styles/Common.module.css';\nexport const TransferSourceEmptyPlaceholder = _ref => {\n  let {\n    loading,\n    searchTerm,\n    options,\n    dataTest\n  } = _ref;\n  return !loading && !options.length && /*#__PURE__*/React.createElement(\"p\", {\n    className: classes.transferEmptyList,\n    \"data-test\": dataTest\n  }, searchTerm ? i18n.t('Nothing found for \"{{- searchTerm}}\"', {\n    searchTerm: searchTerm\n  }) : i18n.t('No options'));\n};\nTransferSourceEmptyPlaceholder.propTypes = {\n  dataTest: PropTypes.string,\n  loading: PropTypes.bool,\n  options: PropTypes.array,\n  searchTerm: PropTypes.string\n};","export const TRANSFER_OPTIONS_WIDTH = '359px';\nexport const TRANSFER_SELECTED_WIDTH = '359px';\nexport const TRANSFER_HEIGHT = '512px';","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport { useDataEngine } from '@dhis2/app-runtime';\nimport { Transfer, TransferOption } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { useState } from 'react';\nimport { connect } from 'react-redux';\nimport { acAddMetadata } from '../../../actions/metadata.js';\nimport { apiFetchOptions } from '../../../api/options.js';\nimport { OPERATOR_IN } from '../../../modules/conditions.js';\nimport { useDebounce, useDidUpdateEffect } from '../../../modules/utils.js';\nimport { sGetMetadata } from '../../../reducers/metadata.js';\nimport { TransferEmptySelection } from '../common/TransferEmptySelection.js';\nimport { TransferLeftHeader } from '../common/TransferLeftHeader.js';\nimport { TransferRightHeader } from '../common/TransferRightHeader.js';\nimport { TransferSourceEmptyPlaceholder } from '../common/TransferSourceEmptyPlaceholder.js';\nimport { TRANSFER_HEIGHT, TRANSFER_OPTIONS_WIDTH, TRANSFER_SELECTED_WIDTH } from '../utils.js';\n\nconst OptionSetCondition = _ref => {\n  var _parts$;\n\n  let {\n    condition,\n    optionSetId,\n    onChange,\n    metadata,\n    addMetadata\n  } = _ref;\n  const parts = condition.split(':');\n  const values = (_parts$ = parts[1]) !== null && _parts$ !== void 0 && _parts$.length ? parts[1].split(';') : [];\n  const selectedOptions = values.map(code => {\n    var _Object$values$find;\n\n    return {\n      code,\n      name: ((_Object$values$find = Object.values(metadata).find(item => item.code === code)) === null || _Object$values$find === void 0 ? void 0 : _Object$values$find.name) || code\n    };\n  });\n  const dataTest = 'option-set';\n\n  const setValues = selected => {\n    addMetadata(state.options.filter(item => selected.includes(item.code) && !selectedOptions.find(so => so.code === item.code)).reduce((acc, item) => ({ ...acc,\n      [item.id]: item\n    }), {}));\n    onChange(\"\".concat(OPERATOR_IN, \":\").concat(selected.join(';') || ''));\n  };\n\n  const [state, setState] = useState({\n    searchTerm: '',\n    options: [],\n    loading: true,\n    nextPage: 1\n  });\n  const dataEngine = useDataEngine();\n\n  const setSearchTerm = searchTerm => setState(state => ({ ...state,\n    searchTerm\n  }));\n\n  const debouncedSearchTerm = useDebounce(state.searchTerm);\n\n  const fetchItems = async page => {\n    var _result$options;\n\n    setState(state => ({ ...state,\n      loading: true\n    }));\n    const result = await apiFetchOptions({\n      dataEngine,\n      page,\n      optionSetId,\n      searchTerm: state.searchTerm\n    });\n    const newOptions = [];\n    (_result$options = result.options) === null || _result$options === void 0 ? void 0 : _result$options.forEach(item => {\n      newOptions.push({\n        name: item.name,\n        code: item.code,\n        id: item.id\n      });\n    });\n    setState(state => ({ ...state,\n      loading: false,\n      options: page > 1 ? [...state.options, ...newOptions] : newOptions,\n      nextPage: result.nextPage\n    }));\n    /*  The following handles a very specific edge-case where the user can select all items from a \n        page and then reopen the modal. Usually Transfer triggers the onEndReached when the end of \n        the page is reached (scrolling down) or if too few items are on the left side (e.g. selecting \n        49 items from page 1, leaving only 1 item on the left side). However, due to the way Transfer \n        works, if 0 items are available, more items are fetched, but all items are already selected \n        (leaving 0 items on the left side still), the onReachedEnd won't trigger. Hence the code below:\n        IF there is a next page AND some options were just fetched AND you have the same or more\n        selected items than fetched items AND all fetched items are already selected -> fetch more!\n    */\n\n    if (result.nextPage && newOptions.length && selectedOptions.length >= newOptions.length && newOptions.every(newOption => selectedOptions.find(selectedItem => selectedItem.code === newOption.code))) {\n      fetchItems(result.nextPage);\n    }\n  };\n\n  useDidUpdateEffect(() => {\n    setState(state => ({ ...state,\n      loading: true,\n      nextPage: 1\n    }));\n    fetchItems(1);\n  }, [debouncedSearchTerm, state.filter]);\n\n  const onEndReached = () => {\n    if (state.nextPage) {\n      fetchItems(state.nextPage);\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(Transfer, {\n    onChange: _ref2 => {\n      let {\n        selected\n      } = _ref2;\n      return setValues(selected);\n    },\n    selected: selectedOptions.map(option => option.code),\n    options: [...state.options, ...selectedOptions].map(option => ({\n      value: option.code,\n      label: option.name\n    })),\n    loading: state.loading,\n    loadingPicked: state.loading,\n    sourceEmptyPlaceholder: /*#__PURE__*/React.createElement(TransferSourceEmptyPlaceholder, {\n      loading: state.loading,\n      searchTerm: debouncedSearchTerm,\n      options: state.options,\n      dataTest: \"\".concat(dataTest, \"-empty-source\")\n    }),\n    onEndReached: onEndReached,\n    leftHeader: /*#__PURE__*/React.createElement(TransferLeftHeader, {\n      searchTerm: state.searchTerm,\n      setSearchTerm: setSearchTerm,\n      dataTest: \"\".concat(dataTest, \"-left-header\")\n    }),\n    height: TRANSFER_HEIGHT,\n    optionsWidth: TRANSFER_OPTIONS_WIDTH,\n    selectedWidth: TRANSFER_SELECTED_WIDTH,\n    selectedEmptyComponent: /*#__PURE__*/React.createElement(TransferEmptySelection, null),\n    rightHeader: /*#__PURE__*/React.createElement(TransferRightHeader, null),\n    renderOption: props => /*#__PURE__*/React.createElement(TransferOption, _extends({}, props, {\n      dataTest: \"\".concat(dataTest, \"-transfer-option\")\n    })),\n    dataTest: \"\".concat(dataTest, \"-transfer\")\n  });\n};\n\nOptionSetCondition.propTypes = {\n  addMetadata: PropTypes.func.isRequired,\n  condition: PropTypes.string.isRequired,\n  metadata: PropTypes.object.isRequired,\n  optionSetId: PropTypes.string.isRequired,\n  onChange: PropTypes.func.isRequired\n};\n\nconst mapStateToProps = state => ({\n  metadata: sGetMetadata(state)\n});\n\nexport default connect(mapStateToProps, {\n  addMetadata: acAddMetadata\n})(OptionSetCondition);","import { useCachedDataQuery } from '@dhis2/analytics';\nimport { OrganisationUnitTree } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { acAddMetadata } from '../../../actions/metadata.js';\nimport { acAddParentGraphMap } from '../../../actions/ui.js';\nimport { OPERATOR_EQUAL } from '../../../modules/conditions.js';\nimport { getOuPath, removeLastPathSegment } from '../../../modules/orgUnit.js';\nimport { sGetMetadata } from '../../../reducers/metadata.js';\nimport { sGetUiParentGraphMap } from '../../../reducers/ui.js';\n\nconst OrgUnitCondition = _ref => {\n  var _parts$, _selected$path;\n\n  let {\n    addMetadata,\n    addParentGraphMap,\n    condition,\n    onChange,\n    metadata,\n    parentGraphMap\n  } = _ref;\n  const {\n    rootOrgUnits\n  } = useCachedDataQuery();\n  const parts = condition.split(':');\n  const value = ((_parts$ = parts[1]) === null || _parts$ === void 0 ? void 0 : _parts$.length) && parts[1];\n\n  const setValues = item => {\n    if (item.checked) {\n      const forMetadata = {};\n      const forParentGraphMap = {};\n      forMetadata[item.id] = {\n        id: item.id,\n        name: item.name || item.displayName,\n        displayName: item.displayName\n      };\n\n      if (item.path) {\n        const path = removeLastPathSegment(item.path);\n        forParentGraphMap[item.id] = path === \"/\".concat(item.id) ? '' : path.replace(/^\\//, '');\n      }\n\n      addMetadata(forMetadata);\n      addParentGraphMap(forParentGraphMap);\n      onChange(\"\".concat(OPERATOR_EQUAL, \":\").concat(item.id));\n    } else {\n      onChange('');\n    }\n  };\n\n  const selected = value ? {\n    id: value,\n    name: metadata[value].displayName || metadata[value].name,\n    path: getOuPath(value, metadata, parentGraphMap)\n  } : {};\n  const roots = rootOrgUnits.map(rootOrgUnit => rootOrgUnit.id);\n  return /*#__PURE__*/React.createElement(OrganisationUnitTree, {\n    roots: roots,\n    initiallyExpanded: [...(roots.length === 1 ? [\"/\".concat(roots[0])] : []), selected === null || selected === void 0 ? void 0 : (_selected$path = selected.path) === null || _selected$path === void 0 ? void 0 : _selected$path.substring(0, selected.path.lastIndexOf('/'))].filter(path => path),\n    selected: selected.path && [selected.path],\n    onChange: item => setValues(item),\n    dataTest: 'org-unit-tree',\n    singleSelection: true\n  });\n};\n\nOrgUnitCondition.propTypes = {\n  condition: PropTypes.string.isRequired,\n  onChange: PropTypes.func.isRequired,\n  addMetadata: PropTypes.func,\n  addParentGraphMap: PropTypes.func,\n  metadata: PropTypes.object,\n  parentGraphMap: PropTypes.object\n};\nOrgUnitCondition.defaultProps = {\n  rootOrgUnits: []\n};\n\nconst mapStateToProps = state => ({\n  metadata: sGetMetadata(state),\n  parentGraphMap: sGetUiParentGraphMap(state)\n});\n\nexport default connect(mapStateToProps, {\n  addMetadata: acAddMetadata,\n  addParentGraphMap: acAddParentGraphMap\n})(OrgUnitCondition);","import i18n from '@dhis2/d2-i18n';\nimport { Input } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { useState, useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { acRemoveUiRepetition, acSetUiRepetition } from '../../../actions/ui.js';\nimport { getDefaultUiRepetition, PROP_MOST_RECENT, PROP_OLDEST } from '../../../modules/ui.js';\nimport { sGetUiRepetitionByDimension } from '../../../reducers/ui.js';\nimport commonClasses from '../styles/Common.module.css';\nimport classes from './styles/ConditionsManager.module.css';\n\nconst isDefaultRepetition = repetition => {\n  const {\n    [PROP_MOST_RECENT]: defaultMostRecent,\n    [PROP_OLDEST]: defaultOldest\n  } = getDefaultUiRepetition();\n  return (repetition === null || repetition === void 0 ? void 0 : repetition[PROP_MOST_RECENT]) === defaultMostRecent && (repetition === null || repetition === void 0 ? void 0 : repetition[PROP_OLDEST]) === defaultOldest;\n};\n\nconst RepeatableEvents = _ref => {\n  let {\n    dimensionId\n  } = _ref;\n  const dispatch = useDispatch();\n  const sRepetition = useSelector(state => sGetUiRepetitionByDimension(state, dimensionId));\n  const [repetition, setRepetition] = useState(sRepetition && !isDefaultRepetition(isDefaultRepetition) ? sRepetition : getDefaultUiRepetition());\n  useEffect(() => {\n    if (isDefaultRepetition(repetition)) {\n      dispatch(acRemoveUiRepetition(dimensionId));\n    } else {\n      dispatch(acSetUiRepetition({\n        dimensionId,\n        repetition\n      }));\n    }\n  }, [repetition]);\n  const {\n    [PROP_MOST_RECENT]: mostRecent,\n    [PROP_OLDEST]: oldest\n  } = repetition;\n\n  const parseInput = value => {\n    const parsedValue = parseInt(value, 10);\n    return parsedValue > 0 ? parsedValue : 0;\n  };\n\n  const onMostRecentChange = value => {\n    setRepetition({\n      [PROP_MOST_RECENT]: parseInput(value),\n      [PROP_OLDEST]: oldest\n    });\n  };\n\n  const onOldestChange = value => {\n    setRepetition({\n      [PROP_OLDEST]: parseInput(value),\n      [PROP_MOST_RECENT]: mostRecent\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", null, /*#__PURE__*/React.createElement(\"p\", {\n    className: commonClasses.paragraph\n  }, i18n.t('From stages with repeatable events, show values for this data element from:', {\n    nsSeparator: '^^'\n  })), /*#__PURE__*/React.createElement(\"div\", null, /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.repeatableWrapper\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    className: commonClasses.paragraph\n  }, i18n.t('Most recent events:', {\n    keySeparator: '>',\n    nsSeparator: '^^'\n  })), /*#__PURE__*/React.createElement(Input, {\n    type: \"number\",\n    dense: true,\n    className: classes.repeatableInput,\n    value: mostRecent.toString(),\n    onChange: _ref2 => {\n      let {\n        value\n      } = _ref2;\n      return onMostRecentChange(value);\n    },\n    min: \"0\"\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.repeatableWrapper\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    className: commonClasses.paragraph\n  }, i18n.t('Oldest events:', {\n    keySeparator: '>',\n    nsSeparator: '^^'\n  })), /*#__PURE__*/React.createElement(Input, {\n    type: \"number\",\n    dense: true,\n    className: classes.repeatableInput,\n    value: oldest.toString(),\n    onChange: _ref3 => {\n      let {\n        value\n      } = _ref3;\n      return onOldestChange(value);\n    },\n    min: \"0\"\n  }))));\n};\n\nRepeatableEvents.propTypes = {\n  dimensionId: PropTypes.string.isRequired\n};\nexport default RepeatableEvents;","import { DIMENSION_TYPE_DATA_ELEMENT, DIMENSION_TYPE_PROGRAM_INDICATOR } from '@dhis2/analytics';\nimport i18n from '@dhis2/d2-i18n';\nimport { Button, IconInfo16, Tooltip, TabBar, Tab } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { useState } from 'react';\nimport { connect } from 'react-redux';\nimport { acSetUiConditions } from '../../../actions/ui.js';\nimport { OPERATOR_IN, parseConditionsArrayToString, parseConditionsStringToArray, VALUE_TYPE_NUMBER, VALUE_TYPE_UNIT_INTERVAL, VALUE_TYPE_PERCENTAGE, VALUE_TYPE_INTEGER, VALUE_TYPE_INTEGER_POSITIVE, VALUE_TYPE_INTEGER_NEGATIVE, VALUE_TYPE_INTEGER_ZERO_OR_POSITIVE, VALUE_TYPE_TEXT, VALUE_TYPE_LONG_TEXT, VALUE_TYPE_LETTER, VALUE_TYPE_PHONE_NUMBER, VALUE_TYPE_EMAIL, VALUE_TYPE_USERNAME, VALUE_TYPE_URL, VALUE_TYPE_BOOLEAN, VALUE_TYPE_TRUE_ONLY, VALUE_TYPE_DATE, VALUE_TYPE_TIME, VALUE_TYPE_DATETIME, VALUE_TYPE_ORGANISATION_UNIT } from '../../../modules/conditions.js';\nimport { OUTPUT_TYPE_ENROLLMENT } from '../../../modules/visualization.js';\nimport { sGetMetadataById } from '../../../reducers/metadata.js';\nimport { sGetDimensionIdsFromLayout, sGetUiConditionsByDimension, sGetUiInputType } from '../../../reducers/ui.js';\nimport DimensionModal from '../DimensionModal.js';\nimport commonClasses from '../styles/Common.module.css';\nimport { PhoneNumberCondition, CaseSensitiveAlphanumericCondition, LetterCondition } from './AlphanumericCondition.js';\nimport { BooleanCondition, TrueOnlyCondition } from './BooleanCondition.js';\nimport { DateCondition, DateTimeCondition, TimeCondition } from './DateCondition.js';\nimport NumericCondition from './NumericCondition.js';\nimport OptionSetCondition from './OptionSetCondition.js';\nimport OrgUnitCondition from './OrgUnitCondition.js';\nimport RepeatableEvents from './RepeatableEvents.js';\nimport classes from './styles/ConditionsManager.module.css';\nconst TAB_CONDITIONS = 'CONDITIONS';\nconst TAB_REPEATABLE_EVENTS = 'REPEATABLE_EVENTS';\nconst NUMERIC_TYPES = [VALUE_TYPE_NUMBER, VALUE_TYPE_UNIT_INTERVAL, VALUE_TYPE_PERCENTAGE, VALUE_TYPE_INTEGER, VALUE_TYPE_INTEGER_POSITIVE, VALUE_TYPE_INTEGER_NEGATIVE, VALUE_TYPE_INTEGER_ZERO_OR_POSITIVE];\nconst SINGLETON_TYPES = [VALUE_TYPE_BOOLEAN, VALUE_TYPE_TRUE_ONLY, VALUE_TYPE_ORGANISATION_UNIT];\nconst SUPPORTED_TYPES = [VALUE_TYPE_NUMBER, VALUE_TYPE_UNIT_INTERVAL, VALUE_TYPE_PERCENTAGE, VALUE_TYPE_INTEGER, VALUE_TYPE_INTEGER_POSITIVE, VALUE_TYPE_INTEGER_NEGATIVE, VALUE_TYPE_INTEGER_ZERO_OR_POSITIVE, VALUE_TYPE_TEXT, VALUE_TYPE_LONG_TEXT, VALUE_TYPE_LETTER, VALUE_TYPE_PHONE_NUMBER, VALUE_TYPE_EMAIL, VALUE_TYPE_USERNAME, VALUE_TYPE_URL, VALUE_TYPE_BOOLEAN, VALUE_TYPE_TRUE_ONLY, VALUE_TYPE_DATE, VALUE_TYPE_TIME, VALUE_TYPE_DATETIME, VALUE_TYPE_ORGANISATION_UNIT];\nconst EMPTY_CONDITION = '';\n\nconst ConditionsManager = _ref => {\n  let {\n    conditions,\n    inputType,\n    isInLayout,\n    dimension,\n    stage,\n    onClose,\n    setConditionsByDimension\n  } = _ref;\n  const [currentTab, setCurrentTab] = useState(TAB_CONDITIONS);\n  const valueType = dimension.valueType;\n  const isProgramIndicator = dimension.dimensionType === DIMENSION_TYPE_PROGRAM_INDICATOR;\n  const isOptionSetCondition = dimension.optionSet;\n  const canHaveLegendSets = NUMERIC_TYPES.includes(valueType) || isProgramIndicator;\n  const isSupported = SUPPORTED_TYPES.includes(valueType) || isProgramIndicator;\n\n  const getInitConditions = () => {\n    var _conditions$condition;\n\n    return (_conditions$condition = conditions.condition) !== null && _conditions$condition !== void 0 && _conditions$condition.length ? parseConditionsStringToArray(conditions.condition) : null;\n  };\n\n  const getEmptyConditions = () => SINGLETON_TYPES.includes(valueType) || isOptionSetCondition || conditions.legendSet ? [EMPTY_CONDITION] : [];\n\n  const [conditionsList, setConditionsList] = useState(getInitConditions() || getEmptyConditions());\n  const [selectedLegendSet, setSelectedLegendSet] = useState(conditions.legendSet);\n\n  const addCondition = () => setConditionsList([...conditionsList, EMPTY_CONDITION]);\n\n  const removeCondition = conditionIndex => {\n    const filteredConditionsList = conditionsList.filter((_, index) => index !== conditionIndex);\n    setConditionsList(filteredConditionsList);\n\n    if (selectedLegendSet && !filteredConditionsList.some(condition => condition.includes(OPERATOR_IN))) {\n      setSelectedLegendSet(null);\n    }\n  };\n\n  const setCondition = (conditionIndex, value) => setConditionsList(conditionsList.map((condition, index) => index === conditionIndex ? value : condition));\n\n  const storeConditions = () => setConditionsByDimension({\n    inputCondition: parseConditionsArrayToString(conditionsList.filter(cnd => cnd.length && cnd.slice(-1) !== ':')),\n    dimension: dimension.id,\n    legendSet: selectedLegendSet\n  });\n\n  const closeModal = () => {\n    storeConditions();\n    onClose();\n  };\n\n  const renderConditionsContent = () => {\n    const getDividerContent = index => conditionsList.length > 1 && index < conditionsList.length - 1 && /*#__PURE__*/React.createElement(\"span\", {\n      className: classes.separator\n    }, i18n.t('and'));\n\n    if (isOptionSetCondition) {\n      return conditionsList.map((condition, index) => /*#__PURE__*/React.createElement(\"div\", {\n        key: index\n      }, /*#__PURE__*/React.createElement(OptionSetCondition, {\n        condition: condition,\n        optionSetId: dimension.optionSet,\n        onChange: value => setCondition(index, value)\n      })));\n    }\n\n    const renderNumericCondition = () => {\n      const enableDecimalSteps = valueType === VALUE_TYPE_UNIT_INTERVAL;\n      return (conditionsList.length && conditionsList || selectedLegendSet && ['']).map((condition, index) => /*#__PURE__*/React.createElement(\"div\", {\n        key: index\n      }, /*#__PURE__*/React.createElement(NumericCondition, {\n        condition: condition,\n        onChange: value => setCondition(index, value),\n        onRemove: () => removeCondition(index),\n        numberOfConditions: conditionsList.length || (selectedLegendSet ? 1 : 0),\n        legendSetId: selectedLegendSet,\n        onLegendSetChange: value => setSelectedLegendSet(value),\n        enableDecimalSteps: enableDecimalSteps,\n        dimension: dimension\n      }), getDividerContent(index)));\n    };\n\n    if (isProgramIndicator) {\n      return renderNumericCondition();\n    }\n\n    switch (valueType) {\n      case VALUE_TYPE_NUMBER:\n      case VALUE_TYPE_UNIT_INTERVAL:\n      case VALUE_TYPE_PERCENTAGE:\n      case VALUE_TYPE_INTEGER:\n      case VALUE_TYPE_INTEGER_POSITIVE:\n      case VALUE_TYPE_INTEGER_NEGATIVE:\n      case VALUE_TYPE_INTEGER_ZERO_OR_POSITIVE:\n        {\n          return renderNumericCondition();\n        }\n\n      case VALUE_TYPE_PHONE_NUMBER:\n        {\n          return conditionsList.map((condition, index) => /*#__PURE__*/React.createElement(\"div\", {\n            key: index\n          }, /*#__PURE__*/React.createElement(PhoneNumberCondition, {\n            condition: condition,\n            onChange: value => setCondition(index, value),\n            onRemove: () => removeCondition(index)\n          }), getDividerContent(index)));\n        }\n\n      case VALUE_TYPE_LETTER:\n        {\n          return conditionsList.map((condition, index) => /*#__PURE__*/React.createElement(\"div\", {\n            key: index\n          }, /*#__PURE__*/React.createElement(LetterCondition, {\n            condition: condition,\n            onChange: value => setCondition(index, value),\n            onRemove: () => removeCondition(index)\n          }), getDividerContent(index)));\n        }\n\n      case VALUE_TYPE_TEXT:\n      case VALUE_TYPE_LONG_TEXT:\n      case VALUE_TYPE_EMAIL:\n      case VALUE_TYPE_USERNAME:\n      case VALUE_TYPE_URL:\n        {\n          return conditionsList.map((condition, index) => /*#__PURE__*/React.createElement(\"div\", {\n            key: index\n          }, /*#__PURE__*/React.createElement(CaseSensitiveAlphanumericCondition, {\n            condition: condition,\n            onChange: value => setCondition(index, value),\n            onRemove: () => removeCondition(index)\n          }), getDividerContent(index)));\n        }\n\n      case VALUE_TYPE_BOOLEAN:\n        {\n          return conditionsList.map((condition, index) => /*#__PURE__*/React.createElement(\"div\", {\n            key: index\n          }, /*#__PURE__*/React.createElement(BooleanCondition, {\n            condition: condition,\n            onChange: value => setCondition(index, value)\n          })));\n        }\n\n      case VALUE_TYPE_TRUE_ONLY:\n        {\n          return conditionsList.map((condition, index) => /*#__PURE__*/React.createElement(\"div\", {\n            key: index\n          }, /*#__PURE__*/React.createElement(TrueOnlyCondition, {\n            condition: condition,\n            onChange: value => setCondition(index, value)\n          })));\n        }\n\n      case VALUE_TYPE_DATE:\n        {\n          return conditionsList.map((condition, index) => /*#__PURE__*/React.createElement(\"div\", {\n            key: index\n          }, /*#__PURE__*/React.createElement(DateCondition, {\n            condition: condition,\n            onChange: value => setCondition(index, value),\n            onRemove: () => removeCondition(index)\n          }), getDividerContent(index)));\n        }\n\n      case VALUE_TYPE_TIME:\n        {\n          return conditionsList.map((condition, index) => /*#__PURE__*/React.createElement(\"div\", {\n            key: index\n          }, /*#__PURE__*/React.createElement(TimeCondition, {\n            condition: condition,\n            onChange: value => setCondition(index, value),\n            onRemove: () => removeCondition(index)\n          }), getDividerContent(index)));\n        }\n\n      case VALUE_TYPE_DATETIME:\n        {\n          return conditionsList.map((condition, index) => /*#__PURE__*/React.createElement(\"div\", {\n            key: index\n          }, /*#__PURE__*/React.createElement(DateTimeCondition, {\n            condition: condition,\n            onChange: value => setCondition(index, value),\n            onRemove: () => removeCondition(index)\n          }), getDividerContent(index)));\n        }\n\n      case VALUE_TYPE_ORGANISATION_UNIT:\n        {\n          return conditionsList.map((condition, index) => /*#__PURE__*/React.createElement(\"div\", {\n            key: index\n          }, /*#__PURE__*/React.createElement(OrgUnitCondition, {\n            condition: condition,\n            onChange: value => setCondition(index, value)\n          })));\n        }\n    }\n  };\n\n  const disableAddButton = canHaveLegendSets && (conditionsList.some(condition => condition.includes(OPERATOR_IN)) || selectedLegendSet);\n  const isRepeatable = inputType === OUTPUT_TYPE_ENROLLMENT && dimension.dimensionType === DIMENSION_TYPE_DATA_ELEMENT;\n\n  const renderConditions = () => /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", null, isSupported ? /*#__PURE__*/React.createElement(\"p\", {\n    className: commonClasses.paragraph\n  }, i18n.t('Show items that meet the following conditions for this data item:', {\n    nsSeparator: '^^'\n  })) : /*#__PURE__*/React.createElement(\"p\", {\n    className: commonClasses.paragraph\n  }, i18n.t(\"This dimension can't be filtered. All values will be shown.\"))), isSupported && /*#__PURE__*/React.createElement(\"div\", {\n    className: commonClasses.mainSection\n  }, !conditionsList.length && !selectedLegendSet && !(SINGLETON_TYPES.includes(valueType) || isOptionSetCondition) ? /*#__PURE__*/React.createElement(\"p\", {\n    className: commonClasses.paragraph\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: classes.infoIcon\n  }, /*#__PURE__*/React.createElement(IconInfo16, null)), i18n.t('No conditions yet, so all values will be included. Add a condition to filter results.')) : renderConditionsContent(), !(SINGLETON_TYPES.includes(valueType) || isOptionSetCondition) && /*#__PURE__*/React.createElement(Tooltip, {\n    content: i18n.t(\"Preset options can't be combined with other conditions\"),\n    placement: \"bottom\",\n    closeDelay: 200\n  }, _ref2 => {\n    let {\n      onMouseOver,\n      onMouseOut,\n      ref\n    } = _ref2;\n    return /*#__PURE__*/React.createElement(\"span\", {\n      ref: ref,\n      onMouseOver: () => disableAddButton && onMouseOver(),\n      onMouseOut: () => disableAddButton && onMouseOut(),\n      className: classes.tooltipReference\n    }, /*#__PURE__*/React.createElement(Button, {\n      type: \"button\",\n      small: true,\n      onClick: addCondition,\n      dataTest: 'conditions-manager-add-condition',\n      className: classes.addConditionButton,\n      disabled: disableAddButton\n    }, conditionsList.length ? i18n.t('Add another condition') : i18n.t('Add a condition')));\n  })));\n\n  const renderTabs = () => {\n    const disableRepeatableTab = !(stage !== null && stage !== void 0 && stage.repeatable);\n    const repeatableTab = /*#__PURE__*/React.createElement(Tab, {\n      key: TAB_REPEATABLE_EVENTS,\n      onClick: () => setCurrentTab(TAB_REPEATABLE_EVENTS),\n      selected: currentTab === TAB_REPEATABLE_EVENTS,\n      disabled: disableRepeatableTab\n    }, i18n.t('Repeated events'));\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(TabBar, {\n      className: classes.tabBar\n    }, /*#__PURE__*/React.createElement(Tab, {\n      key: TAB_CONDITIONS,\n      onClick: () => setCurrentTab(TAB_CONDITIONS),\n      selected: currentTab === TAB_CONDITIONS\n    }, i18n.t('Conditions')), disableRepeatableTab ? /*#__PURE__*/React.createElement(Tooltip, {\n      key: \"repeatable-tooltip\",\n      placement: \"bottom\",\n      content: i18n.t('Only available for repeatable stages')\n    }, repeatableTab) : repeatableTab), currentTab === TAB_CONDITIONS ? renderConditions() : /*#__PURE__*/React.createElement(RepeatableEvents, {\n      dimensionId: dimension.id\n    }));\n  };\n\n  console.log(\"valueType: \".concat(valueType, \", dimensionType: \").concat(dimension.dimensionType, \", id: \").concat(dimension.id)); // TODO: For testing only\n\n  return dimension ? /*#__PURE__*/React.createElement(DimensionModal, {\n    dataTest: 'dialog-manager-modal',\n    isInLayout: isInLayout,\n    onClose: closeModal,\n    title: stage !== null && stage !== void 0 && stage.name ? \"\".concat(dimension.name, \" - \").concat(stage.name) : dimension.name\n  }, isRepeatable ? renderTabs() : renderConditions()) : null;\n};\n\nConditionsManager.propTypes = {\n  conditions: PropTypes.object.isRequired,\n  dimension: PropTypes.object.isRequired,\n  isInLayout: PropTypes.bool.isRequired,\n  inputType: PropTypes.string,\n  legendSet: PropTypes.string,\n  setConditionsByDimension: PropTypes.func,\n  stage: PropTypes.object,\n  onClose: PropTypes.func\n};\n\nconst mapStateToProps = (state, ownProps) => {\n  var _ownProps$dimension, _ownProps$dimension2, _ownProps$dimension3, _ownProps$dimension3$;\n\n  return {\n    isInLayout: sGetDimensionIdsFromLayout(state).includes((_ownProps$dimension = ownProps.dimension) === null || _ownProps$dimension === void 0 ? void 0 : _ownProps$dimension.id),\n    conditions: sGetUiConditionsByDimension(state, (_ownProps$dimension2 = ownProps.dimension) === null || _ownProps$dimension2 === void 0 ? void 0 : _ownProps$dimension2.id) || {},\n    dimensionIdsInLayout: sGetDimensionIdsFromLayout(state),\n    inputType: sGetUiInputType(state),\n    stage: sGetMetadataById(state, (_ownProps$dimension3 = ownProps.dimension) === null || _ownProps$dimension3 === void 0 ? void 0 : (_ownProps$dimension3$ = _ownProps$dimension3.id) === null || _ownProps$dimension3$ === void 0 ? void 0 : _ownProps$dimension3$.substring(0, ownProps.dimension.id.indexOf('.'))) || {}\n  };\n};\n\nconst mapDispatchToProps = {\n  setConditionsByDimension: acSetUiConditions\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(ConditionsManager);","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport { apiFetchItemsByDimension, useCachedDataQuery } from '@dhis2/analytics';\nimport { useDataEngine } from '@dhis2/app-runtime';\nimport i18n from '@dhis2/d2-i18n';\nimport { Transfer, TransferOption } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { useState } from 'react';\nimport { connect } from 'react-redux';\nimport { acAddMetadata } from '../../actions/metadata.js';\nimport { acSetUiItems } from '../../actions/ui.js';\nimport { DERIVED_USER_SETTINGS_DISPLAY_NAME_PROPERTY } from '../../modules/userSettings.js';\nimport { useDebounce, useDidUpdateEffect } from '../../modules/utils.js';\nimport { sGetMetadata } from '../../reducers/metadata.js';\nimport { sGetDimensionIdsFromLayout, sGetUiItemsByDimension } from '../../reducers/ui.js';\nimport { TransferEmptySelection } from './common/TransferEmptySelection.js';\nimport { TransferLeftHeader } from './common/TransferLeftHeader.js';\nimport { TransferRightHeader } from './common/TransferRightHeader.js';\nimport { TransferSourceEmptyPlaceholder } from './common/TransferSourceEmptyPlaceholder.js';\nimport DimensionModal from './DimensionModal.js';\nimport classes from './styles/Common.module.css';\nimport { TRANSFER_HEIGHT, TRANSFER_OPTIONS_WIDTH, TRANSFER_SELECTED_WIDTH } from './utils.js';\n\nconst DynamicDimension = _ref => {\n  let {\n    onClose,\n    dimension,\n    isInLayout,\n    setUiItems,\n    selectedIds,\n    addMetadata,\n    metadata\n  } = _ref;\n  const {\n    userSettings\n  } = useCachedDataQuery();\n  const [state, setState] = useState({\n    searchTerm: '',\n    items: [],\n    loading: true,\n    nextPage: 1\n  });\n  const dataTest = \"dynamic-dimension-\".concat(dimension.id);\n  const dataEngine = useDataEngine();\n\n  const setSearchTerm = searchTerm => setState(state => ({ ...state,\n    searchTerm\n  }));\n\n  const debouncedSearchTerm = useDebounce(state.searchTerm);\n  const selectedItems = selectedIds.map(id => ({\n    value: id,\n    label: Object.values(metadata).find(item => item.id === id).name\n  }));\n\n  const fetchItems = async page => {\n    var _result$dimensionItem;\n\n    setState(state => ({ ...state,\n      loading: true\n    }));\n    const result = await apiFetchItemsByDimension({\n      dataEngine,\n      dimensionId: dimension.id,\n      searchTerm: state.searchTerm,\n      page,\n      nameProp: userSettings[DERIVED_USER_SETTINGS_DISPLAY_NAME_PROPERTY]\n    });\n    const newItems = (_result$dimensionItem = result.dimensionItems) === null || _result$dimensionItem === void 0 ? void 0 : _result$dimensionItem.map(_ref2 => {\n      let {\n        id,\n        name,\n        disabled\n      } = _ref2;\n      return {\n        label: name,\n        value: id,\n        disabled\n      };\n    });\n    setState(state => ({ ...state,\n      loading: false,\n      items: page > 1 ? [...state.items, ...newItems] : newItems,\n      nextPage: result.nextPage\n    }));\n    /*  The following handles a very specific edge-case where the user can select all items from a \n        page and then reopen the modal. Usually Transfer triggers the onEndReached when the end of \n        the page is reached (scrolling down) or if too few items are on the left side (e.g. selecting \n        49 items from page 1, leaving only 1 item on the left side). However, due to the way Transfer \n        works, if 0 items are available, more items are fetched, but all items are already selected \n        (leaving 0 items on the left side still), the onReachedEnd won't trigger. Hence the code below:\n        IF there is a next page AND some items were just fetched AND you have the same or more\n        selected items than fetched items AND all fetched items are already selected -> fetch more!\n    */\n\n    if (result.nextPage && newItems.length && selectedItems.length >= newItems.length && newItems.every(newItem => selectedItems.find(selectedItem => selectedItem.value === newItem.value))) {\n      fetchItems(result.nextPage);\n    }\n  };\n\n  useDidUpdateEffect(() => {\n    setState(state => ({ ...state,\n      loading: true,\n      nextPage: 1\n    }));\n    fetchItems(1);\n  }, [debouncedSearchTerm, state.filter]);\n\n  const onEndReached = () => {\n    if (state.nextPage) {\n      fetchItems(state.nextPage);\n    }\n  };\n\n  const selectUiItems = selected => {\n    addMetadata(state.items.filter(item => selected.includes(item.value) && !selectedItems.find(si => si.value === item.value)).reduce((acc, item) => ({ ...acc,\n      [item.value]: {\n        id: item.value,\n        name: item.label\n      }\n    }), {}));\n    setUiItems({\n      dimensionId: dimension.id,\n      itemIds: selected\n    });\n  };\n\n  const closeModal = () => onClose();\n\n  const renderModalContent = () => /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"p\", {\n    className: classes.paragraph\n  }, i18n.t('Show items that meet the following conditions for this data item:')), /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.mainSection\n  }, /*#__PURE__*/React.createElement(Transfer, {\n    onChange: _ref3 => {\n      let {\n        selected\n      } = _ref3;\n      return selectUiItems(selected);\n    },\n    selected: selectedItems.map(item => item.value),\n    options: [...state.items, ...selectedItems],\n    loading: state.loading,\n    loadingPicked: state.loading,\n    sourceEmptyPlaceholder: /*#__PURE__*/React.createElement(TransferSourceEmptyPlaceholder, {\n      loading: state.loading,\n      searchTerm: debouncedSearchTerm,\n      options: state.items,\n      dataTest: \"\".concat(dataTest, \"-empty-source\")\n    }),\n    onEndReached: onEndReached,\n    leftHeader: /*#__PURE__*/React.createElement(TransferLeftHeader, {\n      searchTerm: state.searchTerm,\n      setSearchTerm: setSearchTerm,\n      dataTest: \"\".concat(dataTest, \"-left-header\")\n    }),\n    height: TRANSFER_HEIGHT,\n    optionsWidth: TRANSFER_OPTIONS_WIDTH,\n    selectedWidth: TRANSFER_SELECTED_WIDTH,\n    selectedEmptyComponent: /*#__PURE__*/React.createElement(TransferEmptySelection, null),\n    rightHeader: /*#__PURE__*/React.createElement(TransferRightHeader, null),\n    renderOption: props => /*#__PURE__*/React.createElement(TransferOption, _extends({}, props, {\n      dataTest: \"\".concat(dataTest, \"-transfer-option\")\n    })),\n    dataTest: \"\".concat(dataTest, \"-transfer\")\n  })));\n\n  console.log(\"dimensionType: \".concat(dimension.dimensionType, \", id: \").concat(dimension.id)); // TODO: For testing only\n\n  return dimension ? /*#__PURE__*/React.createElement(DimensionModal, {\n    isInLayout: isInLayout,\n    onClose: closeModal,\n    title: dimension.name\n  }, renderModalContent()) : null;\n};\n\nDynamicDimension.propTypes = {\n  addMetadata: PropTypes.func.isRequired,\n  dimension: PropTypes.object.isRequired,\n  isInLayout: PropTypes.bool.isRequired,\n  metadata: PropTypes.object.isRequired,\n  selectedIds: PropTypes.array.isRequired,\n  onClose: PropTypes.func.isRequired,\n  setUiItems: PropTypes.func\n};\n\nconst mapStateToProps = (state, ownProps) => {\n  var _ownProps$dimension, _ownProps$dimension2;\n\n  return {\n    isInLayout: sGetDimensionIdsFromLayout(state).includes((_ownProps$dimension = ownProps.dimension) === null || _ownProps$dimension === void 0 ? void 0 : _ownProps$dimension.id),\n    selectedIds: sGetUiItemsByDimension(state, (_ownProps$dimension2 = ownProps.dimension) === null || _ownProps$dimension2 === void 0 ? void 0 : _ownProps$dimension2.id) || [],\n    metadata: sGetMetadata(state)\n  };\n};\n\nexport default connect(mapStateToProps, {\n  setUiItems: acSetUiItems,\n  addMetadata: acAddMetadata\n})(DynamicDimension);","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport { OrgUnitDimension, ouIdHelper, DIMENSION_ID_ORGUNIT, useCachedDataQuery } from '@dhis2/analytics';\nimport i18n from '@dhis2/d2-i18n';\nimport { Checkbox } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { acAddMetadata } from '../../actions/metadata.js';\nimport { acSetUiItems, acAddParentGraphMap } from '../../actions/ui.js';\nimport { DIMENSION_ID_EVENT_STATUS, DIMENSION_ID_PROGRAM_STATUS } from '../../modules/dimensionConstants.js';\nimport { removeLastPathSegment, getOuPath } from '../../modules/orgUnit.js';\nimport { STATUS_ACTIVE, STATUS_CANCELLED, STATUS_COMPLETED, statusNames } from '../../modules/visualization.js';\nimport { sGetMetadata } from '../../reducers/metadata.js';\nimport { sGetUiItemsByDimension, sGetUiParentGraphMap, sGetDimensionIdsFromLayout } from '../../reducers/ui.js';\nimport DimensionModal from './DimensionModal.js';\nimport classes from './styles/Common.module.css';\n\nconst FixedDimension = _ref => {\n  let {\n    addMetadata,\n    addParentGraphMap,\n    onClose,\n    dimension,\n    isInLayout,\n    metadata,\n    ouIds,\n    eventStatusIds,\n    programStatusIds,\n    parentGraphMap,\n    setUiItems\n  } = _ref;\n  const {\n    rootOrgUnits\n  } = useCachedDataQuery();\n\n  const selectUiItems = _ref2 => {\n    let {\n      dimensionId,\n      items\n    } = _ref2;\n    setUiItems({\n      dimensionId,\n      itemIds: items.map(item => item.id)\n    });\n\n    switch (dimensionId) {\n      case DIMENSION_ID_ORGUNIT:\n        {\n          const forMetadata = {};\n          const forParentGraphMap = {};\n          items.forEach(ou => {\n            const id = ouIdHelper.removePrefix(ou.id);\n            forMetadata[id] = {\n              id,\n              name: ou.name || ou.displayName,\n              displayName: ou.displayName\n            };\n\n            if (ou.path) {\n              const path = removeLastPathSegment(ou.path);\n              forParentGraphMap[ou.id] = path === \"/\".concat(ou.id) ? '' : path.replace(/^\\//, '');\n            }\n          });\n          addMetadata(forMetadata);\n          addParentGraphMap(forParentGraphMap);\n          break;\n        }\n      // TODO: case DIMENSION_ID_PERIOD:\n    }\n  };\n\n  const closeModal = () => onClose();\n\n  const renderStatusParagraph = () => /*#__PURE__*/React.createElement(\"p\", {\n    className: classes.paragraph\n  }, i18n.t('Show items where the status is:', {\n    nsSeparator: '^^'\n  }));\n\n  const setStatus = _ref3 => {\n    let {\n      dimensionId,\n      selectedItemsIds,\n      itemId,\n      toggle\n    } = _ref3;\n    const newIds = toggle ? [...new Set([...selectedItemsIds, itemId])] : selectedItemsIds.filter(id => id !== itemId);\n    selectUiItems({\n      dimensionId,\n      items: newIds.map(id => ({\n        id\n      }))\n    });\n  };\n\n  const renderProgramStatus = () => {\n    const ALL_STATUSES = [{\n      id: STATUS_ACTIVE,\n      name: statusNames[STATUS_ACTIVE]\n    }, {\n      id: STATUS_COMPLETED,\n      name: statusNames[STATUS_COMPLETED]\n    }, {\n      id: STATUS_CANCELLED,\n      name: statusNames[STATUS_CANCELLED]\n    }];\n    return /*#__PURE__*/React.createElement(React.Fragment, null, renderStatusParagraph(), /*#__PURE__*/React.createElement(\"div\", null, ALL_STATUSES.map(_ref4 => {\n      let {\n        id,\n        name\n      } = _ref4;\n      return /*#__PURE__*/React.createElement(Checkbox, {\n        key: id,\n        checked: programStatusIds.includes(id),\n        label: name,\n        onChange: _ref5 => {\n          let {\n            checked\n          } = _ref5;\n          return setStatus({\n            dimensionId: DIMENSION_ID_PROGRAM_STATUS,\n            selectedItemsIds: programStatusIds,\n            itemId: id,\n            toggle: checked\n          });\n        },\n        dense: true,\n        className: classes.verticalCheckbox\n      });\n    })));\n  };\n\n  const renderEventStatus = () => {\n    const ALL_STATUSES = [{\n      id: STATUS_ACTIVE,\n      name: statusNames[STATUS_ACTIVE]\n    }, {\n      id: STATUS_COMPLETED,\n      name: statusNames[STATUS_COMPLETED]\n    }];\n    return /*#__PURE__*/React.createElement(React.Fragment, null, renderStatusParagraph(), /*#__PURE__*/React.createElement(\"div\", null, ALL_STATUSES.map(_ref6 => {\n      let {\n        id,\n        name\n      } = _ref6;\n      return /*#__PURE__*/React.createElement(Checkbox, {\n        key: id,\n        checked: eventStatusIds.includes(id),\n        label: name,\n        onChange: _ref7 => {\n          let {\n            checked\n          } = _ref7;\n          return setStatus({\n            dimensionId: DIMENSION_ID_EVENT_STATUS,\n            selectedItemsIds: eventStatusIds,\n            itemId: id,\n            toggle: checked\n          });\n        },\n        dense: true,\n        className: classes.verticalCheckbox\n      });\n    })));\n  };\n\n  const renderModalContent = () => {\n    switch (dimension.id) {\n      case DIMENSION_ID_PROGRAM_STATUS:\n        return renderProgramStatus();\n\n      case DIMENSION_ID_EVENT_STATUS:\n        return renderEventStatus();\n\n      case DIMENSION_ID_ORGUNIT:\n        {\n          const dimensionProps = {\n            onSelect: selectUiItems\n          };\n          const selected = ouIds // TODO: Refactor to not depend on the whole metadata object, but pass in full ouObjects (mapped with metadata) instead of just ids\n          .filter(id => metadata[ouIdHelper.removePrefix(id)] !== undefined).map(id => {\n            const ouUid = ouIdHelper.removePrefix(id);\n            return {\n              id,\n              name: metadata[ouUid].displayName || metadata[ouUid].name,\n              path: getOuPath(ouUid, metadata, parentGraphMap)\n            };\n          });\n          const display = dimension.id === DIMENSION_ID_ORGUNIT ? 'block' : 'none';\n          return /*#__PURE__*/React.createElement(\"div\", {\n            key: DIMENSION_ID_ORGUNIT,\n            style: {\n              display\n            }\n          }, /*#__PURE__*/React.createElement(OrgUnitDimension, _extends({\n            selected: selected,\n            roots: rootOrgUnits.map(rootOrgUnit => rootOrgUnit.id)\n          }, dimensionProps)));\n        }\n      // TODO: case DIMENSION_ID_PERIOD:\n    }\n  };\n\n  return dimension ? /*#__PURE__*/React.createElement(DimensionModal, {\n    dataTest: 'dialog-manager-modal',\n    isInLayout: isInLayout,\n    onClose: closeModal,\n    title: dimension.name\n  }, renderModalContent()) : null;\n};\n\nFixedDimension.propTypes = {\n  dimension: PropTypes.object.isRequired,\n  eventStatusIds: PropTypes.array.isRequired,\n  isInLayout: PropTypes.bool.isRequired,\n  ouIds: PropTypes.array.isRequired,\n  programStatusIds: PropTypes.array.isRequired,\n  onClose: PropTypes.func.isRequired,\n  addMetadata: PropTypes.func,\n  addParentGraphMap: PropTypes.func,\n  metadata: PropTypes.object,\n  parentGraphMap: PropTypes.object,\n  setUiItems: PropTypes.func\n};\nFixedDimension.defaultProps = {\n  rootOrgUnits: []\n};\n\nconst mapStateToProps = (state, ownProps) => {\n  var _ownProps$dimension;\n\n  return {\n    eventStatusIds: sGetUiItemsByDimension(state, DIMENSION_ID_EVENT_STATUS),\n    isInLayout: sGetDimensionIdsFromLayout(state).includes((_ownProps$dimension = ownProps.dimension) === null || _ownProps$dimension === void 0 ? void 0 : _ownProps$dimension.id),\n    metadata: sGetMetadata(state),\n    ouIds: sGetUiItemsByDimension(state, DIMENSION_ID_ORGUNIT),\n    parentGraphMap: sGetUiParentGraphMap(state),\n    programStatusIds: sGetUiItemsByDimension(state, DIMENSION_ID_PROGRAM_STATUS)\n  };\n};\n\nexport default connect(mapStateToProps, {\n  setUiItems: acSetUiItems,\n  addMetadata: acAddMetadata,\n  addParentGraphMap: acAddParentGraphMap\n})(FixedDimension);","import i18n from '@dhis2/d2-i18n';\nimport { Field, IconArrowRight16, InputField, colors } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { useEffect, useState } from 'react';\nimport styles from './StartEndDate.module.css';\nexport const StartEndDate = _ref => {\n  let {\n    value,\n    setValue\n  } = _ref;\n  const [startDateStr, endDateStr] = value ? value.split('_') : [];\n  const [startDate, setStartDate] = useState(startDateStr);\n  const [endDate, setEndDate] = useState(endDateStr);\n  useEffect(() => {\n    setValue(startDate && endDate ? \"\".concat(startDate, \"_\").concat(endDate) : '');\n  }, [startDate, endDate]);\n\n  const onStartDateChange = _ref2 => {\n    let {\n      value\n    } = _ref2;\n    setStartDate(value);\n  };\n\n  const onEndDateChange = _ref3 => {\n    let {\n      value\n    } = _ref3;\n    setEndDate(value);\n  };\n\n  return /*#__PURE__*/React.createElement(Field, {\n    helpText: i18n.t('Start and end dates are inclusive and will be included in the outputs.')\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.row\n  }, /*#__PURE__*/React.createElement(InputField, {\n    value: startDate,\n    type: \"date\",\n    onChange: onStartDateChange,\n    label: i18n.t('Start date'),\n    inputWidth: \"200px\",\n    max: \"9999-12-31\"\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.icon\n  }, /*#__PURE__*/React.createElement(IconArrowRight16, {\n    color: colors.grey500\n  })), /*#__PURE__*/React.createElement(InputField, {\n    value: endDate,\n    type: \"date\",\n    onChange: onEndDateChange,\n    label: i18n.t('End date'),\n    inputWidth: \"200px\",\n    max: \"9999-12-31\"\n  })));\n};\nStartEndDate.propTypes = {\n  setValue: PropTypes.func.isRequired,\n  value: PropTypes.string.isRequired\n};","import { PeriodDimension as BasePeriodDimension, useCachedDataQuery, DAILY, WEEKLY, WEEKLYWED, WEEKLYTHU, WEEKLYSAT, WEEKLYSUN, BIWEEKLY, MONTHLY, BIMONTHLY } from '@dhis2/analytics';\nimport i18n from '@dhis2/d2-i18n';\nimport { SegmentedControl } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { useState, useMemo } from 'react';\nimport { useDispatch, useSelector, useStore } from 'react-redux';\nimport { tSetCurrentFromUi } from '../../../actions/current.js';\nimport { acSetUiItems } from '../../../actions/ui.js';\nimport { SYSTEM_SETTINGS_HIDE_DAILY_PERIODS, SYSTEM_SETTINGS_HIDE_WEEKLY_PERIODS, SYSTEM_SETTINGS_HIDE_BIWEEKLY_PERIODS, SYSTEM_SETTINGS_HIDE_MONTHLY_PERIODS, SYSTEM_SETTINGS_HIDE_BIMONTHLY_PERIODS } from '../../../modules/systemSettings.js';\nimport { USER_SETTINGS_UI_LOCALE } from '../../../modules/userSettings.js';\nimport { sGetDimensionIdsFromLayout, sGetUiItemsByDimension } from '../../../reducers/ui.js';\nimport DimensionModal from '../DimensionModal.js';\nimport styles from './PeriodDimension.module.css';\nimport { StartEndDate } from './StartEndDate.js';\nexport const OPTION_PRESETS = 'PRESETS';\nexport const OPTION_START_END_DATES = 'START_END_DATES';\nconst segmentedControlOptions = [{\n  label: i18n.t('Choose from presets'),\n  value: OPTION_PRESETS\n}, {\n  label: i18n.t('Define start - end dates'),\n  value: OPTION_START_END_DATES\n}];\n\nconst isStartEndDate = id => {\n  const parts = id.split('_');\n  return parts.length === 2 && !isNaN(Date.parse(parts[0])) && !isNaN(Date.parse(parts[1]));\n};\n\nconst useIsInLayout = dimensionId => {\n  const allDimensionIds = useSelector(sGetDimensionIdsFromLayout);\n  return useMemo(() => !!dimensionId && allDimensionIds.includes(dimensionId), [dimensionId, allDimensionIds]);\n};\n\nconst useLocalizedStartEndDateFormatter = () => {\n  const {\n    userSettings\n  } = useCachedDataQuery();\n  const formatter = new Intl.DateTimeFormat(userSettings[USER_SETTINGS_UI_LOCALE], {\n    dateStyle: 'long'\n  });\n  return startEndDate => {\n    if (isStartEndDate(startEndDate)) {\n      return startEndDate.split('_').map(dateStr => formatter.format(new Date(dateStr))).join(' - ');\n    } else {\n      return '';\n    }\n  };\n};\n\nconst useMetadataNameGetter = () => {\n  const store = useStore();\n  return id => {\n    var _metadata$id;\n\n    const {\n      metadata\n    } = store.getState();\n    return (_metadata$id = metadata[id]) === null || _metadata$id === void 0 ? void 0 : _metadata$id.name;\n  };\n};\n\nconst useExcludedPeriods = () => {\n  const {\n    systemSettings\n  } = useCachedDataQuery();\n  const types = [];\n\n  if (systemSettings[SYSTEM_SETTINGS_HIDE_DAILY_PERIODS]) {\n    types.push(DAILY);\n  }\n\n  if (systemSettings[SYSTEM_SETTINGS_HIDE_WEEKLY_PERIODS]) {\n    types.push(WEEKLY, WEEKLYWED, WEEKLYTHU, WEEKLYSAT, WEEKLYSUN);\n  }\n\n  if (systemSettings[SYSTEM_SETTINGS_HIDE_BIWEEKLY_PERIODS]) {\n    types.push(BIWEEKLY);\n  }\n\n  if (systemSettings[SYSTEM_SETTINGS_HIDE_MONTHLY_PERIODS]) {\n    types.push(MONTHLY);\n  }\n\n  if (systemSettings[SYSTEM_SETTINGS_HIDE_BIMONTHLY_PERIODS]) {\n    types.push(BIMONTHLY);\n  }\n\n  return types;\n};\n\nexport const PeriodDimension = _ref => {\n  let {\n    dimension,\n    onClose\n  } = _ref;\n  const formatStartEndDate = useLocalizedStartEndDateFormatter();\n  const getNameFromMetadata = useMetadataNameGetter();\n  const dispatch = useDispatch();\n  const isInLayout = useIsInLayout(dimension === null || dimension === void 0 ? void 0 : dimension.id);\n  const excludedPeriodTypes = useExcludedPeriods();\n  const selectedIds = useSelector(state => sGetUiItemsByDimension(state, dimension === null || dimension === void 0 ? void 0 : dimension.id)) || [];\n  const [entryMethod, setEntryMethod] = useState(selectedIds.filter(id => isStartEndDate(id)).length ? OPTION_START_END_DATES : OPTION_PRESETS);\n\n  const updatePeriodDimensionItems = items => {\n    const {\n      uiItems,\n      metadata\n    } = items.reduce((acc, item) => {\n      acc.uiItems.push(item.id);\n\n      if (isStartEndDate(item.id)) {\n        acc.metadata[item.id] = {\n          id: item.id,\n          name: formatStartEndDate(item.id)\n        };\n      } else {\n        acc.metadata[item.id] = item;\n      }\n\n      return acc;\n    }, {\n      uiItems: [],\n      metadata: {}\n    });\n    dispatch(acSetUiItems({\n      dimensionId: dimension.id,\n      itemIds: uiItems\n    }, metadata));\n  };\n\n  const primaryOnClick = () => {\n    dispatch(tSetCurrentFromUi());\n    onClose();\n  };\n\n  const onSegmentedControlChange = _ref2 => {\n    let {\n      value\n    } = _ref2;\n    setEntryMethod(value);\n    updatePeriodDimensionItems([]);\n  };\n\n  return dimension ? /*#__PURE__*/React.createElement(DimensionModal, {\n    dataTest: 'period-dimension-modal',\n    isInLayout: isInLayout,\n    onClose: onClose,\n    onUpdate: primaryOnClick,\n    title: dimension.name\n  }, /*#__PURE__*/React.createElement(SegmentedControl, {\n    options: segmentedControlOptions,\n    selected: entryMethod,\n    onChange: onSegmentedControlChange\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.entry\n  }, entryMethod === OPTION_PRESETS && /*#__PURE__*/React.createElement(BasePeriodDimension, {\n    selectedPeriods: selectedIds.map(id => ({\n      id,\n      name: getNameFromMetadata(id)\n    })),\n    onSelect: _ref3 => {\n      let {\n        items\n      } = _ref3;\n      return updatePeriodDimensionItems(items);\n    },\n    excludedPeriodTypes: excludedPeriodTypes\n  }), entryMethod === OPTION_START_END_DATES && /*#__PURE__*/React.createElement(StartEndDate, {\n    value: selectedIds[0] || '',\n    setValue: value => {\n      if (!value && selectedIds.length) {\n        updatePeriodDimensionItems([]);\n      } else if (value && value !== selectedIds[0]) {\n        updatePeriodDimensionItems([{\n          id: value\n        }]);\n      }\n    }\n  }))) : null;\n};\nPeriodDimension.propTypes = {\n  dimension: PropTypes.object.isRequired,\n  onClose: PropTypes.func.isRequired\n};","import { PeriodDimension } from './PeriodDimension.js';\nexport default PeriodDimension;","import { DIMENSION_TYPE_CATEGORY, DIMENSION_TYPE_CATEGORY_OPTION_GROUP_SET, DIMENSION_TYPE_ORGANISATION_UNIT, DIMENSION_TYPE_PERIOD, DIMENSION_TYPE_ORGANISATION_UNIT_GROUP_SET } from '@dhis2/analytics';\nimport React from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { acSetUiOpenDimensionModal } from '../../actions/ui.js';\nimport { DIMENSION_TYPE_STATUS } from '../../modules/dimensionConstants.js';\nimport { sGetMetadata } from '../../reducers/metadata.js';\nimport { sGetUiActiveModalDialog } from '../../reducers/ui.js';\nimport ConditionsManager from './Conditions/ConditionsManager.js';\nimport DynamicDimension from './DynamicDimension.js';\nimport FixedDimension from './FixedDimension.js';\nimport PeriodDimension from './PeriodDimension/index.js';\n\nconst DialogManager = () => {\n  const dispatch = useDispatch();\n  const dimension = useSelector(state => sGetMetadata(state)[sGetUiActiveModalDialog(state)]);\n\n  const onClose = () => dispatch(acSetUiOpenDimensionModal(null));\n\n  if (!(dimension !== null && dimension !== void 0 && dimension.id)) {\n    return null;\n  }\n\n  switch (dimension.dimensionType) {\n    case DIMENSION_TYPE_CATEGORY:\n    case DIMENSION_TYPE_CATEGORY_OPTION_GROUP_SET:\n    case DIMENSION_TYPE_ORGANISATION_UNIT_GROUP_SET:\n      return /*#__PURE__*/React.createElement(DynamicDimension, {\n        dimension: dimension,\n        onClose: onClose\n      });\n\n    case DIMENSION_TYPE_PERIOD:\n      return /*#__PURE__*/React.createElement(PeriodDimension, {\n        dimension: dimension,\n        onClose: onClose\n      });\n\n    case DIMENSION_TYPE_STATUS:\n    case DIMENSION_TYPE_ORGANISATION_UNIT:\n      return /*#__PURE__*/React.createElement(FixedDimension, {\n        dimension: dimension,\n        onClose: onClose\n      });\n\n    default:\n      return /*#__PURE__*/React.createElement(ConditionsManager, {\n        dimension: dimension,\n        onClose: onClose\n      });\n  }\n};\n\nexport default DialogManager;","import { DIMENSION_TYPE_PROGRAM_INDICATOR, DIMENSION_TYPE_CATEGORY_OPTION_GROUP_SET, DIMENSION_TYPE_DATA_ELEMENT, DIMENSION_TYPE_CATEGORY, DIMENSION_TYPE_PROGRAM_ATTRIBUTE, DIMENSION_TYPE_PERIOD, DIMENSION_TYPE_ORGANISATION_UNIT, DIMENSION_TYPE_ORGANISATION_UNIT_GROUP_SET } from '@dhis2/analytics';\nimport { IconDimensionData16, IconDimensionProgramIndicator16, IconFilter16, IconDimensionCategoryOptionGroupset16, IconDimensionOrgUnitGroupset16, IconDimensionOrgUnit16, IconCheckmarkCircle16, IconUser16, IconCalendar16 } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { DIMENSION_TYPE_STATUS, DIMENSION_TYPE_USER } from '../../../modules/dimensionConstants.js'; // TODO: move this to ui-icons when Joe is back and has a chance to alter the design\n\nconst IconDimensionProgramAttribute16 = () => /*#__PURE__*/React.createElement(\"svg\", {\n  height: \"16\",\n  viewBox: \"0 0 16 16\",\n  width: \"16\",\n  xmlns: \"http://www.w3.org/2000/svg\"\n}, /*#__PURE__*/React.createElement(\"path\", {\n  d: \"m15 3 v10h-7v-10z m-1 1 v2h-5v-2z m0 3 v2h-5v-2z m0 3 v2h-5v-2z m-7 -6 h-5v7h5v1h-6v-10h6z\",\n  fill: \"#010101\",\n  fillRule: \"evenodd\"\n}));\n\nconst DIMENSION_TYPE_ICONS = {\n  /**PROGRAM**/\n  [DIMENSION_TYPE_DATA_ELEMENT]: IconDimensionData16,\n  [DIMENSION_TYPE_PROGRAM_ATTRIBUTE]: IconDimensionProgramAttribute16,\n  [DIMENSION_TYPE_PROGRAM_INDICATOR]: IconDimensionProgramIndicator16,\n  [DIMENSION_TYPE_CATEGORY]: IconFilter16,\n  [DIMENSION_TYPE_CATEGORY_OPTION_GROUP_SET]: IconDimensionCategoryOptionGroupset16,\n\n  /**YOURS**/\n  [DIMENSION_TYPE_ORGANISATION_UNIT_GROUP_SET]: IconDimensionOrgUnitGroupset16,\n\n  /**MAIN**/\n  [DIMENSION_TYPE_ORGANISATION_UNIT]: IconDimensionOrgUnit16,\n  [DIMENSION_TYPE_STATUS]: IconCheckmarkCircle16,\n  [DIMENSION_TYPE_USER]: IconUser16,\n\n  /**TIME**/\n  [DIMENSION_TYPE_PERIOD]: IconCalendar16\n}; // Presentational component used by dnd - do not add redux or dnd functionality\n\nconst DimensionIcon = _ref => {\n  let {\n    dimensionType\n  } = _ref;\n  const Icon = dimensionType && DIMENSION_TYPE_ICONS[dimensionType];\n  return Icon ? /*#__PURE__*/React.createElement(Icon, null) : null;\n};\n\nDimensionIcon.propTypes = {\n  dimensionType: PropTypes.string\n};\nexport { DimensionIcon };","import { DIMENSION_ID_ORGUNIT, DIMENSION_TYPE_PERIOD } from '@dhis2/analytics';\nimport i18n from '@dhis2/d2-i18n';\nimport cx from 'classnames';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { VALUE_TYPE_BOOLEAN, VALUE_TYPE_TRUE_ONLY } from '../../modules/conditions.js';\nimport { DimensionIcon } from '../MainSidebar/DimensionItem/DimensionIcon.js';\nimport styles from './styles/Chip.module.css';\nconst VALUE_TYPE_TRUE_ONLY_NUM_OPTIONS = 2;\nconst VALUE_TYPE_BOOLEAN_NUM_OPTIONS = 3; // Presentational component used by dnd - do not add redux or dnd functionality\n\nexport const ChipBase = _ref => {\n  let {\n    dimension,\n    conditionsLength,\n    itemsLength\n  } = _ref;\n  const {\n    id,\n    name,\n    dimensionType,\n    optionSet,\n    valueType,\n    stageName\n  } = dimension;\n\n  const getChipSuffix = () => {\n    if ((id === DIMENSION_ID_ORGUNIT || dimensionType === DIMENSION_TYPE_PERIOD) && !itemsLength) {\n      return '';\n    }\n\n    const all = i18n.t('all');\n\n    if (!conditionsLength && !itemsLength) {\n      return \": \".concat(all);\n    }\n\n    if (valueType === VALUE_TYPE_TRUE_ONLY && conditionsLength === VALUE_TYPE_TRUE_ONLY_NUM_OPTIONS || valueType === VALUE_TYPE_BOOLEAN && conditionsLength === VALUE_TYPE_BOOLEAN_NUM_OPTIONS) {\n      return \": \".concat(all);\n    }\n\n    if (optionSet || itemsLength) {\n      const selected = itemsLength || conditionsLength;\n      const suffix = i18n.t('{{count}} selected', {\n        count: selected,\n        defaultValue: '{{count}} selected',\n        defaultValue_plural: '{{count}} selected'\n      });\n      return \": \".concat(suffix);\n    } else if (conditionsLength) {\n      const suffix = i18n.t('{{count}} conditions', {\n        count: conditionsLength,\n        defaultValue: '{{count}} condition',\n        defaultValue_plural: '{{count}} conditions'\n      });\n      return \": \".concat(suffix);\n    }\n\n    return '';\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(styles.chipBase)\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.leftIcon\n  }, /*#__PURE__*/React.createElement(DimensionIcon, {\n    dimensionType: dimensionType\n  })), /*#__PURE__*/React.createElement(\"span\", {\n    className: styles.label\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: styles.primary\n  }, name), stageName && /*#__PURE__*/React.createElement(\"span\", {\n    className: styles.secondary\n  }, stageName)), /*#__PURE__*/React.createElement(\"span\", {\n    className: styles.suffix\n  }, getChipSuffix()));\n};\nChipBase.propTypes = {\n  conditionsLength: PropTypes.number,\n  dimension: PropTypes.shape({\n    dimensionType: PropTypes.string,\n    id: PropTypes.string,\n    name: PropTypes.string,\n    optionSet: PropTypes.string,\n    stageName: PropTypes.string,\n    valueType: PropTypes.string\n  }),\n  itemsLength: PropTypes.number\n};","import cx from 'classnames';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { DimensionIcon } from './DimensionIcon.js';\nimport styles from './DimensionItemBase.module.css'; // Presentational component used by dnd - do not add redux or dnd functionality\n\nconst DimensionItemBase = _ref => {\n  let {\n    dragging,\n    name,\n    dimensionType,\n    selected,\n    disabled,\n    stageName,\n    contextMenu,\n    onClick\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(styles.dimensionItem, {\n      [styles.selected]: selected,\n      [styles.disabled]: disabled,\n      [styles.dragging]: dragging\n    }),\n    onClick: onClick\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.iconAndLabelWrapper\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.icon\n  }, /*#__PURE__*/React.createElement(DimensionIcon, {\n    dimensionType: dimensionType\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.label\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: styles.primary\n  }, name), stageName && /*#__PURE__*/React.createElement(\"span\", {\n    className: styles.secondary\n  }, stageName))), contextMenu && contextMenu);\n};\n\nDimensionItemBase.propTypes = {\n  name: PropTypes.string.isRequired,\n  contextMenu: PropTypes.node,\n  dimensionType: PropTypes.string,\n  disabled: PropTypes.bool,\n  dragging: PropTypes.bool,\n  selected: PropTypes.bool,\n  stageName: PropTypes.string,\n  onClick: PropTypes.func\n};\nDimensionItemBase.defaultProps = {\n  conditions: [],\n  items: [],\n  onClick: Function.prototype\n};\nexport { DimensionItemBase };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport { AXIS_ID_COLUMNS, AXIS_ID_FILTERS } from '@dhis2/analytics';\nimport { DndContext, DragOverlay, useSensor, useSensors, PointerSensor } from '@dnd-kit/core';\nimport cx from 'classnames';\nimport PropTypes from 'prop-types';\nimport React, { useState } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { acAddMetadata } from '../actions/metadata.js';\nimport { acAddUiLayoutDimensions, acSetUiLayout, acSetUiDraggingId } from '../actions/ui.js';\nimport { getConditionsTexts } from '../modules/conditions.js';\nimport { extractDimensionIdParts } from '../modules/utils.js';\nimport { sGetMetadata } from '../reducers/metadata.js';\nimport { sGetUiLayout, sGetUiItemsByDimension, sGetUiDraggingId, sGetUiConditionsByDimension, sGetUiOptions } from '../reducers/ui.js';\nimport styles from './DndContext.module.css';\nimport { ChipBase } from './Layout/ChipBase.js';\nimport chipStyles from './Layout/styles/Chip.module.css';\nimport { DimensionItemBase } from './MainSidebar/DimensionItem/DimensionItemBase.js';\nconst FIRST_POSITION = 0;\nconst LAST_POSITION = -1;\nconst DIMENSION_PANEL_SOURCE = 'Sortable';\nexport const getDropzoneId = (axisId, position) => \"\".concat(axisId, \"-\").concat(position);\nexport const FIRST = 'first';\nexport const LAST = 'last';\nconst activateAt15pixels = {\n  activationConstraint: {\n    distance: 15\n  }\n};\n\nfunction getIntersectionRatio(entry, target) {\n  const top = Math.max(target.top, entry.top);\n  const left = Math.max(target.left, entry.left);\n  const right = Math.min(target.left + target.width, entry.left + entry.width);\n  const bottom = Math.min(target.top + target.height, entry.top + entry.height);\n  const width = right - left;\n  const height = bottom - top;\n\n  if (left < right && top < bottom) {\n    const targetArea = target.width * target.height;\n    const entryArea = entry.width * entry.height;\n    const intersectionArea = width * height;\n    const intersectionRatio = intersectionArea / (targetArea + entryArea - intersectionArea);\n    return Number(intersectionRatio.toFixed(4));\n  } // Rectangles do not overlap, or overlap has an area of zero (edge/corner overlap)\n\n\n  return 0;\n}\n\nfunction sortCollisionsDesc(_ref, _ref2) {\n  let {\n    data: {\n      value: a\n    }\n  } = _ref;\n  let {\n    data: {\n      value: b\n    }\n  } = _ref2;\n  return b - a;\n}\n\nconst rectIntersectionCustom = _ref3 => {\n  let {\n    pointerCoordinates,\n    droppableContainers\n  } = _ref3;\n  // create a rect around the pointerCoords for calculating the intersection\n  const pointerRect = {\n    width: 80,\n    height: 40,\n    top: pointerCoordinates.y - 20,\n    bottom: pointerCoordinates.y + 20,\n    left: pointerCoordinates.x - 40,\n    right: pointerCoordinates.x + 40\n  };\n  const collisions = [];\n\n  for (const droppableContainer of droppableContainers) {\n    const {\n      id,\n      rect: {\n        current: rect\n      }\n    } = droppableContainer;\n\n    if (rect) {\n      const intersectionRatio = getIntersectionRatio(rect, pointerRect);\n\n      if (intersectionRatio > 0) {\n        collisions.push({\n          id,\n          data: {\n            droppableContainer,\n            value: intersectionRatio\n          }\n        });\n      }\n    }\n  }\n\n  return collisions.sort(sortCollisionsDesc);\n};\n\nconst getIdFromDraggingId = draggingId => {\n  const [id] = draggingId.split('-').reverse();\n  return id;\n};\n\nconst OuterDndContext = _ref4 => {\n  let {\n    children\n  } = _ref4;\n  const [sourceAxis, setSourceAxis] = useState(null);\n  const draggingId = useSelector(sGetUiDraggingId);\n  const id = draggingId ? getIdFromDraggingId(draggingId) : null;\n  const layout = useSelector(sGetUiLayout);\n  const metadata = useSelector(sGetMetadata);\n  const chipItems = useSelector(state => sGetUiItemsByDimension(state, id)) || [];\n  const chipConditions = useSelector(state => sGetUiConditionsByDimension(state, id)) || {};\n  const {\n    digitGroupSeparator\n  } = useSelector(sGetUiOptions); // Wait 15px movement before starting drag, so that click event isn't overridden\n\n  const sensor = useSensor(PointerSensor, activateAt15pixels);\n  const sensors = useSensors(sensor);\n  const dispatch = useDispatch();\n\n  const getDragOverlay = () => {\n    var _chipConditions$condi;\n\n    if (!id) {\n      return null;\n    } // TODO - using the rawDimensionId instead of dimensionId\n    // is a temporary workaround\n    // until the backend is updated to return programStageId.dimensionId\n    // in analytics response.metadata.items\n\n\n    let dimension;\n\n    if (metadata[id]) {\n      dimension = metadata[id];\n    } else {\n      const {\n        dimensionId\n      } = extractDimensionIdParts(id);\n      dimension = metadata[dimensionId];\n    }\n\n    if (!dimension) {\n      return null;\n    }\n\n    if (sourceAxis === DIMENSION_PANEL_SOURCE) {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: cx(styles.overlay, styles.dimensionItem)\n      }, /*#__PURE__*/React.createElement(DimensionItemBase, _extends({}, dimension, {\n        dragging: true\n      })));\n    }\n\n    const conditionsTexts = getConditionsTexts({\n      conditions: chipConditions,\n      metadata,\n      dimension,\n      formatValueOptions: {\n        digitGroupSeparator,\n        skipRounding: false\n      }\n    });\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: cx(chipStyles.chip, chipStyles.dragging, styles.overlay, {\n        [chipStyles.chipEmpty]: sourceAxis === AXIS_ID_FILTERS && !chipItems.length && !((_chipConditions$condi = chipConditions.condition) !== null && _chipConditions$condi !== void 0 && _chipConditions$condi.length) && !chipConditions.legendSet\n      })\n    }, /*#__PURE__*/React.createElement(ChipBase, {\n      dimension: dimension,\n      conditionsLength: conditionsTexts.length,\n      itemsLength: chipItems.length\n    }));\n  };\n\n  const rearrangeLayoutDimensions = _ref5 => {\n    let {\n      sourceAxisId,\n      sourceIndex,\n      destinationAxisId,\n      destinationIndex\n    } = _ref5;\n    const destItems = Array.from(layout[destinationAxisId]);\n    const newIndex = destinationIndex !== LAST_POSITION ? destinationIndex : destItems.length;\n    const sourceList = Array.from(layout[sourceAxisId]);\n    const [moved] = sourceList.splice(sourceIndex, 1);\n\n    if (sourceAxisId === destinationAxisId) {\n      sourceList.splice(newIndex, 0, moved);\n      dispatch(acSetUiLayout({ ...layout,\n        [sourceAxisId]: sourceList\n      }));\n    } else {\n      dispatch(acAddUiLayoutDimensions({\n        [moved]: {\n          axisId: destinationAxisId,\n          index: newIndex\n        }\n      }));\n    }\n  };\n\n  const addDimensionToLayout = _ref6 => {\n    let {\n      axisId,\n      index,\n      dimensionId\n    } = _ref6;\n    const sourceList = Array.from(layout[axisId]);\n    const idx = index !== LAST_POSITION ? index : sourceList.length;\n    dispatch(acAddUiLayoutDimensions({\n      [dimensionId]: {\n        axisId,\n        index: idx\n      }\n    })); //TODO: Add onDropWithoutItems\n  };\n\n  const onDragStart = _ref7 => {\n    let {\n      active\n    } = _ref7;\n    const id = getIdFromDraggingId(active.id);\n    setSourceAxis(active.data.current.sortable.containerId);\n    dispatch(acSetUiDraggingId(active.id));\n    dispatch(acAddMetadata({\n      [id]: {\n        id,\n        name: active.data.current.name,\n        dimensionType: active.data.current.dimensionType,\n        valueType: active.data.current.valueType,\n        optionSet: active.data.current.optionSet\n      }\n    }));\n  };\n\n  const onDragCancel = () => {\n    dispatch(acSetUiDraggingId(null));\n  };\n\n  const onDragEnd = result => {\n    var _over$data, _over$data$current, _over$data$current$so, _over$data$current2, _over$data$current2$s, _over$data$current3, _over$data$current3$s;\n\n    const {\n      active,\n      over\n    } = result;\n\n    if (!(over !== null && over !== void 0 && over.id) || (over === null || over === void 0 ? void 0 : (_over$data = over.data) === null || _over$data === void 0 ? void 0 : (_over$data$current = _over$data.current) === null || _over$data$current === void 0 ? void 0 : (_over$data$current$so = _over$data$current.sortable) === null || _over$data$current$so === void 0 ? void 0 : _over$data$current$so.containerId) === DIMENSION_PANEL_SOURCE) {\n      // dropped over non-droppable or over dimension panel\n      onDragCancel();\n      return;\n    }\n\n    const sourceAxisId = active.data.current.sortable.containerId;\n    const destinationAxisId = (((_over$data$current2 = over.data.current) === null || _over$data$current2 === void 0 ? void 0 : (_over$data$current2$s = _over$data$current2.sortable) === null || _over$data$current2$s === void 0 ? void 0 : _over$data$current2$s.containerId) || over.id).split('-')[0];\n    let destinationIndex = ((_over$data$current3 = over.data.current) === null || _over$data$current3 === void 0 ? void 0 : (_over$data$current3$s = _over$data$current3.sortable) === null || _over$data$current3$s === void 0 ? void 0 : _over$data$current3$s.index) || FIRST_POSITION;\n    const isDroppingInFirstPosition = [\"\".concat(AXIS_ID_COLUMNS, \"-\").concat(FIRST), \"\".concat(AXIS_ID_FILTERS, \"-\").concat(FIRST)].includes(over.id);\n    const isDroppingInLastPosition = [\"\".concat(AXIS_ID_COLUMNS, \"-\").concat(LAST), \"\".concat(AXIS_ID_FILTERS, \"-\").concat(LAST)].includes(over.id);\n\n    if (sourceAxisId === DIMENSION_PANEL_SOURCE) {\n      if (isDroppingInFirstPosition) {\n        destinationIndex = FIRST_POSITION;\n      } else if (isDroppingInLastPosition) {\n        destinationIndex = LAST_POSITION;\n      } else {\n        ++destinationIndex;\n      }\n\n      addDimensionToLayout({\n        axisId: destinationAxisId,\n        index: destinationIndex,\n        dimensionId: getIdFromDraggingId(active.id)\n      });\n    } else {\n      const sourceIndex = active.data.current.sortable.index;\n\n      if (sourceAxisId !== destinationAxisId) {\n        ++destinationIndex;\n      }\n\n      if (isDroppingInFirstPosition) {\n        destinationIndex = FIRST_POSITION;\n      } else if (isDroppingInLastPosition) {\n        destinationIndex = LAST_POSITION;\n      }\n\n      rearrangeLayoutDimensions({\n        sourceAxisId,\n        sourceIndex,\n        destinationAxisId,\n        destinationIndex\n      });\n    }\n\n    onDragCancel();\n  };\n\n  return /*#__PURE__*/React.createElement(DndContext, {\n    collisionDetection: rectIntersectionCustom,\n    onDragStart: onDragStart,\n    onDragEnd: onDragEnd,\n    onDragCancel: onDragCancel,\n    sensors: sensors\n  }, children, /*#__PURE__*/React.createElement(DragOverlay, {\n    dropAnimation: null\n  }, getDragOverlay()));\n};\n\nOuterDndContext.propTypes = {\n  children: PropTypes.node\n};\nexport default OuterDndContext;","import PropTypes from 'prop-types';\nimport React, { forwardRef } from 'react';\nimport classes from './styles/MenuButton.module.css';\nconst MenuButton = /*#__PURE__*/forwardRef((_ref, ref) => {\n  let {\n    children,\n    disabled,\n    onClick\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"button\", {\n    ref: ref,\n    className: classes.menuButton,\n    disabled: disabled,\n    onClick: onClick\n  }, children);\n});\nMenuButton.displayName = 'MenuButton';\nMenuButton.propTypes = {\n  children: PropTypes.node,\n  disabled: PropTypes.bool,\n  onClick: PropTypes.func\n};\nexport default MenuButton;","export const DOWNLOAD_TYPE_PLAIN = 'plain';\nexport const DOWNLOAD_TYPE_TABLE = 'table';\nexport const FILE_FORMAT_CSV = 'csv';\nexport const FILE_FORMAT_HTML_CSS = 'html+css';\nexport const FILE_FORMAT_JSON = 'json';\nexport const FILE_FORMAT_XLS = 'xls';\nexport const FILE_FORMAT_XML = 'xml';\nexport const ID_SCHEME_UID = 'UID';\nexport const ID_SCHEME_CODE = 'CODE';\nexport const ID_SCHEME_NAME = 'NAME';","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport i18n from '@dhis2/d2-i18n';\nimport { MenuItem, MenuSectionHeader } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { DOWNLOAD_TYPE_PLAIN, ID_SCHEME_UID, ID_SCHEME_CODE, ID_SCHEME_NAME } from './constants.js';\nexport const PlainDataSourceSubMenu = _ref => {\n  let {\n    download,\n    format,\n    label,\n    ...menuItemProps\n  } = _ref;\n  return /*#__PURE__*/React.createElement(MenuItem, _extends({\n    label: label\n  }, menuItemProps), /*#__PURE__*/React.createElement(MenuSectionHeader, {\n    label: i18n.t('Metadata ID scheme')\n  }), /*#__PURE__*/React.createElement(MenuItem, {\n    label: i18n.t('ID'),\n    onClick: () => download(DOWNLOAD_TYPE_PLAIN, format, ID_SCHEME_UID)\n  }), /*#__PURE__*/React.createElement(MenuItem, {\n    label: i18n.t('Code'),\n    onClick: () => download(DOWNLOAD_TYPE_PLAIN, format, ID_SCHEME_CODE)\n  }), /*#__PURE__*/React.createElement(MenuItem, {\n    label: i18n.t('Name'),\n    onClick: () => download(DOWNLOAD_TYPE_PLAIN, format, ID_SCHEME_NAME)\n  }));\n};\nPlainDataSourceSubMenu.propTypes = {\n  download: PropTypes.func.isRequired,\n  format: PropTypes.string.isRequired,\n  label: PropTypes.string.isRequired\n};","import i18n from '@dhis2/d2-i18n';\nimport { FlyoutMenu, MenuItem, MenuSectionHeader } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { DOWNLOAD_TYPE_TABLE, FILE_FORMAT_HTML_CSS, FILE_FORMAT_CSV, FILE_FORMAT_XLS, FILE_FORMAT_JSON, FILE_FORMAT_XML } from './constants.js';\nimport { PlainDataSourceSubMenu } from './PlainDataSourceSubMenu.js';\n\nconst DownloadMenu = _ref => {\n  let {\n    download\n  } = _ref;\n  return /*#__PURE__*/React.createElement(FlyoutMenu, null, /*#__PURE__*/React.createElement(MenuSectionHeader, {\n    label: i18n.t('HTML')\n  }), /*#__PURE__*/React.createElement(MenuItem, {\n    label: i18n.t('HTML+CSS (.html+css)'),\n    onClick: () => download(DOWNLOAD_TYPE_TABLE, FILE_FORMAT_HTML_CSS)\n  }), /*#__PURE__*/React.createElement(MenuSectionHeader, {\n    label: i18n.t('Plain data source')\n  }), /*#__PURE__*/React.createElement(PlainDataSourceSubMenu, {\n    download: download,\n    label: i18n.t('JSON'),\n    format: FILE_FORMAT_JSON\n  }), /*#__PURE__*/React.createElement(PlainDataSourceSubMenu, {\n    download: download,\n    label: i18n.t('XML'),\n    format: FILE_FORMAT_XML\n  }), /*#__PURE__*/React.createElement(PlainDataSourceSubMenu, {\n    download: download,\n    label: i18n.t('Microsoft Excel'),\n    format: FILE_FORMAT_XLS\n  }), /*#__PURE__*/React.createElement(PlainDataSourceSubMenu, {\n    download: download,\n    label: i18n.t('CSV'),\n    format: FILE_FORMAT_CSV\n  }));\n};\n\nDownloadMenu.propTypes = {\n  download: PropTypes.func.isRequired\n};\nexport { DownloadMenu };","import { AXIS_ID_COLUMNS, AXIS_ID_ROWS, AXIS_ID_FILTERS, Analytics, useCachedDataQuery } from '@dhis2/analytics';\nimport { useDataEngine } from '@dhis2/app-runtime';\nimport { useEffect, useState, useRef, useCallback } from 'react';\nimport { useSelector } from 'react-redux';\nimport { BOOLEAN_VALUES, NULL_VALUE, VALUE_TYPE_BOOLEAN, VALUE_TYPE_TRUE_ONLY } from '../../modules/conditions.js';\nimport { DIMENSION_ID_PROGRAM_STATUS, DIMENSION_ID_EVENT_STATUS, DIMENSION_ID_CREATED_BY, DIMENSION_ID_LAST_UPDATED_BY, DIMENSION_IDS_TIME } from '../../modules/dimensionConstants.js';\nimport { USER_SETTINGS_DISPLAY_PROPERTY } from '../../modules/userSettings.js';\nimport { extractDimensionIdParts } from '../../modules/utils.js';\nimport { OUTPUT_TYPE_ENROLLMENT, OUTPUT_TYPE_EVENT, headersMap } from '../../modules/visualization.js';\nimport { sGetIsVisualizationLoading } from '../../reducers/loader.js';\nconst analyticsApiEndpointMap = {\n  [OUTPUT_TYPE_ENROLLMENT]: 'enrollments',\n  [OUTPUT_TYPE_EVENT]: 'events'\n};\nconst excludedDimensions = [DIMENSION_ID_CREATED_BY, DIMENSION_ID_LAST_UPDATED_BY];\n\nconst findOptionSetItem = (code, metaDataItems) => Object.values(metaDataItems).find(item => item.code === code);\n\nconst formatRowValue = (rowValue, header, metaDataItems) => {\n  var _findOptionSetItem, _metaDataItems$rowVal;\n\n  switch (header.valueType) {\n    case VALUE_TYPE_BOOLEAN:\n    case VALUE_TYPE_TRUE_ONLY:\n      return BOOLEAN_VALUES[rowValue || NULL_VALUE];\n\n    default:\n      return header.optionSet ? ((_findOptionSetItem = findOptionSetItem(rowValue, metaDataItems)) === null || _findOptionSetItem === void 0 ? void 0 : _findOptionSetItem.name) || rowValue : ((_metaDataItems$rowVal = metaDataItems[rowValue]) === null || _metaDataItems$rowVal === void 0 ? void 0 : _metaDataItems$rowVal.name) || rowValue;\n  }\n};\n\nconst isTimeDimension = dimensionId => DIMENSION_IDS_TIME.has(dimensionId);\n\nconst getAnalyticsEndpoint = outputType => analyticsApiEndpointMap[outputType];\n\nconst getAdaptedVisualization = visualization => {\n  const parameters = {};\n\n  const adaptDimensions = dimensions => {\n    const adaptedDimensions = [];\n    dimensions.forEach(dimensionObj => {\n      const dimensionId = dimensionObj.dimension;\n\n      if (isTimeDimension(dimensionId) || dimensionId === DIMENSION_ID_EVENT_STATUS || dimensionId === DIMENSION_ID_PROGRAM_STATUS) {\n        var _dimensionObj$items;\n\n        if ((_dimensionObj$items = dimensionObj.items) !== null && _dimensionObj$items !== void 0 && _dimensionObj$items.length) {\n          var _dimensionObj$items2;\n\n          parameters[dimensionId] = (_dimensionObj$items2 = dimensionObj.items) === null || _dimensionObj$items2 === void 0 ? void 0 : _dimensionObj$items2.map(item => item.id);\n        }\n      } else if (!excludedDimensions.includes(dimensionId)) {\n        adaptedDimensions.push(dimensionObj);\n      }\n    });\n    return adaptedDimensions;\n  };\n\n  const adaptedColumns = adaptDimensions(visualization[AXIS_ID_COLUMNS]);\n  const adaptedRows = adaptDimensions(visualization[AXIS_ID_ROWS]);\n  const adaptedFilters = adaptDimensions(visualization[AXIS_ID_FILTERS]);\n  const headers = [...visualization[AXIS_ID_COLUMNS], ...visualization[AXIS_ID_ROWS]].map(_ref => {\n    var _repetition$indexes;\n\n    let {\n      dimension,\n      programStage,\n      repetition\n    } = _ref;\n    const headerId = programStage !== null && programStage !== void 0 && programStage.id ? \"\".concat(programStage.id, \".\").concat(dimension) : headersMap[dimension] || dimension;\n\n    if (repetition !== null && repetition !== void 0 && (_repetition$indexes = repetition.indexes) !== null && _repetition$indexes !== void 0 && _repetition$indexes.length) {\n      return repetition.indexes.map(index => headerId.replace(/\\./, \"[\".concat(index, \"].\")));\n    } else {\n      return headerId;\n    }\n  });\n  return {\n    adaptedVisualization: {\n      [AXIS_ID_COLUMNS]: adaptedColumns,\n      [AXIS_ID_ROWS]: adaptedRows,\n      [AXIS_ID_FILTERS]: adaptedFilters\n    },\n    headers,\n    parameters\n  };\n};\n\nconst fetchAnalyticsData = async _ref2 => {\n  let {\n    analyticsEngine,\n    visualization,\n    pageSize,\n    page,\n    relativePeriodDate,\n    sortField,\n    sortDirection,\n    nameProp\n  } = _ref2;\n  // TODO must be reviewed when PT comes around. Most likely LL and PT have quite different handling\n  const {\n    adaptedVisualization,\n    headers,\n    parameters\n  } = getAdaptedVisualization(visualization);\n  let req = new analyticsEngine.request().fromVisualization(adaptedVisualization).withParameters({\n    headers,\n    totalPages: false,\n    ...parameters\n  }).withProgram(visualization.program.id).withDisplayProperty(nameProp).withOutputType(visualization.outputType).withPageSize(pageSize).withPage(page).withIncludeMetadataDetails();\n\n  if (relativePeriodDate) {\n    req = req.withRelativePeriodDate(relativePeriodDate);\n  }\n\n  if (sortField) {\n    switch (sortDirection) {\n      case 'asc':\n        req = req.withAsc(sortField);\n        break;\n\n      case 'desc':\n        req = req.withDesc(sortField);\n        break;\n    }\n  }\n\n  const analyticsApiEndpoint = getAnalyticsEndpoint(visualization.outputType); // for 2.38 only /query is used (since only Line List is enabled)\n\n  const rawResponse = await analyticsEngine[analyticsApiEndpoint].getQuery(req);\n  return rawResponse;\n};\n\nconst extractHeaders = analyticsResponse => analyticsResponse.headers.map((header, index) => {\n  const result = { ...header,\n    index\n  };\n  const {\n    dimensionId,\n    programStageId\n  } = extractDimensionIdParts(header.name);\n\n  if (programStageId && analyticsResponse.headers.filter(h => h.name.includes(dimensionId)).length > 1) {\n    result.column += \" - \".concat(analyticsResponse.metaData.items[programStageId].name);\n  }\n\n  return result;\n});\n\nconst extractRows = (analyticsResponse, headers) => {\n  const filteredRows = [];\n\n  for (let rowIndex = 0, rowsCount = analyticsResponse.rows.length; rowIndex < rowsCount; rowIndex++) {\n    const row = analyticsResponse.rows[rowIndex];\n    const filteredRow = [];\n\n    for (let headerIndex = 0, headersCount = headers.length; headerIndex < headersCount; headerIndex++) {\n      const header = headers[headerIndex];\n      const rowValue = row[header.index];\n      filteredRow.push(formatRowValue(rowValue, header, analyticsResponse.metaData.items));\n    }\n\n    filteredRows.push(filteredRow);\n  }\n\n  return filteredRows;\n};\n\nconst useAnalyticsData = _ref3 => {\n  let {\n    visualization,\n    relativePeriodDate,\n    onResponseReceived,\n    pageSize,\n    page,\n    sortField,\n    sortDirection\n  } = _ref3;\n  const dataEngine = useDataEngine();\n  const isGlobalLoading = useSelector(sGetIsVisualizationLoading);\n  const [analyticsEngine] = useState(() => Analytics.getAnalytics(dataEngine));\n  const mounted = useRef(false);\n  const [loading, setLoading] = useState(true);\n  const [fetching, setFetching] = useState(true);\n  const [error, setError] = useState(undefined);\n  const [data, setData] = useState(null);\n  const {\n    userSettings\n  } = useCachedDataQuery();\n  const doFetch = useCallback(async () => {\n    try {\n      const analyticsResponse = await fetchAnalyticsData({\n        analyticsEngine,\n        page,\n        pageSize,\n        relativePeriodDate,\n        sortDirection,\n        sortField,\n        visualization,\n        nameProp: userSettings[USER_SETTINGS_DISPLAY_PROPERTY].toUpperCase()\n      });\n      const headers = extractHeaders(analyticsResponse);\n      const rows = extractRows(analyticsResponse, headers);\n      const pager = analyticsResponse.metaData.pager;\n      mounted.current && setError(undefined);\n      mounted.current && setData({\n        headers,\n        rows,\n        pager\n      });\n      onResponseReceived(analyticsResponse);\n    } catch (error) {\n      mounted.current && setError(error);\n    } finally {\n      mounted.current && setLoading(false);\n      mounted.current && setFetching(false);\n    }\n  }, [analyticsEngine, page, pageSize, relativePeriodDate, sortDirection, sortField, visualization]);\n  useEffect(() => {\n    /*\n     * Hack to prevent state updates on unmounted components\n     * needed because the analytics engine cannot cancel requests\n     */\n    mounted.current = true;\n    return () => {\n      mounted.current = false;\n    };\n  }, []);\n  useEffect(() => {\n    setFetching(true);\n    doFetch();\n  }, [visualization, page, pageSize, sortField, sortDirection, relativePeriodDate]);\n  useEffect(() => {\n    // Do a full reset when loading a new visualization\n    if (isGlobalLoading) {\n      setFetching(false);\n      setLoading(false);\n      setError(undefined);\n      setData(null);\n    }\n  }, [isGlobalLoading]);\n  return {\n    loading,\n    fetching,\n    error,\n    data,\n    isGlobalLoading\n  };\n};\n\nexport { useAnalyticsData, getAnalyticsEndpoint, getAdaptedVisualization };","import { Analytics } from '@dhis2/analytics';\nimport { useConfig, useDataEngine } from '@dhis2/app-runtime';\nimport { useRef, useState, useCallback } from 'react';\nimport { useSelector } from 'react-redux';\nimport { sGetCurrent } from '../../reducers/current.js';\nimport { getAnalyticsEndpoint, getAdaptedVisualization } from '../Visualization/useAnalyticsData.js';\nimport { DOWNLOAD_TYPE_PLAIN, ID_SCHEME_NAME, DOWNLOAD_TYPE_TABLE, FILE_FORMAT_HTML_CSS, FILE_FORMAT_CSV, FILE_FORMAT_XLS } from './constants.js';\n\nconst useDownloadMenu = relativePeriodDate => {\n  const current = useSelector(sGetCurrent);\n  const {\n    baseUrl\n  } = useConfig();\n  const dataEngine = useDataEngine();\n  const analyticsEngine = Analytics.getAnalytics(dataEngine);\n  const buttonRef = useRef();\n  const [isOpen, setIsOpen] = useState(false);\n  const download = useCallback((type, format, idScheme) => {\n    if (!current) {\n      return false;\n    }\n\n    let req = new analyticsEngine.request();\n    let target = '_top';\n    const {\n      adaptedVisualization,\n      headers,\n      parameters\n    } = getAdaptedVisualization(current);\n    const path = \"\".concat(getAnalyticsEndpoint(current.outputType), \"/query\");\n\n    switch (type) {\n      case DOWNLOAD_TYPE_TABLE:\n        req = req.fromVisualization(adaptedVisualization).withProgram(current.program.id).withOutputType(current.outputType).withPath(path).withFormat(format).withTableLayout().withColumns(current.columns.filter(column => column.dimension !== 'dy').map(column => column.dimension).join(';')).withRows(current.rows.filter(row => row.dimension !== 'dy').map(row => row.dimension).join(';')).withParameters({ ...parameters,\n          headers,\n          dataIdScheme: ID_SCHEME_NAME,\n          paging: false\n        }); // only for LL\n        // not sorted (see old ER)\n        //TODO\n        //displayPropertyName\n        //completedOnly (from options)\n        //hideEmptyColumns (from options)\n        //hideEmptyRows (from options)\n        //showHierarchy (from options)\n        //startDate\n        //endDate\n\n        target = format === FILE_FORMAT_HTML_CSS ? '_blank' : '_top';\n        break;\n\n      case DOWNLOAD_TYPE_PLAIN:\n        req = req // Perhaps the 2nd arg `passFilterAsDimension` should be false for the advanced submenu?\n        .fromVisualization(adaptedVisualization, true).withProgram(current.program.id).withOutputType(current.outputType).withPath(path).withFormat(format).withOutputIdScheme(idScheme).withParameters({ ...parameters,\n          headers,\n          paging: false\n        }); // TODO options\n        // startDate\n        // endDate\n        // displayProperty\n        // completedOnly\n        // hierarchyMeta (from options)\n        // outputType\n        // programStatus\n        // eventStatus\n        // limit\n        // sortOrder\n        // value\n        // aggregationType\n        // timeField\n        // orgUnitField\n        // collapsedDataDimensions\n        // useOrgUnit (URL)\n        // relativePeriodDate\n\n        target = [FILE_FORMAT_CSV, FILE_FORMAT_XLS].includes(format) ? '_top' : '_blank';\n        break;\n    } // TODO add common parameters\n    // if there are for both event/enrollment and PT/LL\n\n\n    if (relativePeriodDate) {\n      req = req.withRelativePeriodDate(relativePeriodDate);\n    }\n\n    const url = new URL(\"\".concat(baseUrl, \"/api/\").concat(req.buildUrl()), \"\".concat(window.location.origin).concat(window.location.pathname));\n    Object.entries(req.buildQuery()).forEach(_ref => {\n      let [key, value] = _ref;\n      return url.searchParams.append(key, value);\n    });\n    window.open(url, target);\n    setIsOpen(false);\n  }, [current, relativePeriodDate]);\n  return {\n    isOpen,\n    toggleOpen: () => setIsOpen(!isOpen),\n    disabled: !current,\n    download,\n    buttonRef\n  };\n};\n\nexport { useDownloadMenu };","import i18n from '@dhis2/d2-i18n';\nimport { Layer, Popper } from '@dhis2/ui';\nimport React, { useRef } from 'react';\nimport { default as MenuButton } from '../Toolbar/MenuBar/MenuButton.js';\nimport { DownloadMenu } from './DownloadMenu.js';\nimport { useDownloadMenu } from './useDownloadMenu.js';\n\nconst ToolbarDownloadDropdown = () => {\n  const buttonRef = useRef();\n  const {\n    isOpen,\n    toggleOpen,\n    disabled,\n    download\n  } = useDownloadMenu();\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(MenuButton, {\n    ref: buttonRef,\n    onClick: toggleOpen,\n    disabled: disabled\n  }, i18n.t('Download')), isOpen && /*#__PURE__*/React.createElement(Layer, {\n    onClick: toggleOpen\n  }, /*#__PURE__*/React.createElement(Popper, {\n    reference: buttonRef,\n    placement: \"bottom-start\"\n  }, /*#__PURE__*/React.createElement(DownloadMenu, {\n    download: download\n  }))));\n};\n\nexport { ToolbarDownloadDropdown };","import i18n from '@dhis2/d2-i18n';\nimport { DropdownButton } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { DownloadMenu } from './DownloadMenu.js';\nimport styles from './ModalDownloadDropdown.module.css';\nimport { useDownloadMenu } from './useDownloadMenu.js';\n\nconst ModalDownloadDropdown = _ref => {\n  let {\n    relativePeriodDate\n  } = _ref;\n  const {\n    isOpen,\n    toggleOpen,\n    disabled,\n    download\n  } = useDownloadMenu(relativePeriodDate);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.container\n  }, /*#__PURE__*/React.createElement(DropdownButton, {\n    component: /*#__PURE__*/React.createElement(DownloadMenu, {\n      download: download\n    }),\n    disabled: disabled,\n    onClick: toggleOpen,\n    open: isOpen,\n    secondary: true,\n    small: true\n  }, i18n.t('Download data from this date')));\n};\n\nModalDownloadDropdown.propTypes = {\n  relativePeriodDate: PropTypes.string\n};\nexport { ModalDownloadDropdown };","import { useState, useEffect } from 'react';\nimport { useSelector } from 'react-redux';\nimport { useDebounce } from '../../modules/utils.js';\nimport { sGetUiShowDetailsPanel, sGetUiShowAccessoryPanel } from '../../reducers/ui.js';\nconst PAGE_LEFT_SIDEBARS_WIDTH = 260;\nconst PAGE_RIGHT_SIDEBAR_WIDTH = 380;\nconst PAGE_PADDING = 2 * 4;\nconst PAGE_BORDER = 2 * 1;\nconst MODAL_SIDEBAR_WIDTH = 300;\nconst MODAL_GAP = 16;\nconst MODAL_SIDE_PADDING = 2 * 24;\nconst MODAL_SIDE_MARGINS = 2 * 128;\nconst className = '__scrollbar-width-test__';\nconst styles = \"\\n    .\".concat(className, \" {\\n        position: absolute;\\n        top: -9999px;\\n        width: 100px;\\n        height: 100px;\\n        overflow-y: scroll;\\n    }\\n\");\n\nconst scrollbarWidth = (() => {\n  const style = document.createElement('style');\n  style.innerHTML = styles;\n  const el = document.createElement('div');\n  el.classList.add(className);\n  document.body.appendChild(style);\n  document.body.appendChild(el);\n  const width = el.offsetWidth - el.clientWidth;\n  document.body.removeChild(style);\n  document.body.removeChild(el);\n  return width;\n})();\n\nconst computeOuterWidthInModal = _ref => {\n  let {\n    windowWidth\n  } = _ref;\n  return windowWidth - MODAL_SIDEBAR_WIDTH - MODAL_GAP - MODAL_SIDE_PADDING - MODAL_SIDE_MARGINS;\n};\n\nconst computeOuterWidthInPage = _ref2 => {\n  let {\n    windowWidth,\n    leftOpen,\n    rightOpen\n  } = _ref2;\n  let availableOuterWidth = windowWidth - PAGE_LEFT_SIDEBARS_WIDTH - PAGE_PADDING - PAGE_BORDER;\n\n  if (leftOpen) {\n    availableOuterWidth -= PAGE_LEFT_SIDEBARS_WIDTH;\n  }\n\n  if (rightOpen) {\n    availableOuterWidth -= PAGE_RIGHT_SIDEBAR_WIDTH;\n  }\n\n  return availableOuterWidth;\n};\n\nconst computeAvailableOuterWidth = _ref3 => {\n  let {\n    isInModal,\n    windowWidth,\n    leftOpen,\n    rightOpen\n  } = _ref3;\n  return isInModal ? computeOuterWidthInModal({\n    windowWidth\n  }) : computeOuterWidthInPage({\n    windowWidth,\n    leftOpen,\n    rightOpen\n  });\n};\n\nexport const useAvailableWidth = isInModal => {\n  const [windowWidth, setWindowWidth] = useState(window.innerWidth);\n  const debouncedWindowWidth = useDebounce(windowWidth, 150);\n  const leftOpen = useSelector(sGetUiShowAccessoryPanel);\n  const rightOpen = useSelector(sGetUiShowDetailsPanel);\n  const [availableOuterWidth, setAvailableOuterWidth] = useState(computeAvailableOuterWidth({\n    isInModal,\n    windowWidth,\n    leftOpen,\n    rightOpen\n  }));\n  useEffect(() => {\n    const onResize = () => {\n      setWindowWidth(window.innerWidth);\n    };\n\n    window.addEventListener('resize', onResize);\n    return () => {\n      window.removeEventListener('resize', onResize);\n    };\n  }, []);\n  useEffect(() => {\n    setAvailableOuterWidth(computeAvailableOuterWidth({\n      isInModal,\n      windowWidth: debouncedWindowWidth,\n      leftOpen,\n      rightOpen\n    }));\n  }, [isInModal, leftOpen, rightOpen, debouncedWindowWidth]);\n  return {\n    availableOuterWidth,\n    availableInnerWidth: availableOuterWidth - scrollbarWidth - PAGE_BORDER\n  };\n};","import { formatValue } from '@dhis2/analytics';\nimport i18n from '@dhis2/d2-i18n';\nimport { DataTable, DataTableRow, DataTableCell, DataTableColumnHeader, DataTableHead, DataTableBody, DataTableFoot, Pagination } from '@dhis2/ui';\nimport cx from 'classnames';\nimport moment from 'moment';\nimport PropTypes from 'prop-types';\nimport React, { useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux'; // TODO this action cannot be used and a callback prop should be passed instead\n\nimport { acSetLoadError } from '../../actions/loader.js'; // TODO this action cannot be used and a callback prop should be passed instead\n// when the plugin is used in dashboard, this feature should be disabled\n\nimport { acSetUiOpenDimensionModal } from '../../actions/ui.js';\nimport { VALUE_TYPE_DATE, VALUE_TYPE_DATETIME, VALUE_TYPE_TEXT, VALUE_TYPE_URL } from '../../modules/conditions.js';\nimport { DIMENSION_ID_EVENT_STATUS, DIMENSION_ID_PROGRAM_STATUS, DIMENSION_ID_LAST_UPDATED } from '../../modules/dimensionConstants.js';\nimport { dataAccessError, genericServerError, indicatorError, noPeriodError } from '../../modules/error.js';\nimport { DISPLAY_DENSITY_COMFORTABLE, DISPLAY_DENSITY_COMPACT, FONT_SIZE_LARGE, FONT_SIZE_NORMAL, FONT_SIZE_SMALL } from '../../modules/options.js';\nimport { headersMap } from '../../modules/visualization.js';\nimport { sGetMetadata } from '../../reducers/metadata.js';\nimport styles from './styles/Visualization.module.css';\nimport { useAnalyticsData } from './useAnalyticsData.js';\nimport { useAvailableWidth } from './useAvailableWidth.js';\nexport const DEFAULT_SORT_DIRECTION = 'asc';\nexport const FIRST_PAGE = 1;\nexport const PAGE_SIZE = 100;\n\nconst getFontSizeClass = fontSize => {\n  switch (fontSize) {\n    case FONT_SIZE_LARGE:\n      return styles.fontSizeLarge;\n\n    case FONT_SIZE_SMALL:\n      return styles.fontSizeSmall;\n\n    case FONT_SIZE_NORMAL:\n    default:\n      return styles.fontSizeNormal;\n  }\n};\n\nconst getSizeClass = displayDensity => {\n  switch (displayDensity) {\n    case DISPLAY_DENSITY_COMFORTABLE:\n      return styles.sizeComfortable;\n\n    case DISPLAY_DENSITY_COMPACT:\n      return styles.sizeCompact;\n\n    default:\n      return styles.sizeNormal;\n  }\n};\n\nexport const Visualization = _ref => {\n  let {\n    visualization,\n    onResponseReceived,\n    relativePeriodDate\n  } = _ref;\n  const dispatch = useDispatch(); // TODO remove need for metadata\n\n  const metadata = useSelector(sGetMetadata);\n  const [{\n    sortField,\n    sortDirection,\n    pageSize,\n    page\n  }, setSorting] = useState({\n    sortField: null,\n    sortDirection: DEFAULT_SORT_DIRECTION,\n    page: FIRST_PAGE,\n    pageSize: PAGE_SIZE\n  });\n  const isInModal = !!relativePeriodDate;\n  const {\n    availableOuterWidth,\n    availableInnerWidth\n  } = useAvailableWidth(isInModal);\n  const {\n    fetching,\n    error,\n    data\n  } = useAnalyticsData({\n    visualization,\n    relativePeriodDate,\n    onResponseReceived,\n    pageSize,\n    page,\n    sortField,\n    sortDirection\n  });\n\n  if (error) {\n    var _error$details;\n\n    let output;\n\n    if ((_error$details = error.details) !== null && _error$details !== void 0 && _error$details.errorCode) {\n      switch (error.details.errorCode) {\n        case 'E7205':\n          output = noPeriodError();\n          break;\n\n        case 'E7132':\n          output = indicatorError();\n          break;\n\n        case 'E7121':\n          output = dataAccessError();\n          break;\n\n        default:\n          output = genericServerError();\n      }\n    } else {\n      output = genericServerError();\n    }\n\n    dispatch(acSetLoadError(output));\n  }\n\n  if (!data || error) {\n    return null;\n  }\n\n  const sizeClass = getSizeClass(visualization.displayDensity);\n  const fontSizeClass = getFontSizeClass(visualization.fontSize);\n  const colSpan = String(Math.max(data.headers.length, 1));\n\n  const sortData = _ref2 => {\n    let {\n      name,\n      direction\n    } = _ref2;\n    return setSorting({\n      sortField: name,\n      sortDirection: direction,\n      pageSize,\n      page: FIRST_PAGE\n    });\n  };\n\n  const setPage = pageNum => setSorting({\n    sortField,\n    sortDirection,\n    pageSize,\n    page: pageNum\n  });\n\n  const setPageSize = pageSizeNum => setSorting({\n    sortField,\n    sortDirection,\n    pageSize: pageSizeNum,\n    page: FIRST_PAGE\n  });\n\n  const formatCellValue = (value, header) => {\n    if ([headersMap[DIMENSION_ID_EVENT_STATUS], headersMap[DIMENSION_ID_PROGRAM_STATUS]].includes(header === null || header === void 0 ? void 0 : header.name)) {\n      var _metadata$value;\n\n      // TODO remove metadata use\n      return ((_metadata$value = metadata[value]) === null || _metadata$value === void 0 ? void 0 : _metadata$value.name) || value;\n    } else if ([VALUE_TYPE_DATE, VALUE_TYPE_DATETIME].includes(header === null || header === void 0 ? void 0 : header.valueType)) {\n      return value && moment(value).format(header.name === headersMap[DIMENSION_ID_LAST_UPDATED] || (header === null || header === void 0 ? void 0 : header.valueType) === VALUE_TYPE_DATETIME ? 'yyyy-MM-DD hh:mm' : 'yyyy-MM-DD');\n    } else if ((header === null || header === void 0 ? void 0 : header.valueType) === VALUE_TYPE_URL) {\n      return /*#__PURE__*/React.createElement(\"a\", {\n        href: value,\n        target: \"_blank\",\n        rel: \"noreferrer\"\n      }, value);\n    } else {\n      return formatValue(value, (header === null || header === void 0 ? void 0 : header.valueType) || VALUE_TYPE_TEXT, {\n        digitGroupSeparator: visualization.digitGroupSeparator,\n        skipRounding: false // TODO should there be an option for this?\n\n      });\n    }\n  };\n\n  const formatCellHeader = header => {\n    let headerName = header.column;\n    const dimensionId = Number.isInteger(header === null || header === void 0 ? void 0 : header.stageOffset) ? header.name.replace(/\\[-?\\d+\\]/, '') : header.name;\n\n    if (Number.isInteger(header.stageOffset)) {\n      let postfix;\n\n      if (header.stageOffset === 0) {\n        postfix = i18n.t('most recent');\n      } else if (header.stageOffset === 1) {\n        postfix = i18n.t('oldest');\n      } else if (header.stageOffset > 1) {\n        postfix = i18n.t('oldest {{repeatEventIndex}}', {\n          repeatEventIndex: \"+\".concat(header.stageOffset - 1)\n        });\n      } else if (header.stageOffset < 0) {\n        postfix = i18n.t('most recent {{repeatEventIndex}}', {\n          repeatEventIndex: header.stageOffset\n        });\n      }\n\n      headerName = \"\".concat(header.column, \" (\").concat(postfix, \")\");\n    }\n\n    return /*#__PURE__*/React.createElement(\"span\", {\n      className: cx(styles.headerCell, styles.dimensionModalHandler),\n      onClick: () => dispatch(acSetUiOpenDimensionModal(dimensionId))\n    }, headerName);\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.wrapper\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(styles.fetchIndicator, {\n      [styles.fetching]: fetching\n    })\n  }, /*#__PURE__*/React.createElement(DataTable, {\n    scrollHeight: isInModal ? 'calc(100vh - 285px)' : '100%',\n    width: \"auto\",\n    scrollWidth: \"\".concat(availableOuterWidth, \"px\"),\n    className: styles.dataTable\n  }, /*#__PURE__*/React.createElement(DataTableHead, null, /*#__PURE__*/React.createElement(DataTableRow, null, data.headers.map((header, index) => header ? /*#__PURE__*/React.createElement(DataTableColumnHeader, {\n    fixed: true,\n    top: \"0\",\n    key: header.name,\n    name: header.name,\n    onSortIconClick: sortData,\n    sortDirection: header.name === sortField ? sortDirection : 'default',\n    className: cx(styles.headerCell, fontSizeClass, sizeClass)\n  }, formatCellHeader(header)) : /*#__PURE__*/React.createElement(DataTableColumnHeader, {\n    fixed: true,\n    top: \"0\",\n    key: \"undefined_\".concat(index) // FIXME this is due to pe not being present in headers, needs special handling\n    ,\n    className: cx(styles.headerCell, fontSizeClass, sizeClass)\n  })))), /*#__PURE__*/React.createElement(DataTableBody, null, data.rows.map((row, index) => /*#__PURE__*/React.createElement(DataTableRow, {\n    key: index\n  }, row.map((value, index) => /*#__PURE__*/React.createElement(DataTableCell, {\n    key: index,\n    className: cx(styles.cell, fontSizeClass, sizeClass)\n  }, formatCellValue(value, data.headers[index])))))), /*#__PURE__*/React.createElement(DataTableFoot, {\n    className: styles.stickyFooter\n  }, /*#__PURE__*/React.createElement(DataTableRow, null, /*#__PURE__*/React.createElement(DataTableCell, {\n    colSpan: colSpan,\n    staticStyle: true,\n    className: styles.footerCell\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(styles.stickyNavigation, sizeClass),\n    style: {\n      maxWidth: availableInnerWidth\n    }\n  }, /*#__PURE__*/React.createElement(Pagination, {\n    disabled: fetching,\n    page: data.pager.page,\n    pageSize: data.pager.pageSize,\n    isLastPage: data.pager.isLastPage,\n    onPageChange: setPage,\n    onPageSizeChange: setPageSize,\n    pageSizeSelectText: i18n.t('Rows per page'),\n    pageLength: data.rows.length,\n    pageSummaryText: _ref3 => {\n      let {\n        firstItem,\n        lastItem,\n        page\n      } = _ref3;\n      return i18n.t('Page {{page}}, row {{firstItem}}-{{lastItem}}', {\n        firstItem,\n        lastItem,\n        page\n      });\n    }\n  }))))))));\n};\nVisualization.defaultProps = {\n  onResponseReceived: Function.prototype\n};\nVisualization.propTypes = {\n  visualization: PropTypes.object.isRequired,\n  onResponseReceived: PropTypes.func.isRequired,\n  relativePeriodDate: PropTypes.string\n};","import { useDataMutation } from '@dhis2/app-runtime';\nimport i18n from '@dhis2/d2-i18n';\nimport { IconDelete16 } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { MessageIconButton } from '../common/index.js';\nconst mutation = {\n  resource: 'interpretations',\n  id: _ref => {\n    let {\n      interpretationId,\n      commentId\n    } = _ref;\n    return \"\".concat(interpretationId, \"/comments/\").concat(commentId);\n  },\n  type: 'delete'\n};\n\nconst CommentDeleteButton = _ref2 => {\n  let {\n    commentId,\n    interpretationId,\n    onComplete\n  } = _ref2;\n  const [remove, {\n    loading\n  }] = useDataMutation(mutation, {\n    onComplete,\n    variables: {\n      commentId,\n      interpretationId\n    }\n  });\n  return /*#__PURE__*/React.createElement(MessageIconButton, {\n    tooltipContent: i18n.t('Delete'),\n    iconComponent: IconDelete16,\n    onClick: remove,\n    disabled: loading\n  });\n};\n\nCommentDeleteButton.propTypes = {\n  commentId: PropTypes.string.isRequired,\n  interpretationId: PropTypes.string.isRequired,\n  onComplete: PropTypes.func.isRequired\n};\nexport { CommentDeleteButton };","import _JSXStyle from \"styled-jsx/style\";\nimport { useDataMutation } from '@dhis2/app-runtime';\nimport i18n from '@dhis2/d2-i18n';\nimport { Button, spacers, colors } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { useState, useRef } from 'react';\nimport { MessageEditorContainer, RichTextEditor, MessageButtonStrip } from '../common/index.js';\nexport const CommentUpdateForm = _ref => {\n  let {\n    interpretationId,\n    commentId,\n    currentUser,\n    text,\n    close,\n    onComplete\n  } = _ref;\n  const [commentText, setCommentText] = useState(text || '');\n  const updateMutationRef = useRef({\n    resource: \"interpretations/\".concat(interpretationId, \"/comments/\").concat(commentId),\n    type: 'update',\n    partial: false,\n    data: _ref2 => {\n      let {\n        commentText\n      } = _ref2;\n      return commentText;\n    }\n  });\n  const [update, {\n    loading,\n    error\n  }] = useDataMutation(updateMutationRef.current, {\n    onComplete: () => {\n      onComplete();\n      close();\n    }\n  });\n  const errorText = error ? error.message || i18n.t('Could not update comment') : '';\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: _JSXStyle.dynamic([[\"2690082310\", [spacers.dp8, spacers.dp8, colors.grey100]]]) + \" \" + \"message\"\n  }, /*#__PURE__*/React.createElement(MessageEditorContainer, {\n    currentUser: currentUser\n  }, /*#__PURE__*/React.createElement(RichTextEditor, {\n    inputPlaceholder: i18n.t('Enter comment text'),\n    onChange: setCommentText,\n    value: commentText,\n    disabled: loading,\n    errorText: errorText\n  }), /*#__PURE__*/React.createElement(MessageButtonStrip, null, /*#__PURE__*/React.createElement(Button, {\n    loading: loading,\n    primary: true,\n    small: true,\n    onClick: () => update({\n      commentText\n    })\n  }, i18n.t('Update')), /*#__PURE__*/React.createElement(Button, {\n    disabled: loading,\n    secondary: true,\n    small: true,\n    onClick: close\n  }, i18n.t('Cancel')))), /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: \"2690082310\",\n    dynamic: [spacers.dp8, spacers.dp8, colors.grey100]\n  }, [\".message.__jsx-style-dynamic-selector{padding:0 \".concat(spacers.dp8, \" \").concat(spacers.dp8, \";background-color:\").concat(colors.grey100, \";border-radius:5px;}\")]));\n};\nCommentUpdateForm.propTypes = {\n  close: PropTypes.func.isRequired,\n  commentId: PropTypes.string.isRequired,\n  currentUser: PropTypes.object.isRequired,\n  interpretationId: PropTypes.string.isRequired,\n  onComplete: PropTypes.func.isRequired,\n  text: PropTypes.string\n};","import i18n from '@dhis2/d2-i18n';\nimport { IconEdit16 } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { useState } from 'react';\nimport { Message, MessageIconButton, MessageStatsBar } from '../common/index.js';\nimport { CommentDeleteButton } from './CommentDeleteButton.js';\nimport { CommentUpdateForm } from './CommentUpdateForm.js';\n\nconst Comment = _ref => {\n  let {\n    comment,\n    currentUser,\n    interpretationId,\n    onThreadUpdated\n  } = _ref;\n  const [isUpdateMode, setIsUpdateMode] = useState(false);\n  return isUpdateMode ? /*#__PURE__*/React.createElement(CommentUpdateForm, {\n    close: () => setIsUpdateMode(false),\n    commentId: comment.id,\n    interpretationId: interpretationId,\n    onComplete: () => onThreadUpdated(false),\n    text: comment.text,\n    currentUser: currentUser\n  }) : /*#__PURE__*/React.createElement(Message, {\n    text: comment.text,\n    created: comment.created,\n    username: comment.createdBy.displayName\n  }, /*#__PURE__*/React.createElement(MessageStatsBar, null, comment.access.update && /*#__PURE__*/React.createElement(MessageIconButton, {\n    iconComponent: IconEdit16,\n    tooltipContent: i18n.t('Edit'),\n    onClick: () => setIsUpdateMode(true)\n  }), comment.access.delete && /*#__PURE__*/React.createElement(CommentDeleteButton, {\n    commentId: comment.id,\n    interpretationId: interpretationId,\n    onComplete: () => onThreadUpdated(true)\n  })));\n};\n\nComment.propTypes = {\n  comment: PropTypes.object.isRequired,\n  currentUser: PropTypes.object.isRequired,\n  interpretationId: PropTypes.string.isRequired,\n  onThreadUpdated: PropTypes.func.isRequired\n};\nexport { Comment };","import { useDataMutation } from '@dhis2/app-runtime';\nimport i18n from '@dhis2/d2-i18n';\nimport { Button } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { useRef, useState } from 'react';\nimport { RichTextEditor, MessageEditorContainer, MessageButtonStrip, MessageInput } from '../common/index.js';\nexport const CommentAddForm = _ref => {\n  let {\n    interpretationId,\n    currentUser,\n    onSave,\n    focusRef\n  } = _ref;\n  const [showRichTextEditor, setShowRichTextEditor] = useState(false);\n  const [commentText, setCommentText] = useState('');\n  const saveMutationRef = useRef({\n    resource: \"interpretations/\".concat(interpretationId, \"/comments\"),\n    type: 'create',\n    data: _ref2 => {\n      let {\n        commentText\n      } = _ref2;\n      return commentText;\n    }\n  });\n  const [save, {\n    loading\n  }] = useDataMutation(saveMutationRef.current, {\n    onComplete: () => {\n      setShowRichTextEditor(false);\n      setCommentText('');\n      onSave();\n    }\n  });\n  const inputPlaceholder = i18n.t('Write a reply');\n  return /*#__PURE__*/React.createElement(MessageEditorContainer, {\n    currentUser: currentUser\n  }, showRichTextEditor ? /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(RichTextEditor, {\n    inputPlaceholder: inputPlaceholder,\n    onChange: setCommentText,\n    value: commentText,\n    ref: focusRef,\n    disabled: loading\n  }), /*#__PURE__*/React.createElement(MessageButtonStrip, null, /*#__PURE__*/React.createElement(Button, {\n    primary: true,\n    small: true,\n    onClick: () => save({\n      commentText\n    }),\n    loading: loading\n  }, i18n.t('Post reply')), /*#__PURE__*/React.createElement(Button, {\n    secondary: true,\n    small: true,\n    disabled: loading,\n    onClick: () => {\n      setCommentText('');\n      setShowRichTextEditor(false);\n    }\n  }, i18n.t('Cancel')))) : /*#__PURE__*/React.createElement(MessageInput, {\n    onFocus: () => setShowRichTextEditor(true),\n    placeholder: inputPlaceholder,\n    ref: focusRef\n  }));\n};\nCommentAddForm.propTypes = {\n  currentUser: PropTypes.object.isRequired,\n  focusRef: PropTypes.object.isRequired,\n  interpretationId: PropTypes.string.isRequired,\n  onSave: PropTypes.func\n};","import _JSXStyle from \"styled-jsx/style\";\nimport { IconClock16, colors } from '@dhis2/ui';\nimport cx from 'classnames';\nimport moment from 'moment';\nimport PropTypes from 'prop-types';\nimport React, { useRef, useEffect } from 'react';\nimport { Interpretation } from '../common/index.js';\nimport { Comment } from './Comment.js';\nimport { CommentAddForm } from './CommentAddForm.js';\n\nconst InterpretationThread = _ref => {\n  let {\n    currentUser,\n    fetching,\n    interpretation,\n    onInterpretationDeleted,\n    initialFocus,\n    onThreadUpdated,\n    downloadMenuComponent: DownloadMenu\n  } = _ref;\n  const focusRef = useRef();\n  useEffect(() => {\n    if (initialFocus && focusRef.current) {\n      window.requestAnimationFrame(() => {\n        focusRef.current.focus();\n      });\n    }\n  }, [initialFocus, focusRef.current]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"jsx-2924001448\" + \" \" + (cx('container', {\n      fetching\n    }) || \"\")\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"jsx-2924001448\" + \" \" + 'scrollbox'\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"jsx-2924001448\" + \" \" + 'title'\n  }, /*#__PURE__*/React.createElement(IconClock16, {\n    color: colors.grey700\n  }), moment(interpretation.created).format('LLL')), /*#__PURE__*/React.createElement(DownloadMenu, {\n    relativePeriodDate: interpretation.created,\n    className: \"jsx-2924001448\"\n  }), /*#__PURE__*/React.createElement(Interpretation, {\n    currentUser: currentUser,\n    interpretation: interpretation,\n    onReplyIconClick: () => {\n      var _focusRef$current;\n\n      return (_focusRef$current = focusRef.current) === null || _focusRef$current === void 0 ? void 0 : _focusRef$current.focus();\n    },\n    onUpdated: () => onThreadUpdated(true),\n    onDeleted: onInterpretationDeleted\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"jsx-2924001448\" + \" \" + 'comments'\n  }, interpretation.comments.map(comment => /*#__PURE__*/React.createElement(Comment, {\n    key: comment.id,\n    comment: comment,\n    currentUser: currentUser,\n    interpretationId: interpretation.id,\n    onThreadUpdated: onThreadUpdated\n  }))), /*#__PURE__*/React.createElement(CommentAddForm, {\n    currentUser: currentUser,\n    interpretationId: interpretation.id,\n    onSave: () => onThreadUpdated(true),\n    focusRef: focusRef\n  })), /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: \"2924001448\"\n  }, [\".container.jsx-2924001448{position:relative;overflow:hidden;max-height:calc(100vh - 285px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}\", \".container.fetching.jsx-2924001448::before{content:'';position:absolute;inset:0px;background-color:rgba(255,255,255,0.8);}\", \".container.fetching.jsx-2924001448::after{content:'';position:absolute;top:calc(50% - 12px);left:calc(50% - 12px);width:24px;height:24px;border-width:4px;border-style:solid;border-color:rgba(110,122,138,0.15) rgba(110,122,138,0.15) rgb(20,124,215);border-image:initial;border-radius:50%;-webkit-animation:1s linear 0s infinite normal none running rotation-jsx-2924001448;animation:1s linear 0s infinite normal none running rotation-jsx-2924001448;}\", \".scrollbox.jsx-2924001448{overflow-y:auto;-webkit-scroll-behavior:smooth;-moz-scroll-behavior:smooth;-ms-scroll-behavior:smooth;scroll-behavior:smooth;}\", \".title.jsx-2924001448{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;gap:var(--spacers-dp8);color:var(--colors-grey900);font-size:14px;line-height:18px;}\", \".comments.jsx-2924001448{padding-left:16px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding-top:var(--spacers-dp4);gap:var(--spacers-dp4);}\", \"@-webkit-keyframes rotation-jsx-2924001448{0%{-webkit-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0);}100%{-webkit-transform:rotate(360deg);-ms-transform:rotate(360deg);transform:rotate(360deg);}}\", \"@keyframes rotation-jsx-2924001448{0%{-webkit-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0);}100%{-webkit-transform:rotate(360deg);-ms-transform:rotate(360deg);transform:rotate(360deg);}}\"]));\n};\n\nInterpretationThread.propTypes = {\n  currentUser: PropTypes.object.isRequired,\n  downloadMenuComponent: PropTypes.oneOfType([PropTypes.object, PropTypes.func]).isRequired,\n  fetching: PropTypes.bool.isRequired,\n  interpretation: PropTypes.object.isRequired,\n  onInterpretationDeleted: PropTypes.func.isRequired,\n  initialFocus: PropTypes.bool,\n  onThreadUpdated: PropTypes.func\n};\nexport { InterpretationThread };","import { useState, useEffect } from 'react';\nimport { useDebounce } from '../../../modules/utils.js';\nconst MODAL_SIDE_PADDING = 2 * 24;\nconst MODAL_SIDE_MARGINS = 2 * 128;\n\nconst computeModalContentWidth = windowWidth => {\n  return windowWidth - MODAL_SIDE_MARGINS - MODAL_SIDE_PADDING;\n};\n\nexport const useModalContentWidth = () => {\n  const [windowWidth, setWindowWidth] = useState(window.innerWidth);\n  const debouncedWindowWidth = useDebounce(windowWidth, 150);\n  const [modalContentWidth, setModalContentWidth] = useState(computeModalContentWidth(windowWidth));\n  useEffect(() => {\n    const onResize = () => {\n      setWindowWidth(window.innerWidth);\n    };\n\n    window.addEventListener('resize', onResize);\n    return () => {\n      window.removeEventListener('resize', onResize);\n    };\n  }, []);\n  useEffect(() => {\n    setModalContentWidth(computeModalContentWidth(debouncedWindowWidth));\n  }, [debouncedWindowWidth]);\n  return modalContentWidth;\n};","import _JSXStyle from \"styled-jsx/style\";\nimport { useDataQuery } from '@dhis2/app-runtime';\nimport i18n from '@dhis2/d2-i18n';\nimport { Modal, ModalActions, ModalContent, NoticeBox, Button, spacers, colors, Layer, CenteredContent, CircularLoader } from '@dhis2/ui';\nimport cx from 'classnames';\nimport PropTypes from 'prop-types';\nimport React, { useEffect, useState } from 'react';\nimport { Visualization } from '../../Visualization/Visualization.js';\nimport { InterpretationThread } from './InterpretationThread.js';\nimport { useModalContentWidth } from './useModalContentWidth.js';\nconst modalCSS = {\n  styles: /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: \"422732072\"\n  }, [\"aside.jsx-422732072{max-width:calc(100vw - 128px) !important;max-height:calc(100vh - 128px) !important;width:auto !important;height:auto !important;overflow-y:hidden;}\", \"aside.hidden.jsx-422732072{display:none;}\", \"aside.jsx-422732072>div>div{max-height:none;}\"]),\n  className: \"jsx-422732072\"\n};\n\nfunction getModalContentCSS(width) {\n  return {\n    styles: /*#__PURE__*/React.createElement(_JSXStyle, {\n      id: \"1689110567\",\n      dynamic: [width]\n    }, [\"div.__jsx-style-dynamic-selector{width:\".concat(width, \"px;}\")]),\n    className: _JSXStyle.dynamic([[\"1689110567\", [width]]])\n  };\n}\n\nconst query = {\n  interpretation: {\n    resource: 'interpretations',\n    id: _ref => {\n      let {\n        id\n      } = _ref;\n      return id;\n    },\n    params: {\n      fields: ['access', 'id', 'text', 'created', 'user[id,displayName]', 'likes', 'likedBy', 'comments[access,id,text,created,createdBy[id,displayName]]']\n    }\n  }\n};\n\nconst InterpretationModal = _ref2 => {\n  let {\n    currentUser,\n    isVisualizationLoading,\n    visualization,\n    onResponseReceived,\n    downloadMenuComponent,\n    onClose,\n    onInterpretationUpdate,\n    interpretationId,\n    initialFocus\n  } = _ref2;\n  const modalContentWidth = useModalContentWidth();\n  const modalContentCSS = getModalContentCSS(modalContentWidth);\n  const [isDirty, setIsDirty] = useState(false);\n  const {\n    data,\n    error,\n    loading,\n    fetching,\n    refetch\n  } = useDataQuery(query, {\n    lazy: true\n  });\n  const interpretation = data === null || data === void 0 ? void 0 : data.interpretation;\n  const shouldRenderModalContent = !error && interpretation;\n  const shouldCssHideModal = loading || isVisualizationLoading;\n\n  const handleClose = () => {\n    if (isDirty) {\n      onInterpretationUpdate();\n      setIsDirty(false);\n    }\n\n    onClose();\n  };\n\n  const onThreadUpdated = affectsInterpretation => {\n    if (affectsInterpretation) {\n      setIsDirty(true);\n    }\n\n    refetch({\n      id: interpretationId\n    });\n  };\n\n  const onInterpretationDeleted = () => {\n    setIsDirty(false);\n    onInterpretationUpdate();\n    onClose();\n  };\n\n  useEffect(() => {\n    if (interpretationId) {\n      refetch({\n        id: interpretationId\n      });\n    }\n  }, [interpretationId]);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, shouldCssHideModal && /*#__PURE__*/React.createElement(Layer, null, /*#__PURE__*/React.createElement(CenteredContent, null, /*#__PURE__*/React.createElement(CircularLoader, null))), /*#__PURE__*/React.createElement(Modal, {\n    fluid: true,\n    onClose: handleClose,\n    className: cx(modalCSS.className, {\n      hidden: shouldCssHideModal\n    })\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    className: _JSXStyle.dynamic([[\"3636222142\", [colors.grey900, spacers.dp24, spacers.dp4, spacers.dp4]]]) + \" \" + \"title\"\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: _JSXStyle.dynamic([[\"3636222142\", [colors.grey900, spacers.dp24, spacers.dp4, spacers.dp4]]]) + \" \" + \"ellipsis\"\n  }, i18n.t('Viewing interpretation: {{visualisationName}}', {\n    visualisationName: visualization.displayName,\n    nsSeparator: '^^'\n  }))), /*#__PURE__*/React.createElement(ModalContent, {\n    className: modalContentCSS.className\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: _JSXStyle.dynamic([[\"3636222142\", [colors.grey900, spacers.dp24, spacers.dp4, spacers.dp4]]]) + \" \" + \"container\"\n  }, error && /*#__PURE__*/React.createElement(NoticeBox, {\n    error: true,\n    title: i18n.t('Could not load interpretation')\n  }, error.message || i18n.t('The interpretation couldn’t be displayed. Try again or contact your system administrator.')), shouldRenderModalContent && /*#__PURE__*/React.createElement(\"div\", {\n    className: _JSXStyle.dynamic([[\"3636222142\", [colors.grey900, spacers.dp24, spacers.dp4, spacers.dp4]]]) + \" \" + \"row\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: _JSXStyle.dynamic([[\"3636222142\", [colors.grey900, spacers.dp24, spacers.dp4, spacers.dp4]]]) + \" \" + \"visualisation-wrap\"\n  }, /*#__PURE__*/React.createElement(Visualization, {\n    relativePeriodDate: interpretation.created,\n    visualization: visualization,\n    onResponseReceived: onResponseReceived\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: _JSXStyle.dynamic([[\"3636222142\", [colors.grey900, spacers.dp24, spacers.dp4, spacers.dp4]]]) + \" \" + \"thread-wrap\"\n  }, /*#__PURE__*/React.createElement(InterpretationThread, {\n    currentUser: currentUser,\n    fetching: fetching,\n    interpretation: interpretation,\n    onInterpretationDeleted: onInterpretationDeleted,\n    onThreadUpdated: onThreadUpdated,\n    initialFocus: initialFocus,\n    downloadMenuComponent: downloadMenuComponent\n  }))))), /*#__PURE__*/React.createElement(ModalActions, null, /*#__PURE__*/React.createElement(Button, {\n    disabled: fetching,\n    onClick: handleClose\n  }, i18n.t('Hide interpretation'))), modalCSS.styles, modalContentCSS.styles, /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: \"3636222142\",\n    dynamic: [colors.grey900, spacers.dp24, spacers.dp4, spacers.dp4]\n  }, [\".title.__jsx-style-dynamic-selector{color:\".concat(colors.grey900, \";margin:0px;padding:\").concat(spacers.dp24, \" 0 \").concat(spacers.dp4, \";}\"), \".ellipsis.__jsx-style-dynamic-selector{display:inline-block;font-size:20px;font-weight:500;line-height:24px;white-space:nowrap;width:100%;overflow:hidden;text-overflow:ellipsis;}\", \".container.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}\", \".row.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;gap:16px;}\", \".visualisation-wrap.__jsx-style-dynamic-selector{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}\", \".thread-wrap.__jsx-style-dynamic-selector{padding-right:\".concat(spacers.dp4, \";-webkit-flex-basis:300px;-ms-flex-preferred-size:300px;flex-basis:300px;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;overflow-y:auto;}\")])));\n};\n\nInterpretationModal.propTypes = {\n  currentUser: PropTypes.object.isRequired,\n  downloadMenuComponent: PropTypes.oneOfType([PropTypes.object, PropTypes.func]).isRequired,\n  interpretationId: PropTypes.string.isRequired,\n  isVisualizationLoading: PropTypes.bool.isRequired,\n  visualization: PropTypes.object.isRequired,\n  onClose: PropTypes.func.isRequired,\n  onResponseReceived: PropTypes.func.isRequired,\n  initialFocus: PropTypes.bool,\n  onInterpretationUpdate: PropTypes.func\n};\nexport { InterpretationModal };","import { parse, stringify } from 'query-string';\nimport { useState, useEffect } from 'react';\nimport history from '../../modules/history.js';\nconst options = {\n  parseBooleans: true\n};\n\nconst useInterpretationQueryParams = () => {\n  const [params, setParams] = useState(parse(history.location.search, options));\n  useEffect(() => {\n    const unlisten = history.listen(_ref => {\n      var _location$state, _location$state2;\n\n      let {\n        location\n      } = _ref;\n\n      if ((_location$state = location.state) !== null && _location$state !== void 0 && _location$state.isModalOpening) {\n        setParams(parse(history.location.search, options));\n      }\n\n      if ((_location$state2 = location.state) !== null && _location$state2 !== void 0 && _location$state2.isModalClosing) {\n        setParams(parse(history.location.search, options));\n      }\n    });\n    return unlisten;\n  }, []);\n  return params;\n};\n\nconst removeInterpretationQueryParams = () => {\n  const parsed = parse(history.location.search, options); // Keep all other query params in tact\n\n  const parsedWithoutInterpretationId = Object.entries(parsed).reduce((acc, _ref2) => {\n    let [key, value] = _ref2;\n\n    if (key !== 'interpretationId' && key !== 'initialFocus') {\n      acc[key] = value;\n    }\n\n    return acc;\n  }, {});\n  const search = stringify(parsedWithoutInterpretationId);\n  history.push({ ...history.location,\n    search\n  }, {\n    isModalClosing: true\n  });\n};\n\nexport { useInterpretationQueryParams, removeInterpretationQueryParams };","import { useCachedDataQuery } from '@dhis2/analytics';\nimport PropTypes from 'prop-types';\nimport React, { useState, useEffect } from 'react';\nimport { useSelector } from 'react-redux';\nimport { sGetCurrent } from '../../reducers/current.js';\nimport { ModalDownloadDropdown } from '../DownloadMenu/index.js';\nimport { InterpretationModal as AnalyticsInterpretationModal } from '../Interpretations/InterpretationModal/index.js';\nimport { useInterpretationQueryParams, removeInterpretationQueryParams } from './interpretationIdQueryParam.js';\n\nconst InterpretationModal = _ref => {\n  let {\n    onInterpretationUpdate\n  } = _ref;\n  const {\n    interpretationId,\n    initialFocus\n  } = useInterpretationQueryParams();\n  const [isVisualizationLoading, setIsVisualizationLoading] = useState(false);\n  const visualization = useSelector(sGetCurrent);\n  const {\n    currentUser\n  } = useCachedDataQuery();\n  useEffect(() => {\n    setIsVisualizationLoading(!!interpretationId);\n  }, [interpretationId]);\n  return interpretationId ? /*#__PURE__*/React.createElement(AnalyticsInterpretationModal, {\n    currentUser: currentUser,\n    onInterpretationUpdate: onInterpretationUpdate,\n    initialFocus: initialFocus,\n    interpretationId: interpretationId,\n    isVisualizationLoading: isVisualizationLoading,\n    onClose: removeInterpretationQueryParams,\n    onResponseReceived: () => setIsVisualizationLoading(false),\n    visualization: visualization,\n    downloadMenuComponent: ModalDownloadDropdown\n  }) : null;\n};\n\nInterpretationModal.propTypes = {\n  onInterpretationUpdate: PropTypes.func.isRequired\n};\nexport { InterpretationModal };","import { AXIS_ID_COLUMNS, AXIS_ID_FILTERS, AXIS_ID_ROWS } from '@dhis2/analytics';\nimport i18n from '@dhis2/d2-i18n';\n\nconst getAxisNames = () => ({\n  [AXIS_ID_COLUMNS]: i18n.t('Columns'),\n  [AXIS_ID_ROWS]: i18n.t('Rows'),\n  [AXIS_ID_FILTERS]: i18n.t('Filter')\n});\n\nexport const getAxisName = axisId => {\n  const name = getAxisNames()[axisId];\n\n  if (!name) {\n    throw new Error(\"\".concat(axisId, \" is not a valid axis id\"));\n  }\n\n  return name;\n};","import PropTypes from '@dhis2/prop-types';\nimport React from 'react';\nimport styles from './styles/IconButton.module.css';\n\nconst IconButton = _ref => {\n  let {\n    children,\n    dataTest,\n    disabled,\n    name,\n    onBlur,\n    onClick,\n    onFocus,\n    ariaOwns,\n    ariaHaspopup\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"button\", {\n    className: styles.iconButton,\n    \"data-test\": dataTest,\n    disabled: disabled,\n    name: name,\n    onBlur: onBlur,\n    onClick: onClick,\n    onFocus: onFocus,\n    \"aria-owns\": ariaOwns,\n    \"aria-haspopup\": ariaHaspopup\n  }, children);\n};\n\nIconButton.propTypes = {\n  ariaHaspopup: PropTypes.bool,\n  ariaOwns: PropTypes.string,\n  children: PropTypes.node,\n  dataTest: PropTypes.string,\n  disabled: PropTypes.bool,\n  name: PropTypes.string,\n  onBlur: PropTypes.func,\n  onClick: PropTypes.func,\n  onFocus: PropTypes.func\n};\nexport default IconButton;","import { AXIS_ID_COLUMNS, AXIS_ID_FILTERS, AXIS_ID_ROWS, VIS_TYPE_LINE_LIST } from '@dhis2/analytics';\nimport i18n from '@dhis2/d2-i18n';\nimport { MenuDivider, FlyoutMenu, MenuItem } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { getAxisName } from '../../modules/axis.js';\n\nconst getAxisItemLabel = (axisName, isDimensionInLayout) => isDimensionInLayout ? i18n.t('Move to {{axisName}}', {\n  axisName\n}) : i18n.t('Add to {{axisName}}', {\n  axisName\n});\n\nconst getDividerItem = key => /*#__PURE__*/React.createElement(MenuDivider, {\n  dense: true,\n  key: key\n});\n\nconst MenuItems = _ref => {\n  let {\n    dimensionId,\n    currentAxisId,\n    visType,\n    axisItemHandler,\n    removeItemHandler,\n    onClose,\n    dataTest\n  } = _ref;\n  const menuItems = [];\n  const isDimensionInLayout = !!currentAxisId; // add/move to axis item\n\n  const availableAxisIds = visType === VIS_TYPE_LINE_LIST ? [AXIS_ID_COLUMNS, AXIS_ID_FILTERS] : [AXIS_ID_COLUMNS, AXIS_ID_ROWS, AXIS_ID_FILTERS];\n  const applicableAxisIds = availableAxisIds.filter(axisId => axisId !== currentAxisId);\n\n  const getRemoveMenuItem = onClick => /*#__PURE__*/React.createElement(MenuItem, {\n    key: \"remove-menu-item\",\n    onClick: onClick,\n    label: i18n.t('Remove'),\n    dataTest: \"\".concat(dataTest, \"-item-remove-\").concat(dimensionId)\n  });\n\n  menuItems.push(...applicableAxisIds.map(axisId => /*#__PURE__*/React.createElement(MenuItem, {\n    key: \"\".concat(dimensionId, \"-to-\").concat(axisId),\n    onClick: () => {\n      axisItemHandler({\n        dimensionId,\n        axisId\n      });\n      onClose();\n    },\n    label: getAxisItemLabel(getAxisName(axisId), isDimensionInLayout),\n    dataTest: \"\".concat(dataTest, \"-item-action-\").concat(dimensionId, \"-to-\").concat(axisId)\n  }))); // remove item\n\n  if (isDimensionInLayout) {\n    // divider\n    if (applicableAxisIds.length) {\n      menuItems.push(getDividerItem('remove-item-divider'));\n    }\n\n    menuItems.push(getRemoveMenuItem(() => {\n      removeItemHandler(dimensionId);\n      onClose();\n    }));\n  }\n\n  return /*#__PURE__*/React.createElement(FlyoutMenu, {\n    dense: true,\n    dataTest: dataTest\n  }, menuItems);\n};\n\nMenuItems.propTypes = {\n  axisItemHandler: PropTypes.func.isRequired,\n  removeItemHandler: PropTypes.func.isRequired,\n  onClose: PropTypes.func.isRequired,\n  currentAxisId: PropTypes.string,\n  dataTest: PropTypes.string,\n  dimensionId: PropTypes.string,\n  visType: PropTypes.string\n};\nexport default MenuItems;","import { Layer, Popper, IconMore16 } from '@dhis2/ui';\nimport cx from 'classnames';\nimport PropTypes from 'prop-types';\nimport React, { useState, useRef } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { acAddUiLayoutDimensions, acRemoveUiLayoutDimensions } from '../../actions/ui.js';\nimport { sGetUiType, sGetUiLayout } from '../../reducers/ui.js';\nimport IconButton from '../IconButton/IconButton.js';\nimport styles from './DimensionMenu.module.css';\nimport MenuItems from './MenuItems.js';\n\nconst getAxisIdForDimension = (dimensionId, layout) => {\n  const axisLayout = Object.entries(layout).find(_ref => {\n    let [, dimensionIds] = _ref;\n    return dimensionIds.includes(dimensionId);\n  });\n  return axisLayout ? axisLayout[0] : undefined;\n};\n\nconst DimensionMenu = _ref2 => {\n  let {\n    currentAxisId,\n    dimensionId,\n    dimensionMetadata\n  } = _ref2;\n  const dispatch = useDispatch();\n  const visType = useSelector(sGetUiType);\n  const layout = useSelector(sGetUiLayout);\n  const axisId = currentAxisId || getAxisIdForDimension(dimensionId, layout);\n  const buttonRef = useRef();\n  const [menuIsOpen, setMenuIsOpen] = useState(false);\n\n  const toggleMenu = e => {\n    setMenuIsOpen(!menuIsOpen);\n    e && e.stopPropagation();\n  };\n\n  const getMenuId = () => \"menu-for-\".concat(dimensionId);\n\n  const axisItemHandler = _ref3 => {\n    let {\n      dimensionId,\n      axisId\n    } = _ref3;\n    dispatch(acAddUiLayoutDimensions({\n      [dimensionId]: {\n        axisId\n      }\n    }, dimensionMetadata));\n  };\n\n  const removeItemHandler = id => dispatch(acRemoveUiLayoutDimensions(id));\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    ref: buttonRef,\n    className: cx(styles.button, {\n      [styles.hidden]: !currentAxisId\n    })\n  }, /*#__PURE__*/React.createElement(IconButton, {\n    ariaOwns: menuIsOpen ? getMenuId() : null,\n    ariaHaspopup: true,\n    onClick: toggleMenu,\n    dataTest: \"layout-dimension-menu-button-\".concat(dimensionId)\n  }, /*#__PURE__*/React.createElement(IconMore16, null))), menuIsOpen && /*#__PURE__*/React.createElement(Layer, {\n    onClick: (_, e) => toggleMenu(e)\n  }, /*#__PURE__*/React.createElement(Popper, {\n    reference: buttonRef,\n    placement: \"bottom-start\"\n  }, /*#__PURE__*/React.createElement(MenuItems, {\n    dimensionId: dimensionId,\n    currentAxisId: axisId,\n    visType: visType,\n    axisItemHandler: axisItemHandler,\n    removeItemHandler: removeItemHandler,\n    onClose: toggleMenu,\n    dataTest: 'layout-dimension-menu-dimension-menu'\n  }))));\n};\n\nDimensionMenu.propTypes = {\n  currentAxisId: PropTypes.string,\n  dimensionId: PropTypes.string,\n  dimensionMetadata: PropTypes.object\n};\nexport default DimensionMenu;","import { DIMENSION_TYPE_CATEGORY, DIMENSION_TYPE_CATEGORY_OPTION_GROUP_SET, DIMENSION_TYPE_DATA_ELEMENT, ouIdHelper, DIMENSION_TYPE_ORGANISATION_UNIT, DIMENSION_TYPE_PERIOD, DIMENSION_TYPE_ORGANISATION_UNIT_GROUP_SET } from '@dhis2/analytics';\nimport i18n from '@dhis2/d2-i18n';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { useSelector } from 'react-redux';\nimport { DIMENSION_TYPE_STATUS } from '../../modules/dimensionConstants.js';\nimport { sGetMetadata } from '../../reducers/metadata.js';\nimport { sGetUiItemsByDimension } from '../../reducers/ui.js';\nimport styles from './styles/Tooltip.module.css';\nconst renderLimit = 5;\nexport const TooltipContent = _ref => {\n  let {\n    dimension,\n    conditionsTexts\n  } = _ref;\n  const metadata = useSelector(sGetMetadata);\n  const itemIds = useSelector(state => sGetUiItemsByDimension(state, dimension.id)) || [];\n\n  const getNameList = (idList, label, metadata) => idList.reduce((levelString, levelId, index) => \"\".concat(levelString).concat(index > 0 ? \", \" : \"\").concat(metadata[levelId] ? metadata[levelId].name : levelId), \"\".concat(label, \": \"));\n\n  let stageName;\n\n  if (dimension.stageName) {\n    stageName = dimension.stageName;\n  } else {\n    var _metadata$stageId;\n\n    const stageId = dimension.id.indexOf('.') !== -1 && dimension.id.substring(0, dimension.id.indexOf('.'));\n    stageName = (_metadata$stageId = metadata[stageId]) === null || _metadata$stageId === void 0 ? void 0 : _metadata$stageId.name;\n  }\n\n  const getItemDisplayNames = () => {\n    const levelIds = [];\n    const groupIds = [];\n    const itemDisplayNames = [];\n    itemIds.forEach(id => {\n      if (ouIdHelper.hasLevelPrefix(id)) {\n        levelIds.push(ouIdHelper.removePrefix(id));\n      } else if (ouIdHelper.hasGroupPrefix(id)) {\n        groupIds.push(ouIdHelper.removePrefix(id));\n      } else {\n        itemDisplayNames.push(metadata[id] ? metadata[id].name : id);\n      }\n    });\n    levelIds.length && itemDisplayNames.push(getNameList(levelIds, i18n.t('Levels'), metadata));\n    groupIds.length && itemDisplayNames.push(getNameList(groupIds, i18n.t('Groups'), metadata));\n    return itemDisplayNames;\n  };\n\n  const renderItems = function () {\n    let itemDisplayNames = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n\n    if (itemDisplayNames.some(name => !name)) {\n      return null;\n    }\n\n    const itemsToRender = itemDisplayNames.slice(0, renderLimit).map(name => /*#__PURE__*/React.createElement(\"li\", {\n      key: \"\".concat(dimension.id, \"-\").concat(name),\n      className: styles.item\n    }, name));\n    const numberOverRenderLimit = itemDisplayNames.length - renderLimit;\n\n    if (numberOverRenderLimit > 0) {\n      itemsToRender.push( /*#__PURE__*/React.createElement(\"li\", {\n        key: \"\".concat(dimension.id, \"-render-limit\"),\n        className: styles.item\n      }, i18n.t('And {{count}} other...', {\n        count: numberOverRenderLimit,\n        defaultValue: 'And {{count}} other...',\n        defaultValue_plural: 'And {{count}} others...'\n      })));\n    }\n\n    return itemsToRender;\n  };\n\n  const renderNoItemsLabel = () => /*#__PURE__*/React.createElement(\"li\", {\n    key: \"\".concat(dimension.id, \"-none-selected\"),\n    className: styles.item\n  }, i18n.t('None selected'));\n\n  const renderAllItemsLabel = () => /*#__PURE__*/React.createElement(\"li\", {\n    key: \"\".concat(dimension.id, \"-all-selected\"),\n    className: styles.item\n  }, i18n.t('Showing all values for this dimension'));\n\n  const itemDisplayNames = Boolean(itemIds.length) && getItemDisplayNames();\n\n  switch (dimension.dimensionType) {\n    case DIMENSION_TYPE_CATEGORY:\n    case DIMENSION_TYPE_CATEGORY_OPTION_GROUP_SET:\n    case DIMENSION_TYPE_ORGANISATION_UNIT_GROUP_SET:\n    case DIMENSION_TYPE_STATUS:\n      return /*#__PURE__*/React.createElement(\"ul\", {\n        className: styles.list\n      }, itemDisplayNames ? renderItems(itemDisplayNames) : renderAllItemsLabel());\n\n    case DIMENSION_TYPE_PERIOD:\n    case DIMENSION_TYPE_ORGANISATION_UNIT:\n      return /*#__PURE__*/React.createElement(\"ul\", {\n        className: styles.list\n      }, itemDisplayNames ? renderItems(itemDisplayNames) : renderNoItemsLabel());\n\n    case DIMENSION_TYPE_DATA_ELEMENT:\n      {\n        return /*#__PURE__*/React.createElement(\"ul\", {\n          className: styles.list\n        }, stageName && /*#__PURE__*/React.createElement(\"li\", {\n          className: styles.item\n        }, i18n.t('Program stage: {{stageName}}', {\n          stageName,\n          nsSeparator: '^^'\n        })), conditionsTexts.length ? renderItems(conditionsTexts) : renderAllItemsLabel());\n      }\n\n    default:\n      {\n        return /*#__PURE__*/React.createElement(\"ul\", {\n          className: styles.list\n        }, conditionsTexts.length ? renderItems(conditionsTexts) : renderAllItemsLabel());\n      }\n  }\n};\nTooltipContent.propTypes = {\n  conditionsTexts: PropTypes.array.isRequired,\n  dimension: PropTypes.object.isRequired\n};\nexport default TooltipContent;","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport { AXIS_ID_FILTERS } from '@dhis2/analytics';\nimport { Tooltip } from '@dhis2/ui';\nimport { useSortable } from '@dnd-kit/sortable';\nimport { CSS } from '@dnd-kit/utilities';\nimport cx from 'classnames';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { useSelector } from 'react-redux';\nimport { getConditionsTexts } from '../../modules/conditions.js';\nimport { sGetLoadError } from '../../reducers/loader.js';\nimport { sGetMetadata } from '../../reducers/metadata.js';\nimport { sGetUiItemsByDimension, sGetUiConditionsByDimension, sGetUiOptions } from '../../reducers/ui.js';\nimport DimensionMenu from '../DimensionMenu/DimensionMenu.js';\nimport { ChipBase } from './ChipBase.js';\nimport styles from './styles/Chip.module.css';\nimport { default as TooltipContent } from './TooltipContent.js';\nconst BEFORE = 'BEFORE';\nconst AFTER = 'AFTER';\n\nconst Chip = _ref => {\n  var _conditions$condition;\n\n  let {\n    dimension,\n    axisId,\n    isLast,\n    overLastDropZone,\n    onClick,\n    activeIndex\n  } = _ref;\n  const {\n    id: dimensionId,\n    name: dimensionName,\n    dimensionType,\n    valueType,\n    optionSet\n  } = dimension;\n  const {\n    attributes,\n    listeners,\n    index,\n    isDragging,\n    isSorting,\n    over,\n    setNodeRef,\n    transform,\n    transition\n  } = useSortable({\n    id: dimensionId,\n    data: {\n      name: dimensionName,\n      dimensionType,\n      valueType,\n      optionSet\n    }\n  });\n  const globalLoadError = useSelector(sGetLoadError);\n  const metadata = useSelector(sGetMetadata);\n  const {\n    digitGroupSeparator\n  } = useSelector(sGetUiOptions);\n  const conditions = useSelector(state => sGetUiConditionsByDimension(state, dimension.id)) || {};\n  const items = useSelector(state => sGetUiItemsByDimension(state, dimension.id)) || [];\n  let insertPosition = undefined;\n\n  if ((over === null || over === void 0 ? void 0 : over.id) === dimensionId) {\n    // This chip is being hovered over by a dragged item\n    if (activeIndex === -1) {\n      //This item came from the dimensions panel\n      insertPosition = AFTER;\n    } else {\n      insertPosition = index > activeIndex ? AFTER : BEFORE;\n    }\n  }\n\n  if (isLast && overLastDropZone) {\n    insertPosition = AFTER;\n  }\n\n  const style = transform ? {\n    transform: isSorting ? undefined : CSS.Translate.toString({\n      x: transform.x,\n      y: transform.y,\n      scaleX: 1,\n      scaleY: 1\n    }),\n    transition\n  } : undefined;\n  const id = Math.random().toString(36);\n  const dataTest = \"layout-chip-\".concat(dimensionId);\n  const conditionsTexts = getConditionsTexts({\n    conditions,\n    metadata,\n    dimension,\n    formatValueOptions: {\n      digitGroupSeparator,\n      skipRounding: false\n    }\n  });\n\n  const renderTooltipContent = () => /*#__PURE__*/React.createElement(TooltipContent, {\n    dimension: dimension,\n    conditionsTexts: conditionsTexts\n  });\n\n  if (globalLoadError && !dimensionName) {\n    return null;\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", _extends({\n    ref: setNodeRef\n  }, listeners, attributes, {\n    className: isLast ? styles.isLast : null,\n    style: style\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(styles.chip, {\n      [styles.chipEmpty]: axisId === AXIS_ID_FILTERS && !items.length && !((_conditions$condition = conditions.condition) !== null && _conditions$condition !== void 0 && _conditions$condition.length) && !conditions.legendSet,\n      [styles.active]: isDragging,\n      [styles.insertBefore]: insertPosition === BEFORE,\n      [styles.insertAfter]: insertPosition === AFTER,\n      [styles.showBlank]: !dimensionName\n    })\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.content\n  }, /*#__PURE__*/React.createElement(Tooltip, {\n    content: renderTooltipContent(),\n    placement: \"bottom\"\n  }, _ref2 => {\n    let {\n      ref,\n      onMouseOver,\n      onMouseOut\n    } = _ref2;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      \"data-test\": dataTest,\n      id: id,\n      onClick: onClick,\n      ref: ref,\n      onMouseOver: onMouseOver,\n      onMouseOut: onMouseOut\n    }, /*#__PURE__*/React.createElement(ChipBase, {\n      dimension: dimension,\n      conditionsLength: conditionsTexts.length,\n      itemsLength: items.length,\n      metadata: metadata\n    }));\n  }), /*#__PURE__*/React.createElement(DimensionMenu, {\n    dimensionId: dimensionId,\n    currentAxisId: axisId\n  }))));\n};\n\nChip.propTypes = {\n  dimension: PropTypes.object.isRequired,\n  onClick: PropTypes.func.isRequired,\n  activeIndex: PropTypes.number,\n  axisId: PropTypes.string,\n  isLast: PropTypes.bool,\n  overLastDropZone: PropTypes.bool\n};\nexport default Chip;","import { useDroppable } from '@dnd-kit/core';\nimport cx from 'classnames';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { getDropzoneId, FIRST } from '../../DndContext.js';\nimport styles from './styles/DropZone.module.css';\n\nconst DropZone = _ref => {\n  let {\n    axisId,\n    firstElementId,\n    overLastDropZone\n  } = _ref;\n  const {\n    isOver,\n    setNodeRef,\n    active\n  } = useDroppable({\n    id: getDropzoneId(axisId, FIRST)\n  });\n  let draggingOver = false;\n\n  if (overLastDropZone && !firstElementId) {\n    draggingOver = true;\n  } else {\n    draggingOver = firstElementId === (active === null || active === void 0 ? void 0 : active.id) ? false : isOver;\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    ref: setNodeRef,\n    className: cx(styles.dropZone, {\n      [styles.isOver]: draggingOver,\n      [styles.isEmpty]: !firstElementId\n    })\n  });\n};\n\nDropZone.propTypes = {\n  axisId: PropTypes.string,\n  firstElementId: PropTypes.string,\n  overLastDropZone: PropTypes.bool\n};\nexport { DropZone };","import { DIMENSION_TYPE_DATA_ELEMENT } from '@dhis2/analytics';\nimport { useDroppable } from '@dnd-kit/core';\nimport { SortableContext } from '@dnd-kit/sortable';\nimport cx from 'classnames';\nimport PropTypes from 'prop-types';\nimport React, { useMemo } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { acSetUiOpenDimensionModal } from '../../../actions/ui.js';\nimport { getAxisName } from '../../../modules/axis.js';\nimport { extractDimensionIdParts } from '../../../modules/utils.js';\nimport { OUTPUT_TYPE_ENROLLMENT } from '../../../modules/visualization.js';\nimport { sGetMetadata, sGetMetadataById } from '../../../reducers/metadata.js';\nimport { sGetUiDraggingId, sGetUiDimensionIdsByAxisId, sGetUiInputType, sGetUiProgramId, renderChipsSelector } from '../../../reducers/ui.js';\nimport { LAST, getDropzoneId } from '../../DndContext.js';\nimport Chip from '../Chip.js';\nimport { DropZone } from './DropZone.js';\nimport styles from './styles/DefaultAxis.module.css';\n\nconst DefaultAxis = _ref => {\n  let {\n    axisId,\n    className\n  } = _ref;\n  const lastDropZoneId = getDropzoneId(axisId, LAST);\n  const {\n    over,\n    setNodeRef\n  } = useDroppable({\n    id: lastDropZoneId\n  });\n  const dispatch = useDispatch();\n  const dimensionIds = useSelector(state => sGetUiDimensionIdsByAxisId(state, axisId));\n  const renderChips = useSelector(renderChipsSelector);\n  const draggingId = useSelector(sGetUiDraggingId);\n  const metadata = useSelector(sGetMetadata);\n  const inputType = useSelector(sGetUiInputType);\n  const selectedProgramId = useSelector(sGetUiProgramId);\n  const program = useSelector(state => sGetMetadataById(state, selectedProgramId));\n  const programStageNames = useMemo(() => {\n    var _program$programStage;\n\n    return program === null || program === void 0 ? void 0 : (_program$programStage = program.programStages) === null || _program$programStage === void 0 ? void 0 : _program$programStage.reduce((acc, stage) => {\n      acc.set(stage.id, stage.name);\n      return acc;\n    }, new Map());\n  }, [program]);\n\n  const getDimensionsWithStageName = () => {\n    let hasDuplicates = false;\n    const dataElements = new Map();\n    const dimensions = dimensionIds.map(id => {\n      let dimension = {};\n\n      if (metadata[id]) {\n        dimension = { ...metadata[id]\n        };\n      } else {\n        const {\n          dimensionId\n        } = extractDimensionIdParts(id);\n        dimension = { ...metadata[dimensionId]\n        };\n      }\n\n      return dimension;\n    });\n\n    if (inputType === OUTPUT_TYPE_ENROLLMENT) {\n      dimensions.forEach(dimension => {\n        const {\n          dimensionId\n        } = extractDimensionIdParts(dimension.id);\n\n        if (dimension.dimensionType === DIMENSION_TYPE_DATA_ELEMENT && dimensionId) {\n          const dataElementCount = dataElements.get(dimensionId);\n\n          if (dataElementCount) {\n            dataElements.set(dimensionId, dataElementCount + 1);\n            hasDuplicates = true;\n          } else {\n            dataElements.set(dimensionId, 1);\n          }\n        }\n      });\n      return hasDuplicates ? dimensions.map(dimension => {\n        const {\n          dimensionId,\n          programStageId\n        } = extractDimensionIdParts(dimension.id);\n\n        if (dimensionId && dataElements.get(dimensionId) > 1) {\n          dimension.stageName = programStageNames === null || programStageNames === void 0 ? void 0 : programStageNames.get(programStageId);\n        }\n\n        return dimension;\n      }) : dimensions;\n    }\n\n    return dimensions;\n  };\n\n  const activeIndex = draggingId ? dimensionIds.indexOf(draggingId) : -1;\n  const overLastDropZone = (over === null || over === void 0 ? void 0 : over.id) === lastDropZoneId;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    ref: setNodeRef,\n    className: styles.lastDropzone\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    id: axisId,\n    \"data-test\": \"\".concat(axisId, \"-axis\"),\n    className: cx(styles.axisContainer, className)\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.label\n  }, getAxisName(axisId)), /*#__PURE__*/React.createElement(SortableContext, {\n    id: axisId,\n    items: dimensionIds\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.content\n  }, /*#__PURE__*/React.createElement(DropZone, {\n    axisId: axisId,\n    firstElementId: dimensionIds[0],\n    overLastDropZone: overLastDropZone\n  }), renderChips && getDimensionsWithStageName().map((dimension, i) => /*#__PURE__*/React.createElement(Chip, {\n    key: \"\".concat(axisId, \"-\").concat(dimension.id),\n    onClick: () => dispatch(acSetUiOpenDimensionModal(dimension.id)),\n    dimension: dimension,\n    axisId: axisId,\n    isLast: i === dimensionIds.length - 1,\n    overLastDropZone: overLastDropZone,\n    activeIndex: activeIndex\n  }))))));\n};\n\nDefaultAxis.propTypes = {\n  axisId: PropTypes.string,\n  className: PropTypes.string\n};\nexport default DefaultAxis;","import { AXIS_ID_COLUMNS, AXIS_ID_FILTERS } from '@dhis2/analytics';\nimport cx from 'classnames';\nimport React from 'react';\nimport DefaultAxis from '../DefaultLayout/DefaultAxis.js';\nimport defaultAxisStyles from '../DefaultLayout/styles/DefaultAxis.module.css';\nimport defaultLayoutStyles from '../DefaultLayout/styles/DefaultLayout.module.css';\nimport lineListLayoutStyles from './styles/LineListLayout.module.css';\n\nconst Layout = () => /*#__PURE__*/React.createElement(\"div\", {\n  id: \"layout-ct\",\n  className: defaultLayoutStyles.ct\n}, /*#__PURE__*/React.createElement(\"div\", {\n  id: \"axis-group-1\",\n  className: cx(defaultLayoutStyles.axisGroup, lineListLayoutStyles.axisGroupLeft)\n}, /*#__PURE__*/React.createElement(DefaultAxis, {\n  axisId: AXIS_ID_COLUMNS,\n  className: cx(defaultLayoutStyles.filters, defaultAxisStyles.axisContainerLeft)\n})), /*#__PURE__*/React.createElement(\"div\", {\n  id: \"axis-group-2\",\n  className: cx(defaultLayoutStyles.axisGroup, lineListLayoutStyles.axisGroupRight)\n}, /*#__PURE__*/React.createElement(DefaultAxis, {\n  axisId: AXIS_ID_FILTERS,\n  className: defaultLayoutStyles.filters\n})));\n\nexport default Layout;","import { IconChevronUp16, IconChevronDown16, colors } from '@dhis2/ui';\nimport cx from 'classnames';\nimport React from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { acSetShowExpandedLayoutPanel } from '../../actions/ui.js';\nimport { LAYOUT_TYPE_LINE_LIST } from '../../modules/layout.js';\nimport { sGetUiShowExpandedLayoutPanel } from '../../reducers/ui.js';\nimport LineListLayout from './LineListLayout/LineListLayout.js';\nimport classes from './styles/Layout.module.css';\nconst componentMap = {\n  [LAYOUT_TYPE_LINE_LIST]: LineListLayout\n};\n\nconst Layout = () => {\n  const isExpanded = useSelector(state => sGetUiShowExpandedLayoutPanel(state));\n  const dispatch = useDispatch();\n\n  const toggleExpanded = () => dispatch(acSetShowExpandedLayoutPanel(!isExpanded));\n\n  const layoutType = LAYOUT_TYPE_LINE_LIST;\n  const LayoutComponent = componentMap[layoutType];\n  const ButtonIcon = isExpanded ? IconChevronUp16 : IconChevronDown16;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.container\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(classes.overflowContainer, {\n      [classes.expanded]: isExpanded\n    })\n  }, /*#__PURE__*/React.createElement(LayoutComponent, null)), /*#__PURE__*/React.createElement(\"button\", {\n    className: classes.button,\n    onClick: toggleExpanded\n  }, /*#__PURE__*/React.createElement(ButtonIcon, {\n    color: colors.grey700\n  })));\n};\n\nexport default Layout;","import { CircularLoader } from '@dhis2/ui';\nimport React from 'react';\nimport styles from './styles/LoadingMask.module.css';\n\nfunction LoadingMask() {\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.outer\n  }, /*#__PURE__*/React.createElement(CircularLoader, {\n    className: styles.progress\n  }));\n}\n\nexport default LoadingMask;","import { Radio } from '@dhis2/ui';\nimport cx from 'classnames';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport styles from './InputOption.module.css';\n\nconst InputOption = _ref => {\n  let {\n    header,\n    description,\n    onClick,\n    selected\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(styles.container, {\n      [styles.selected]: selected\n    }),\n    onClick: onClick\n  }, /*#__PURE__*/React.createElement(Radio, {\n    checked: selected\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.label\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.header\n  }, header), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.description\n  }, description)));\n};\n\nInputOption.propTypes = {\n  description: PropTypes.string.isRequired,\n  header: PropTypes.string.isRequired,\n  selected: PropTypes.bool.isRequired,\n  onClick: PropTypes.func.isRequired\n};\nexport { InputOption };","import i18n from '@dhis2/d2-i18n';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { tSetUiInput } from '../../../actions/ui.js';\nimport { OUTPUT_TYPE_EVENT, OUTPUT_TYPE_ENROLLMENT } from '../../../modules/visualization.js';\nimport { sGetUiInput } from '../../../reducers/ui.js';\nimport { InputOption } from './InputOption.js';\nimport styles from './InputPanel.module.css';\n\nconst getLabelForInputType = type => {\n  switch (type) {\n    case OUTPUT_TYPE_EVENT:\n      return i18n.t('Event');\n\n    case OUTPUT_TYPE_ENROLLMENT:\n      return i18n.t('Enrollment');\n\n    default:\n      throw new Error('No input type specified');\n  }\n};\n\nconst InputPanel = _ref => {\n  let {\n    visible\n  } = _ref;\n  const selectedInput = useSelector(sGetUiInput);\n  const dispatch = useDispatch();\n\n  if (!visible) {\n    return null;\n  }\n\n  const setSelectedInput = input => {\n    if (selectedInput.type !== input.type) {\n      dispatch(tSetUiInput(input));\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.container\n  }, /*#__PURE__*/React.createElement(InputOption, {\n    header: getLabelForInputType(OUTPUT_TYPE_EVENT),\n    description: i18n.t('See individual event data from a Tracker program stage or event program.'),\n    onClick: () => setSelectedInput({\n      type: OUTPUT_TYPE_EVENT\n    }),\n    selected: selectedInput.type === OUTPUT_TYPE_EVENT\n  }), /*#__PURE__*/React.createElement(InputOption, {\n    header: getLabelForInputType(OUTPUT_TYPE_ENROLLMENT),\n    description: i18n.t('See data from multiple program stages in a Tracker program.'),\n    onClick: () => setSelectedInput({\n      type: OUTPUT_TYPE_ENROLLMENT\n    }),\n    selected: selectedInput.type === OUTPUT_TYPE_ENROLLMENT\n  }));\n};\n\nInputPanel.propTypes = {\n  visible: PropTypes.bool.isRequired\n};\nexport { InputPanel, getLabelForInputType };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport { useSortable } from '@dnd-kit/sortable';\nimport { CSS } from '@dnd-kit/utilities';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { useDispatch } from 'react-redux';\nimport { acSetUiOpenDimensionModal } from '../../../actions/ui.js';\nimport DimensionMenu from '../../DimensionMenu/DimensionMenu.js';\nimport { DimensionItemBase } from './DimensionItemBase.js';\nexport const DimensionItem = _ref => {\n  let {\n    id,\n    draggableId,\n    name,\n    dimensionType,\n    valueType,\n    optionSet,\n    stageName,\n    disabled,\n    selected\n  } = _ref;\n  const dispatch = useDispatch();\n  const dimensionMetadata = {\n    [id]: {\n      id,\n      name,\n      dimensionType,\n      valueType,\n      optionSet\n    }\n  };\n  const onClick = disabled ? undefined : () => dispatch(acSetUiOpenDimensionModal(id, dimensionMetadata));\n  const {\n    attributes,\n    listeners,\n    isSorting,\n    setNodeRef,\n    transform,\n    transition\n  } = useSortable({\n    id: draggableId || id,\n    disabled: disabled || selected,\n    data: dimensionMetadata[id]\n  });\n  const style = transform ? {\n    transform: isSorting ? undefined : CSS.Translate.toString({\n      x: transform.x,\n      y: transform.y,\n      scaleX: 1,\n      scaleY: 1\n    }),\n    transition\n  } : undefined;\n  return /*#__PURE__*/React.createElement(\"div\", _extends({}, attributes, listeners, {\n    ref: setNodeRef,\n    style: style\n  }), /*#__PURE__*/React.createElement(DimensionItemBase, {\n    name: name,\n    dimensionType: dimensionType,\n    disabled: disabled,\n    selected: selected,\n    stageName: stageName,\n    onClick: onClick,\n    contextMenu: !disabled && /*#__PURE__*/React.createElement(DimensionMenu, {\n      dimensionId: id,\n      dimensionMetadata: dimensionMetadata\n    })\n  }));\n};\nDimensionItem.propTypes = {\n  dimensionType: PropTypes.string.isRequired,\n  draggableId: PropTypes.string.isRequired,\n  id: PropTypes.string.isRequired,\n  name: PropTypes.string.isRequired,\n  disabled: PropTypes.bool,\n  optionSet: PropTypes.string,\n  selected: PropTypes.bool,\n  stageName: PropTypes.string,\n  valueType: PropTypes.string\n};","import PropTypes from 'prop-types';\nimport React from 'react';\nimport styles from './MainSidebarSection.module.css';\nexport const MainSidebarSection = _ref => {\n  let {\n    children,\n    header\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.container\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.header\n  }, header), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.list\n  }, children));\n};\nMainSidebarSection.propTypes = {\n  children: PropTypes.node,\n  header: PropTypes.string\n};","import PropTypes from 'prop-types';\nimport React, { createContext, useMemo, useContext } from 'react';\nimport { useSelector, useStore } from 'react-redux';\nimport { DIMENSION_TYPES_PROGRAM, DIMENSION_TYPES_YOURS } from '../../modules/dimensionConstants.js';\nimport { sGetUiLayout } from '../../reducers/ui.js';\nconst SelectedDimensionsContext = /*#__PURE__*/createContext({\n  counts: {\n    your: 0,\n    program: 0\n  },\n  getIsDimensionSelected: () => {\n    throw new Error('Context not initialized correctly');\n  }\n});\nexport const SelectedDimensionsProvider = _ref => {\n  let {\n    children\n  } = _ref;\n  const layout = useSelector(sGetUiLayout);\n  const store = useStore();\n  const providerValue = useMemo(() => {\n    const allSelectedIds = [...layout.columns, ...layout.filters // Rows not used now, but will be later\n    //   ...layout.rows,\n    ];\n    /*\n     * Access metadata this way to prevent this component\n     * and its hook consumers to re-render every time\n     * something changes in the metadata store\n     */\n\n    const {\n      metadata\n    } = store.getState();\n    const allSelectedIdsSet = new Set(allSelectedIds);\n    const counts = allSelectedIds.reduce((acc, id) => {\n      const {\n        dimensionType\n      } = metadata[id];\n\n      if (DIMENSION_TYPES_PROGRAM.has(dimensionType)) {\n        acc.program += 1;\n      }\n\n      if (DIMENSION_TYPES_YOURS.has(dimensionType)) {\n        acc.your += 1;\n      }\n\n      return acc;\n    }, {\n      program: 0,\n      your: 0\n    });\n    return {\n      counts,\n      getIsDimensionSelected: id => allSelectedIdsSet.has(id)\n    };\n  }, [layout]);\n  return /*#__PURE__*/React.createElement(SelectedDimensionsContext.Provider, {\n    value: providerValue\n  }, children);\n};\nSelectedDimensionsProvider.propTypes = {\n  children: PropTypes.node\n};\nexport const useSelectedDimensions = () => useContext(SelectedDimensionsContext);","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport i18n from '@dhis2/d2-i18n';\nimport { Tooltip } from '@dhis2/ui';\nimport cx from 'classnames';\nimport React from 'react';\nimport { useMainDimensions } from '../../reducers/ui.js';\nimport styles from './common.module.css';\nimport { DimensionItem } from './DimensionItem/index.js';\nimport { MainSidebarSection } from './MainSidebarSection.js';\nimport { useSelectedDimensions } from './SelectedDimensionsContext.js';\nexport const MainDimensions = () => {\n  const mainDimensions = useMainDimensions();\n  const {\n    getIsDimensionSelected\n  } = useSelectedDimensions();\n  const draggableDimensions = mainDimensions.map(dimension => ({\n    draggableId: \"main-\".concat(dimension.id),\n    ...dimension\n  }));\n  return /*#__PURE__*/React.createElement(MainSidebarSection, {\n    header: i18n.t('Main dimensions')\n  }, draggableDimensions.map(dimension => /*#__PURE__*/React.createElement(Tooltip, {\n    content: dimension.disabledReason,\n    openDelay: 200,\n    closeDelay: 100,\n    key: dimension.id\n  }, _ref => {\n    let {\n      onMouseOver,\n      onMouseOut,\n      ref\n    } = _ref;\n    return /*#__PURE__*/React.createElement(\"span\", {\n      className: cx(styles.span, dimension.disabled && styles.notAllowed),\n      onMouseOver: () => dimension.disabled && onMouseOver(),\n      onMouseOut: () => dimension.disabled && onMouseOut(),\n      ref: ref\n    }, /*#__PURE__*/React.createElement(DimensionItem, _extends({}, dimension, {\n      selected: getIsDimensionSelected(dimension.id)\n    })));\n  })));\n};","import { IconChevronRight16 } from '@dhis2/ui';\nimport cx from 'classnames';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport styles from './MenuItem.module.css';\n\nconst MenuItem = _ref => {\n  let {\n    icon,\n    label,\n    count,\n    onClick,\n    isCountDisabled,\n    selected\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(styles.container, {\n      [styles.selected]: selected\n    }),\n    onClick: onClick,\n    tabIndex: \"0\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.icon\n  }, icon), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.label\n  }, label), typeof count === 'number' && /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(styles.count, {\n      [styles.dashed]: isCountDisabled\n    })\n  }, count), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.chevron\n  }, /*#__PURE__*/React.createElement(IconChevronRight16, null)));\n};\n\nMenuItem.propTypes = {\n  icon: PropTypes.node.isRequired,\n  label: PropTypes.string.isRequired,\n  onClick: PropTypes.func.isRequired,\n  count: PropTypes.number,\n  isCountDisabled: PropTypes.bool,\n  selected: PropTypes.bool\n};\nexport { MenuItem };","import i18n from '@dhis2/d2-i18n';\nimport { SingleSelect, SingleSelectOption } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { tSetUiStage, tClearUiStage, tClearUiProgramStageDimensions } from '../../../actions/ui.js';\nimport { sGetUiProgramStageId } from '../../../reducers/ui.js';\nconst STAGE_ALL = 'STAGE_ALL';\n\nconst StageSelect = _ref => {\n  let {\n    optional,\n    stages\n  } = _ref;\n  const dispatch = useDispatch();\n  const selectedStageId = useSelector(sGetUiProgramStageId);\n\n  const onChange = _ref2 => {\n    let {\n      selected: stageId\n    } = _ref2;\n\n    if (stageId === STAGE_ALL) {\n      dispatch(tClearUiStage());\n    } else {\n      const stage = stages.find(_ref3 => {\n        let {\n          id\n        } = _ref3;\n        return id === stageId;\n      });\n      dispatch(tSetUiStage(stage));\n    }\n\n    if (!optional && selectedStageId) {\n      dispatch(tClearUiProgramStageDimensions(selectedStageId));\n    }\n  };\n\n  const includeShowAllOption = optional && stages.length > 1;\n  const selected = selectedStageId || (includeShowAllOption ? STAGE_ALL : undefined);\n  return /*#__PURE__*/React.createElement(SingleSelect, {\n    prefix: i18n.t('Stage'),\n    dense: true,\n    selected: selected,\n    onChange: onChange\n  }, includeShowAllOption && /*#__PURE__*/React.createElement(SingleSelectOption, {\n    label: i18n.t('All'),\n    value: STAGE_ALL\n  }), stages.map(_ref4 => {\n    let {\n      id,\n      name\n    } = _ref4;\n    return /*#__PURE__*/React.createElement(SingleSelectOption, {\n      label: name,\n      key: id,\n      value: id\n    });\n  }));\n};\n\nStageSelect.propTypes = {\n  stages: PropTypes.arrayOf(PropTypes.object).isRequired,\n  optional: PropTypes.bool\n};\nexport { StageSelect };","import { DIMENSION_TYPE_DATA_ELEMENT, DIMENSION_TYPE_ALL, DIMENSION_TYPE_PROGRAM_ATTRIBUTE, DIMENSION_TYPE_PROGRAM_INDICATOR, DIMENSION_TYPE_CATEGORY, DIMENSION_TYPE_CATEGORY_OPTION_GROUP_SET } from '@dhis2/analytics';\nimport i18n from '@dhis2/d2-i18n';\nimport { SingleSelect, Input, Divider } from '@dhis2/ui';\nimport cx from 'classnames';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { useSelector } from 'react-redux';\nimport { PROGRAM_TYPE_WITH_REGISTRATION } from '../../../modules/programTypes.js';\nimport { OUTPUT_TYPE_ENROLLMENT } from '../../../modules/visualization.js';\nimport { sGetUiInputType } from '../../../reducers/ui.js';\nimport { DimensionIcon } from '../DimensionItem/DimensionIcon.js';\nimport styles from './ProgramDimensionsFilter.module.css';\nimport { StageSelect } from './StageSelect.js';\n\nconst SingleSelectOption = _ref => {\n  let {\n    label,\n    active,\n    value,\n    icon,\n    onClick\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(styles.option, {\n      [styles.active]: active\n    }),\n    \"data-value\": value,\n    onClick: e => onClick({}, e)\n  }, icon && /*#__PURE__*/React.createElement(\"span\", {\n    className: styles.optionIcon\n  }, icon), label);\n};\n\nSingleSelectOption.propTypes = {\n  active: PropTypes.bool,\n  icon: PropTypes.node,\n  label: PropTypes.string,\n  value: PropTypes.string,\n  onClick: PropTypes.func\n};\n\nconst ProgramDimensionsFilter = _ref2 => {\n  let {\n    program,\n    searchTerm,\n    setSearchTerm,\n    dimensionType,\n    setDimensionType\n  } = _ref2;\n  const inputType = useSelector(sGetUiInputType);\n  const showStageSelect = inputType === OUTPUT_TYPE_ENROLLMENT && dimensionType === DIMENSION_TYPE_DATA_ELEMENT;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.container\n  }, /*#__PURE__*/React.createElement(Input, {\n    value: searchTerm,\n    onChange: _ref3 => {\n      let {\n        value\n      } = _ref3;\n      return setSearchTerm(value);\n    },\n    dense: true,\n    type: 'search',\n    placeholder: i18n.t('Search in program')\n  }), /*#__PURE__*/React.createElement(SingleSelect, {\n    prefix: i18n.t('Type'),\n    selected: dimensionType,\n    onChange: _ref4 => {\n      let {\n        selected\n      } = _ref4;\n      return setDimensionType(selected);\n    },\n    dense: true\n  }, /*#__PURE__*/React.createElement(SingleSelectOption, {\n    label: i18n.t('All types'),\n    value: DIMENSION_TYPE_ALL\n  }), /*#__PURE__*/React.createElement(Divider, null), /*#__PURE__*/React.createElement(SingleSelectOption, {\n    label: i18n.t('Data element'),\n    value: DIMENSION_TYPE_DATA_ELEMENT,\n    icon: /*#__PURE__*/React.createElement(DimensionIcon, {\n      dimensionType: DIMENSION_TYPE_DATA_ELEMENT\n    })\n  }), program.programType === PROGRAM_TYPE_WITH_REGISTRATION && /*#__PURE__*/React.createElement(SingleSelectOption, {\n    label: i18n.t('Program attribute'),\n    value: DIMENSION_TYPE_PROGRAM_ATTRIBUTE,\n    icon: /*#__PURE__*/React.createElement(DimensionIcon, {\n      dimensionType: DIMENSION_TYPE_PROGRAM_ATTRIBUTE\n    })\n  }), /*#__PURE__*/React.createElement(SingleSelectOption, {\n    label: i18n.t('Program indicator'),\n    value: DIMENSION_TYPE_PROGRAM_INDICATOR,\n    icon: /*#__PURE__*/React.createElement(DimensionIcon, {\n      dimensionType: DIMENSION_TYPE_PROGRAM_INDICATOR\n    })\n  }), /*#__PURE__*/React.createElement(SingleSelectOption, {\n    label: i18n.t('Category'),\n    value: DIMENSION_TYPE_CATEGORY,\n    icon: /*#__PURE__*/React.createElement(DimensionIcon, {\n      dimensionType: DIMENSION_TYPE_CATEGORY\n    })\n  }), /*#__PURE__*/React.createElement(SingleSelectOption, {\n    label: i18n.t('Category option group set'),\n    value: DIMENSION_TYPE_CATEGORY_OPTION_GROUP_SET,\n    icon: /*#__PURE__*/React.createElement(DimensionIcon, {\n      dimensionType: DIMENSION_TYPE_CATEGORY_OPTION_GROUP_SET\n    })\n  })), showStageSelect && /*#__PURE__*/React.createElement(StageSelect, {\n    stages: program.programStages,\n    optional: true\n  }));\n};\n\nProgramDimensionsFilter.propTypes = {\n  program: PropTypes.object.isRequired,\n  dimensionType: PropTypes.string,\n  searchTerm: PropTypes.string,\n  setDimensionType: PropTypes.func,\n  setSearchTerm: PropTypes.func\n};\nexport { ProgramDimensionsFilter };","export const DIMENSION_LIST_FIELDS = ['id', 'dimensionType', 'valueType', 'optionSet'];","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport i18n from '@dhis2/d2-i18n';\nimport { CircularLoader, NoticeBox } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { useRef, useEffect } from 'react';\nimport { DimensionItem } from '../DimensionItem/index.js';\nimport { useSelectedDimensions } from '../SelectedDimensionsContext.js';\nimport styles from './DimensionsList.module.css';\n\nconst getNoResultsMessage = (searchTerm, programName) => {\n  if (searchTerm) {\n    return i18n.t(\"No dimensions found for '{{searchTerm}}'\", {\n      searchTerm\n    });\n  }\n\n  if (programName) {\n    return i18n.t('No dimensions found in the {{programName}} program', {\n      programName\n    });\n  }\n\n  return i18n.t('No dimensions found');\n};\n\nconst isEndReached = el => el.scrollHeight - el.scrollTop - el.clientHeight < 5;\n\nconst DimensionsList = _ref => {\n  let {\n    loading,\n    fetching,\n    error,\n    dimensions,\n    programName,\n    searchTerm,\n    setIsListEndVisible\n  } = _ref;\n  const scrollBoxRef = useRef();\n  const {\n    getIsDimensionSelected\n  } = useSelectedDimensions();\n  useEffect(() => {\n    if (dimensions && scrollBoxRef.current && !loading && !fetching) {\n      setIsListEndVisible(isEndReached(scrollBoxRef.current));\n    }\n  }, [dimensions, scrollBoxRef.current]);\n\n  if (loading) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: styles.loaderWrap\n    }, /*#__PURE__*/React.createElement(CircularLoader, {\n      small: true\n    }));\n  }\n\n  if (error) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: styles.errorWrap\n    }, /*#__PURE__*/React.createElement(NoticeBox, {\n      error: true,\n      title: i18n.t(\"Couldn't load dimensions\")\n    }, (error === null || error === void 0 ? void 0 : error.message) || i18n.t('There was a problem loading the dimensions. Try again, or contact your system administrator.')));\n  }\n\n  if (!(dimensions !== null && dimensions !== void 0 && dimensions.length)) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: styles.noResults\n    }, getNoResultsMessage(searchTerm, programName));\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.scrollbox,\n    onScroll: event => {\n      return setIsListEndVisible(isEndReached(event.target));\n    },\n    onMouseDown: event => event.preventDefault(),\n    ref: scrollBoxRef\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.list\n  }, dimensions.map(dimension => /*#__PURE__*/React.createElement(DimensionItem, _extends({\n    key: dimension.id\n  }, dimension, {\n    selected: getIsDimensionSelected(dimension.id)\n  }))), fetching && /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.loadMoreWrap\n  }, /*#__PURE__*/React.createElement(CircularLoader, {\n    small: true\n  }))));\n};\n\nDimensionsList.propTypes = {\n  setIsListEndVisible: PropTypes.func.isRequired,\n  dimensions: PropTypes.array,\n  error: PropTypes.object,\n  fetching: PropTypes.bool,\n  loading: PropTypes.bool,\n  programName: PropTypes.string,\n  searchTerm: PropTypes.string\n};\nexport { DimensionsList };","import { useCachedDataQuery, DIMENSION_TYPE_ALL, DIMENSION_TYPE_DATA_ELEMENT } from '@dhis2/analytics';\nimport { useDataEngine } from '@dhis2/app-runtime';\nimport { useEffect, useReducer, useCallback, useRef, useMemo } from 'react';\nimport { DERIVED_USER_SETTINGS_DISPLAY_NAME_PROPERTY } from '../../../modules/userSettings.js';\nimport { extractDimensionIdParts } from '../../../modules/utils.js';\nimport { OUTPUT_TYPE_EVENT, OUTPUT_TYPE_ENROLLMENT } from '../../../modules/visualization.js';\nimport { DIMENSION_LIST_FIELDS } from '../DimensionsList/index.js';\nconst ACTIONS_RESET = 'RESET';\nconst ACTIONS_INIT = 'INIT';\nconst ACTIONS_SUCCESS = 'SUCCESS';\nconst ACTIONS_ERROR = 'ERROR';\nconst ACTIONS_SET_LIST_END_VISIBLE = 'SET_LIST_END_VISIBLE';\nconst initialState = {\n  loading: true,\n  fetching: true,\n  error: null,\n  dimensions: [],\n  nextPage: 1,\n  isLastPage: false,\n  isListEndVisible: false\n};\n\nconst reducer = (state, action) => {\n  switch (action.type) {\n    case ACTIONS_RESET:\n      return { ...initialState\n      };\n\n    case ACTIONS_INIT:\n      return { ...state,\n        loading: !state.dimensions,\n        fetching: true,\n        error: null\n      };\n\n    case ACTIONS_SUCCESS:\n      return { ...state,\n        loading: false,\n        fetching: false,\n        error: null,\n        ...action.payload\n      };\n\n    case ACTIONS_ERROR:\n      return { ...state,\n        loading: false,\n        fetching: false,\n        error: action.payload,\n        dimensions: []\n      };\n\n    case ACTIONS_SET_LIST_END_VISIBLE:\n      return { ...state,\n        isListEndVisible: action.payload\n      };\n\n    default:\n      throw new Error('Invalid action passed to useProgramDimensions reducer function');\n  }\n};\n\nconst createDimensionsQuery = _ref => {\n  let {\n    inputType,\n    page,\n    programId,\n    stageId,\n    searchTerm,\n    dimensionType,\n    nameProp\n  } = _ref;\n  const resource = inputType === OUTPUT_TYPE_EVENT ? 'analytics/events/query/dimensions' : 'analytics/enrollments/query/dimensions';\n  const params = {\n    pageSize: 50,\n    page,\n    fields: [...DIMENSION_LIST_FIELDS, \"\".concat(nameProp, \"~rename(name)\")],\n    filter: [],\n    order: \"\".concat(nameProp, \":asc\")\n  };\n\n  if (programId && inputType === OUTPUT_TYPE_ENROLLMENT) {\n    params.programId = programId;\n  }\n\n  if (stageId && inputType === OUTPUT_TYPE_EVENT) {\n    params.programStageId = stageId;\n  }\n\n  if (stageId && inputType === OUTPUT_TYPE_ENROLLMENT && dimensionType === DIMENSION_TYPE_DATA_ELEMENT) {\n    // This works because data element IDs have the following notation:\n    // `${programStageId}.${dataElementId}`\n    params.filter.push(\"id:startsWith:\".concat(stageId));\n  }\n  /*\n   * TODO: currently no matches on shortname are captured\n   * if this is required we would need the backend add support for this, because\n   * we can't have a request with a mixed `rootJunction` (use both AND and OR)\n   * so we need to keep using the AND rootJunction and if we want to match a\n   * searchTerm against several fields, we need a specific query param for that,\n   * i.e. `filter=identifiable:token:${searchTerm}` or `query=${searchTerm}`\n   */\n\n\n  if (searchTerm) {\n    params.filter.push(\"\".concat(nameProp, \":ilike:\").concat(searchTerm));\n  }\n\n  if (dimensionType && dimensionType !== DIMENSION_TYPE_ALL) {\n    params.filter.push(\"dimensionType:eq:\".concat(dimensionType));\n  }\n\n  return {\n    resource,\n    params\n  };\n};\n\nconst transformResponseData = _ref2 => {\n  let {\n    data,\n    dimensions,\n    deDimensionsMapRef,\n    programStageNames,\n    shouldReset,\n    inputType\n  } = _ref2;\n  const pager = data.dimensions.pager;\n  let newDuplicateFound = false;\n\n  if (inputType === OUTPUT_TYPE_ENROLLMENT) {\n    data.dimensions.dimensions.forEach(dimension => {\n      const {\n        dimensionId\n      } = extractDimensionIdParts(dimension.id);\n\n      if (dimension.dimensionType === DIMENSION_TYPE_DATA_ELEMENT && dimensionId) {\n        const dataElementCount = deDimensionsMapRef.current.get(dimensionId);\n\n        if (dataElementCount) {\n          deDimensionsMapRef.current.set(dimensionId, dataElementCount + 1);\n          newDuplicateFound = true;\n        } else {\n          deDimensionsMapRef.current.set(dimensionId, 1);\n        }\n      }\n    });\n  }\n\n  const allDimensions = shouldReset ? data.dimensions.dimensions : [...dimensions, ...data.dimensions.dimensions];\n  const allDimensionsWithStageLabel = newDuplicateFound ? allDimensions.map(dimension => {\n    const {\n      dimensionId,\n      programStageId\n    } = extractDimensionIdParts(dimension.id);\n\n    if (dimensionId && deDimensionsMapRef.current.get(dimensionId) > 1) {\n      dimension.stageName = programStageNames === null || programStageNames === void 0 ? void 0 : programStageNames.get(programStageId);\n    }\n\n    return dimension;\n  }) : allDimensions;\n  return {\n    dimensions: allDimensionsWithStageLabel,\n    nextPage: pager.page + 1,\n    isLastPage: pager.pageSize * pager.page >= pager.total\n  };\n};\n\nconst useProgramDimensions = _ref3 => {\n  let {\n    inputType,\n    program,\n    stageId,\n    searchTerm,\n    dimensionType\n  } = _ref3;\n  const {\n    userSettings\n  } = useCachedDataQuery();\n  const deDimensionsMapRef = useRef(new Map());\n  const engine = useDataEngine();\n  const [{\n    loading,\n    fetching,\n    error,\n    dimensions,\n    nextPage,\n    isLastPage,\n    isListEndVisible\n  }, dispatch] = useReducer(reducer, initialState);\n  const programStageNames = useMemo(() => {\n    var _program$programStage;\n\n    return (_program$programStage = program.programStages) === null || _program$programStage === void 0 ? void 0 : _program$programStage.reduce((acc, stage) => {\n      acc.set(stage.id, stage.name);\n      return acc;\n    }, new Map());\n  }, [program]);\n  const nameProp = userSettings[DERIVED_USER_SETTINGS_DISPLAY_NAME_PROPERTY];\n\n  const setIsListEndVisible = isVisible => {\n    if (isVisible !== isListEndVisible) {\n      dispatch({\n        type: ACTIONS_SET_LIST_END_VISIBLE,\n        payload: isVisible\n      });\n    }\n  };\n\n  const fetchDimensions = useCallback(async shouldReset => {\n    if (shouldReset) {\n      deDimensionsMapRef.current.clear();\n      dispatch({\n        type: ACTIONS_RESET\n      });\n    } else {\n      dispatch({\n        type: ACTIONS_INIT\n      });\n    }\n\n    try {\n      const page = shouldReset ? 1 : nextPage;\n      const data = await engine.query({\n        dimensions: createDimensionsQuery({\n          inputType,\n          page,\n          programId: program.id,\n          stageId,\n          searchTerm,\n          dimensionType,\n          nameProp\n        })\n      });\n      dispatch({\n        type: ACTIONS_SUCCESS,\n        payload: transformResponseData({\n          data,\n          dimensions,\n          deDimensionsMapRef,\n          programStageNames,\n          shouldReset,\n          inputType\n        })\n      });\n    } catch (error) {\n      dispatch({\n        type: ACTIONS_ERROR,\n        payload: error\n      });\n    }\n  }, [inputType, nextPage, program, stageId, searchTerm, dimensionType, isListEndVisible, nameProp]);\n  useEffect(() => {\n    fetchDimensions(true);\n  }, [inputType, program, stageId, searchTerm, dimensionType, nameProp]);\n  useEffect(() => {\n    if (isListEndVisible && !isLastPage && !fetching) {\n      fetchDimensions(false);\n    }\n  }, [isListEndVisible, isLastPage]);\n  return {\n    loading,\n    error,\n    dimensions,\n    setIsListEndVisible\n  };\n};\n\nexport { useProgramDimensions, createDimensionsQuery };","import PropTypes from 'prop-types';\nimport React from 'react';\nimport { DimensionsList } from '../DimensionsList/index.js';\nimport { useProgramDimensions } from './useProgramDimensions.js';\n\nconst ProgramDimensionsList = _ref => {\n  let {\n    inputType,\n    program,\n    stageId,\n    searchTerm,\n    dimensionType\n  } = _ref;\n  const {\n    dimensions,\n    loading,\n    fetching,\n    error,\n    setIsListEndVisible\n  } = useProgramDimensions({\n    inputType,\n    program,\n    stageId,\n    searchTerm,\n    dimensionType\n  });\n  const draggableDimensions = dimensions.map(dimension => ({\n    draggableId: \"program-\".concat(dimension.id),\n    ...dimension\n  }));\n  return /*#__PURE__*/React.createElement(DimensionsList, {\n    setIsListEndVisible: setIsListEndVisible,\n    dimensions: draggableDimensions,\n    error: error,\n    fetching: fetching,\n    loading: loading,\n    programName: program.name,\n    searchTerm: searchTerm\n  });\n};\n\nProgramDimensionsList.propTypes = {\n  inputType: PropTypes.string.isRequired,\n  program: PropTypes.object.isRequired,\n  dimensionType: PropTypes.string,\n  searchTerm: PropTypes.string,\n  stageId: PropTypes.string\n};\nexport { ProgramDimensionsList };","import i18n from '@dhis2/d2-i18n';\nimport { SingleSelect, SingleSelectOption, Button, Tooltip } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport styles from './ProgramSelect.module.css';\nimport { StageSelect } from './StageSelect.js';\n\nconst ProgramSelect = _ref => {\n  let {\n    programs,\n    setSelectedProgramId,\n    requiredStageSelection,\n    selectedProgram\n  } = _ref;\n\n  /*\n   * TODO: the logic for disabling the select and showing the clear\n   * button needs to be changed later on. Currently this happens when\n   * programId is present but it should actually happen once at least one\n   * dimension item is selected\n   */\n  const showStageSelect = selectedProgram && requiredStageSelection;\n  const select = /*#__PURE__*/React.createElement(SingleSelect, {\n    dense: true,\n    selected: selectedProgram === null || selectedProgram === void 0 ? void 0 : selectedProgram.id,\n    disabled: !!selectedProgram,\n    onChange: _ref2 => {\n      let {\n        selected\n      } = _ref2;\n      return setSelectedProgramId(selected);\n    },\n    placeholder: i18n.t('Choose a program'),\n    maxHeight: \"max(60vh, 460px)\"\n  }, programs.map(_ref3 => {\n    let {\n      id,\n      name\n    } = _ref3;\n    return /*#__PURE__*/React.createElement(SingleSelectOption, {\n      key: id,\n      label: name,\n      value: id\n    });\n  }));\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.rows\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.columns\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.stretch\n  }, !selectedProgram ? select : /*#__PURE__*/React.createElement(Tooltip, {\n    content: i18n.t('Clear program first to choose another')\n  }, select)), selectedProgram && /*#__PURE__*/React.createElement(Button, {\n    small: true,\n    secondary: true,\n    onClick: () => setSelectedProgramId(undefined)\n  }, i18n.t('Clear'))), showStageSelect && /*#__PURE__*/React.createElement(StageSelect, {\n    stages: selectedProgram.programStages\n  }));\n};\n\nProgramSelect.propTypes = {\n  programs: PropTypes.array.isRequired,\n  setSelectedProgramId: PropTypes.func.isRequired,\n  requiredStageSelection: PropTypes.bool,\n  selectedProgram: PropTypes.object\n};\nexport { ProgramSelect };","import { useCachedDataQuery, DIMENSION_TYPE_ALL } from '@dhis2/analytics';\nimport { useDataQuery } from '@dhis2/app-runtime';\nimport i18n from '@dhis2/d2-i18n';\nimport { NoticeBox, CenteredContent, CircularLoader } from '@dhis2/ui';\nimport cx from 'classnames';\nimport PropTypes from 'prop-types';\nimport React, { useEffect, useState } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { tSetUiProgram } from '../../../actions/ui.js';\nimport { PROGRAM_TYPE_WITH_REGISTRATION, PROGRAM_TYPE_WITHOUT_REGISTRATION } from '../../../modules/programTypes.js';\nimport { DERIVED_USER_SETTINGS_DISPLAY_NAME_PROPERTY } from '../../../modules/userSettings.js';\nimport { useDebounce } from '../../../modules/utils.js';\nimport { OUTPUT_TYPE_EVENT, OUTPUT_TYPE_ENROLLMENT } from '../../../modules/visualization.js';\nimport { sGetUiInputType, sGetUiProgramId, sGetUiProgramStageId } from '../../../reducers/ui.js';\nimport { ProgramDimensionsFilter } from './ProgramDimensionsFilter.js';\nimport { ProgramDimensionsList } from './ProgramDimensionsList.js';\nimport styles from './ProgramDimensionsPanel.module.css';\nimport { ProgramSelect } from './ProgramSelect.js';\nconst query = {\n  programs: {\n    resource: 'programs',\n    params: _ref => {\n      let {\n        nameProp\n      } = _ref;\n      return {\n        fields: ['id', \"\".concat(nameProp, \"~rename(name)\"), 'enrollmentDateLabel', 'incidentDateLabel', 'programType', 'programStages[id,displayName~rename(name),displayExecutionDateLabel,hideDueDate,displayDueDateLabel,repeatable]', 'displayIncidentDate', 'displayIncidentDateLabel', 'displayEnrollmentDateLabel'],\n        paging: false\n      };\n    }\n  }\n};\n\nconst ProgramDimensionsPanel = _ref2 => {\n  let {\n    visible\n  } = _ref2;\n  const dispatch = useDispatch();\n  const inputType = useSelector(sGetUiInputType);\n  const selectedProgramId = useSelector(sGetUiProgramId);\n  const selectedStageId = useSelector(sGetUiProgramStageId);\n  const {\n    userSettings\n  } = useCachedDataQuery();\n  const {\n    fetching,\n    error,\n    data,\n    refetch,\n    called\n  } = useDataQuery(query, {\n    lazy: true\n  });\n  const [searchTerm, setSearchTerm] = useState('');\n  const [dimensionType, setDimensionType] = useState(DIMENSION_TYPE_ALL);\n  const debouncedSearchTerm = useDebounce(searchTerm);\n  const filteredPrograms = data === null || data === void 0 ? void 0 : data.programs.programs.filter(_ref3 => {\n    let {\n      programType\n    } = _ref3;\n    return !(inputType === OUTPUT_TYPE_ENROLLMENT && programType === PROGRAM_TYPE_WITHOUT_REGISTRATION);\n  });\n  const selectedProgram = selectedProgramId && (filteredPrograms === null || filteredPrograms === void 0 ? void 0 : filteredPrograms.find(_ref4 => {\n    let {\n      id\n    } = _ref4;\n    return id === selectedProgramId;\n  }));\n  const programType = selectedProgram === null || selectedProgram === void 0 ? void 0 : selectedProgram.programType;\n  const requiredStageSelection = inputType === OUTPUT_TYPE_EVENT && programType === PROGRAM_TYPE_WITH_REGISTRATION;\n  const isProgramSelectionComplete = inputType === OUTPUT_TYPE_EVENT ? selectedProgram && selectedStageId : !!selectedProgram;\n\n  const setSelectedProgramId = programId => {\n    if (programId !== selectedProgramId) {\n      const program = filteredPrograms === null || filteredPrograms === void 0 ? void 0 : filteredPrograms.find(_ref5 => {\n        let {\n          id\n        } = _ref5;\n        return id === programId;\n      });\n      const stage = // auto-select if a program only has a single stage\n      (program === null || program === void 0 ? void 0 : program.programStages.length) === 1 ? program.programStages[0] : undefined;\n      dispatch(tSetUiProgram({\n        program,\n        stage\n      }));\n    }\n  };\n\n  useEffect(() => {\n    if (visible && !called) {\n      refetch({\n        nameProp: userSettings[DERIVED_USER_SETTINGS_DISPLAY_NAME_PROPERTY]\n      });\n    }\n  }, [visible, called]);\n  useEffect(() => {\n    setSearchTerm('');\n    setDimensionType(DIMENSION_TYPE_ALL);\n  }, [inputType, selectedProgramId]);\n\n  if (!visible || !called) {\n    return null;\n  }\n\n  if (error && !fetching) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: styles.section\n    }, /*#__PURE__*/React.createElement(NoticeBox, {\n      error: true,\n      title: i18n.t('Could not load programs')\n    }, (error === null || error === void 0 ? void 0 : error.message) || i18n.t(\"The programs couldn't be retrieved. Try again or contact your system administrator.\")));\n  }\n\n  if (fetching) {\n    return /*#__PURE__*/React.createElement(CenteredContent, null, /*#__PURE__*/React.createElement(CircularLoader, {\n      small: true\n    }));\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.container\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(styles.section, styles.bordered)\n  }, /*#__PURE__*/React.createElement(ProgramSelect, {\n    programs: filteredPrograms,\n    selectedProgram: selectedProgram,\n    setSelectedProgramId: setSelectedProgramId,\n    requiredStageSelection: requiredStageSelection\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(styles.section, {\n      [styles.bordered]: !!selectedProgramId\n    })\n  }, isProgramSelectionComplete ? /*#__PURE__*/React.createElement(ProgramDimensionsFilter, {\n    program: selectedProgram,\n    searchTerm: searchTerm,\n    setSearchTerm: setSearchTerm,\n    dimensionType: dimensionType,\n    setDimensionType: setDimensionType\n  }) : /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.helptext\n  }, requiredStageSelection ? i18n.t('Choose a program and stage above to add program dimensions.') : i18n.t('Choose a program above to add program dimensions.'))), isProgramSelectionComplete && /*#__PURE__*/React.createElement(ProgramDimensionsList, {\n    inputType: inputType,\n    program: selectedProgram,\n    dimensionType: dimensionType,\n    searchTerm: debouncedSearchTerm,\n    stageId: selectedStageId\n  }));\n};\n\nProgramDimensionsPanel.propTypes = {\n  visible: PropTypes.bool.isRequired\n};\nexport { ProgramDimensionsPanel };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport i18n from '@dhis2/d2-i18n';\nimport { Tooltip } from '@dhis2/ui';\nimport cx from 'classnames';\nimport React from 'react';\nimport { useTimeDimensions } from '../../reducers/ui.js';\nimport styles from './common.module.css';\nimport { DimensionItem } from './DimensionItem/index.js';\nimport { MainSidebarSection } from './MainSidebarSection.js';\nimport { useSelectedDimensions } from './SelectedDimensionsContext.js';\nexport const TimeDimensions = () => {\n  const timeDimensions = useTimeDimensions();\n  const {\n    getIsDimensionSelected\n  } = useSelectedDimensions();\n\n  if (!timeDimensions) {\n    return null;\n  }\n\n  const draggableDimensions = timeDimensions.map(dimension => ({\n    draggableId: \"time-\".concat(dimension.id),\n    ...dimension\n  }));\n  return /*#__PURE__*/React.createElement(MainSidebarSection, {\n    header: i18n.t('Time dimensions')\n  }, draggableDimensions.map(dimension => /*#__PURE__*/React.createElement(Tooltip, {\n    content: dimension.disabledReason,\n    openDelay: 200,\n    closeDelay: 100,\n    key: dimension.id\n  }, _ref => {\n    let {\n      onMouseOver,\n      onMouseOut,\n      ref\n    } = _ref;\n    return /*#__PURE__*/React.createElement(\"span\", {\n      className: cx(styles.span, dimension.disabled && styles.notAllowed),\n      onMouseOver: () => dimension.disabled && onMouseOver(),\n      onMouseOut: () => dimension.disabled && onMouseOut(),\n      ref: ref\n    }, /*#__PURE__*/React.createElement(DimensionItem, _extends({}, dimension, {\n      selected: getIsDimensionSelected(dimension.id)\n    })));\n  })));\n};","import { useDataQuery } from '@dhis2/app-runtime';\nimport { useEffect, useState } from 'react';\nimport { DIMENSION_LIST_FIELDS } from '../DimensionsList/index.js';\nconst YOUR_DIMENSIONS_RESOURCE = 'dimensions'; // Fixed filter on org units for 2.38 ?\n\nconst YOUR_DIMENSIONS_FILTER = 'dimensionType:eq:ORGANISATION_UNIT_GROUP_SET';\nconst query = {\n  dimensions: {\n    resource: YOUR_DIMENSIONS_RESOURCE,\n    params: _ref => {\n      let {\n        page,\n        searchTerm,\n        nameProp\n      } = _ref;\n      const filters = [YOUR_DIMENSIONS_FILTER];\n\n      if (searchTerm) {\n        filters.push(\"\".concat(nameProp, \":ilike:\").concat(searchTerm));\n      }\n\n      return {\n        pageSize: 50,\n        page,\n        fields: [...DIMENSION_LIST_FIELDS, \"\".concat(nameProp, \"~rename(name)\")],\n        filter: filters,\n        order: \"\".concat(nameProp, \":asc\")\n      };\n    }\n  }\n};\n\nconst useYourDimensions = _ref2 => {\n  let {\n    visible,\n    searchTerm,\n    nameProp\n  } = _ref2;\n  const [isListEndVisible, setIsListEndVisible] = useState(false);\n  const [dimensions, setDimensions] = useState([]);\n  const {\n    data,\n    error,\n    loading,\n    fetching,\n    called,\n    refetch\n  } = useDataQuery(query, {\n    lazy: true\n  });\n  useEffect(() => {\n    // Delay initial fetch until component comes into view\n    if (visible && !called) {\n      refetch({\n        page: 1,\n        nameProp\n      });\n    }\n  }, [visible, called]);\n  useEffect(() => {\n    if (visible) {\n      refetch({\n        page: 1,\n        searchTerm,\n        nameProp\n      });\n    } // Reset when filter changes\n\n\n    setDimensions([]);\n  }, [searchTerm, nameProp]);\n  useEffect(() => {\n    if (data) {\n      const {\n        pager\n      } = data.dimensions;\n      const isLastPage = pager.pageSize * pager.page >= pager.total;\n\n      if (isListEndVisible && !isLastPage && !fetching) {\n        refetch({\n          page: data.page + 1,\n          searchTerm,\n          nameProp\n        });\n      }\n    }\n  }, [isListEndVisible, nameProp]);\n  useEffect(() => {\n    if (data) {\n      setDimensions(currDimensions => [...currDimensions, ...data.dimensions.dimensions]);\n    }\n  }, [data]);\n  return {\n    loading,\n    fetching,\n    error,\n    dimensions,\n    setIsListEndVisible\n  };\n};\n\nexport { useYourDimensions, YOUR_DIMENSIONS_FILTER, YOUR_DIMENSIONS_RESOURCE };","import { useDataQuery } from '@dhis2/app-runtime';\nimport i18n from '@dhis2/d2-i18n';\nimport { IconFolder16 } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { MenuItem } from './MenuItem/index.js';\nimport { YOUR_DIMENSIONS_RESOURCE, YOUR_DIMENSIONS_FILTER } from './YourDimensionsPanel/useYourDimensions.js';\nconst query = {\n  dimensions: {\n    resource: YOUR_DIMENSIONS_RESOURCE,\n    params: {\n      page: 1,\n      pageSize: 1,\n      fields: 'id',\n      filter: YOUR_DIMENSIONS_FILTER\n    }\n  }\n};\nexport const YourDimensionsMenuItem = _ref => {\n  var _data$dimensions$dime;\n\n  let {\n    selected,\n    count,\n    onClick\n  } = _ref;\n  const {\n    data\n  } = useDataQuery(query);\n  return data !== null && data !== void 0 && (_data$dimensions$dime = data.dimensions.dimensions) !== null && _data$dimensions$dime !== void 0 && _data$dimensions$dime.length ? /*#__PURE__*/React.createElement(MenuItem, {\n    icon: /*#__PURE__*/React.createElement(IconFolder16, null),\n    label: i18n.t('Your dimensions'),\n    onClick: onClick,\n    selected: selected,\n    count: count\n  }) : null;\n};\nYourDimensionsMenuItem.propTypes = {\n  onClick: PropTypes.func.isRequired,\n  count: PropTypes.number,\n  selected: PropTypes.bool\n};","import { useCachedDataQuery } from '@dhis2/analytics';\nimport i18n from '@dhis2/d2-i18n';\nimport { Input } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { useState } from 'react';\nimport { DERIVED_USER_SETTINGS_DISPLAY_NAME_PROPERTY } from '../../../modules/userSettings.js';\nimport { useDebounce } from '../../../modules/utils.js';\nimport { DimensionsList } from '../DimensionsList/index.js';\nimport { useYourDimensions } from './useYourDimensions.js';\nimport styles from './YourDimensionsPanel.module.css';\n\nconst YourDimensionsPanel = _ref => {\n  let {\n    visible\n  } = _ref;\n  const [searchTerm, setSearchTerm] = useState('');\n  const debouncedSearchTerm = useDebounce(searchTerm);\n  const {\n    userSettings\n  } = useCachedDataQuery();\n  const {\n    loading,\n    fetching,\n    error,\n    dimensions,\n    setIsListEndVisible\n  } = useYourDimensions({\n    visible,\n    searchTerm: debouncedSearchTerm,\n    nameProp: userSettings[DERIVED_USER_SETTINGS_DISPLAY_NAME_PROPERTY]\n  });\n\n  if (!visible) {\n    return null;\n  }\n\n  const draggableDimensions = dimensions.map(dimension => ({\n    draggableId: \"your-\".concat(dimension.id),\n    ...dimension\n  }));\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.search\n  }, /*#__PURE__*/React.createElement(Input, {\n    value: searchTerm,\n    onChange: _ref2 => {\n      let {\n        value\n      } = _ref2;\n      return setSearchTerm(value);\n    },\n    dense: true,\n    placeholder: i18n.t('Search your dimensions'),\n    type: 'search'\n  })), /*#__PURE__*/React.createElement(DimensionsList, {\n    setIsListEndVisible: setIsListEndVisible,\n    dimensions: draggableDimensions,\n    error: error,\n    fetching: fetching,\n    loading: loading,\n    searchTerm: debouncedSearchTerm\n  }));\n};\n\nYourDimensionsPanel.propTypes = {\n  visible: PropTypes.bool\n};\nexport { YourDimensionsPanel };","import i18n from '@dhis2/d2-i18n';\nimport { IconArrowRight16, IconFolder16 } from '@dhis2/ui';\nimport cx from 'classnames';\nimport React, { useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { acSetUiAccessoryPanelOpen, acSetUiDetailsPanelOpen } from '../../actions/ui.js';\nimport { sGetUiInputType, sGetUiShowAccessoryPanel, sGetUiProgramId } from '../../reducers/ui.js';\nimport { InputPanel, getLabelForInputType } from './InputPanel/index.js';\nimport { MainDimensions } from './MainDimensions.js';\nimport styles from './MainSidebar.module.css';\nimport { MenuItem } from './MenuItem/index.js';\nimport { ProgramDimensionsPanel } from './ProgramDimensionsPanel/index.js';\nimport { SelectedDimensionsProvider, useSelectedDimensions } from './SelectedDimensionsContext.js';\nimport { TimeDimensions } from './TimeDimensions.js';\nimport { YourDimensionsMenuItem } from './YourDimensionsMenuItem.js';\nimport { YourDimensionsPanel } from './YourDimensionsPanel/index.js';\nconst TAB_INPUT = 'INPUT';\nconst TAB_PROGRAM = 'PROGRAM';\nconst TAB_YOUR = 'YOUR';\n\nconst MainSidebar = () => {\n  const dispatch = useDispatch();\n  const open = useSelector(sGetUiShowAccessoryPanel);\n  const selectedInputType = useSelector(sGetUiInputType);\n  const selectedProgramId = useSelector(sGetUiProgramId);\n  const [selectedTabId, setSelectedTabId] = useState(null);\n\n  const setOpen = newOpen => dispatch(acSetUiAccessoryPanelOpen(newOpen));\n\n  const closeDetailsPanel = () => dispatch(acSetUiDetailsPanelOpen(false));\n\n  const onClick = id => {\n    if (open && id === selectedTabId) {\n      setSelectedTabId(null);\n      setOpen(false);\n    } else {\n      setSelectedTabId(id);\n      setOpen(true);\n      closeDetailsPanel();\n    }\n  };\n\n  const {\n    counts\n  } = useSelectedDimensions();\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.container\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.main\n  }, /*#__PURE__*/React.createElement(MenuItem, {\n    icon: /*#__PURE__*/React.createElement(IconArrowRight16, null),\n    label: i18n.t('Input: {{type}}', {\n      type: getLabelForInputType(selectedInputType),\n      nsSeparator: '^^'\n    }),\n    onClick: () => onClick(TAB_INPUT),\n    selected: open && selectedTabId === TAB_INPUT\n  }), /*#__PURE__*/React.createElement(MenuItem, {\n    icon: /*#__PURE__*/React.createElement(IconFolder16, null),\n    label: i18n.t('Program dimensions'),\n    onClick: () => onClick(TAB_PROGRAM),\n    selected: open && selectedTabId === TAB_PROGRAM,\n    count: counts.program,\n    isCountDisabled: !selectedProgramId\n  }), /*#__PURE__*/React.createElement(YourDimensionsMenuItem, {\n    selected: open && selectedTabId === TAB_YOUR,\n    count: counts.your,\n    onClick: () => onClick(TAB_YOUR)\n  }), /*#__PURE__*/React.createElement(MainDimensions, null), /*#__PURE__*/React.createElement(TimeDimensions, null)), /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(styles.accessory, {\n      [styles.hidden]: !open,\n      [styles.padded]: selectedTabId === TAB_INPUT\n    })\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.accessoryInner\n  }, /*#__PURE__*/React.createElement(InputPanel, {\n    visible: selectedTabId === TAB_INPUT\n  }), /*#__PURE__*/React.createElement(ProgramDimensionsPanel, {\n    visible: selectedTabId === TAB_PROGRAM\n  }), /*#__PURE__*/React.createElement(YourDimensionsPanel, {\n    visible: selectedTabId === TAB_YOUR\n  }))));\n};\n\nconst MainSidebarWithSelectedDimensionsProvider = () => /*#__PURE__*/React.createElement(SelectedDimensionsProvider, null, /*#__PURE__*/React.createElement(MainSidebar, null));\n\nexport { MainSidebarWithSelectedDimensionsProvider as MainSidebar };","import i18n from '@dhis2/d2-i18n';\nimport cx from 'classnames';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { STATE_UNSAVED, STATE_SAVED, STATE_DIRTY, getVisualizationState } from '../../modules/visualization.js';\nimport { sGetCurrent } from '../../reducers/current.js';\nimport { sGetVisualization } from '../../reducers/visualization.js';\nimport classes from './styles/TitleBar.module.css';\nexport const getTitleUnsaved = () => i18n.t('Unsaved visualization');\nexport const getTitleDirty = () => i18n.t('Edited');\nconst defaultTitleClasses = \"\".concat(classes.cell, \" \").concat(classes.title);\n\nconst getTitleText = (titleState, visualization) => {\n  switch (titleState) {\n    case STATE_UNSAVED:\n      return getTitleUnsaved();\n\n    case STATE_SAVED:\n    case STATE_DIRTY:\n      return visualization.displayName;\n\n    default:\n      return '';\n  }\n};\n\nconst getCustomTitleClasses = titleState => titleState === STATE_UNSAVED ? classes.titleUnsaved : '';\n\nconst getSuffix = titleState => titleState === STATE_DIRTY ? /*#__PURE__*/React.createElement(\"div\", {\n  className: cx(classes.titleDirty, classes.suffix),\n  \"data-test\": \"AO-title-dirty\"\n}, \"- \".concat(getTitleDirty())) : '';\n\nexport const TitleBar = _ref => {\n  let {\n    titleState,\n    titleText\n  } = _ref;\n  const titleClasses = \"\".concat(defaultTitleClasses, \" \").concat(getCustomTitleClasses(titleState));\n  return titleText ? /*#__PURE__*/React.createElement(\"div\", {\n    \"data-test\": \"AO-title\",\n    className: classes.titleBar\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: titleClasses\n  }, titleText, getSuffix(titleState))) : null;\n};\nTitleBar.propTypes = {\n  titleState: PropTypes.string,\n  titleText: PropTypes.string\n};\n\nconst mapStateToProps = state => ({\n  current: sGetCurrent(state),\n  visualization: sGetVisualization(state)\n});\n\nconst mergeProps = (stateProps, dispatchProps, ownProps) => {\n  const {\n    visualization,\n    current\n  } = stateProps;\n  const titleState = getVisualizationState(visualization, current);\n  return { ...dispatchProps,\n    ...ownProps,\n    titleState: titleState,\n    titleText: getTitleText(titleState, visualization)\n  };\n};\n\nexport default connect(mapStateToProps, null, mergeProps)(TitleBar);","import { SingleSelectField, SingleSelectOption } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { acSetUiOptions } from '../../../actions/ui.js';\nimport { sGetUiOptions } from '../../../reducers/ui.js';\nimport styles from '../styles/VisualizationOptions.module.css';\n\nconst SelectBaseOption = _ref => {\n  var _option$items$find;\n\n  let {\n    option,\n    label,\n    value,\n    onChange,\n    dataTest\n  } = _ref;\n  const selected = (_option$items$find = option.items.find(item => item.value === value)) === null || _option$items$find === void 0 ? void 0 : _option$items$find.value;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.tabSectionOption\n  }, /*#__PURE__*/React.createElement(SingleSelectField, {\n    name: \"\".concat(option.name, \"-select\"),\n    label: label,\n    onChange: _ref2 => {\n      let {\n        selected\n      } = _ref2;\n      return onChange(selected);\n    },\n    selected: selected,\n    inputWidth: \"280px\",\n    dense: true,\n    dataTest: \"\".concat(dataTest, \"-select\")\n  }, option.items.map(_ref3 => {\n    let {\n      value,\n      label\n    } = _ref3;\n    return /*#__PURE__*/React.createElement(SingleSelectOption, {\n      key: value,\n      value: value,\n      label: label,\n      dataTest: \"\".concat(dataTest, \"-option\")\n    });\n  })));\n};\n\nSelectBaseOption.propTypes = {\n  option: PropTypes.object.isRequired,\n  value: PropTypes.oneOfType([PropTypes.string, PropTypes.number]).isRequired,\n  onChange: PropTypes.func.isRequired,\n  dataTest: PropTypes.string,\n  label: PropTypes.string\n};\n\nconst mapStateToProps = (state, ownProps) => ({\n  value: sGetUiOptions(state)[ownProps.option.name]\n});\n\nconst mapDispatchToProps = (dispatch, ownProps) => ({\n  onChange: value => dispatch(acSetUiOptions({\n    [ownProps.option.name]: value\n  }))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SelectBaseOption);","import i18n from '@dhis2/d2-i18n';\nimport React from 'react';\nimport SelectBaseOption from './SelectBaseOption.js';\n\nconst DigitGroupSeparator = () => /*#__PURE__*/React.createElement(SelectBaseOption, {\n  label: i18n.t('Digit group separator'),\n  option: {\n    name: 'digitGroupSeparator',\n    items: [{\n      value: 'NONE',\n      label: i18n.t('None')\n    }, {\n      value: 'SPACE',\n      label: i18n.t('Space')\n    }, {\n      value: 'COMMA',\n      label: i18n.t('Comma')\n    }]\n  }\n});\n\nexport default DigitGroupSeparator;","import i18n from '@dhis2/d2-i18n';\nimport React from 'react';\nimport { DISPLAY_DENSITY_COMFORTABLE, DISPLAY_DENSITY_NORMAL, DISPLAY_DENSITY_COMPACT } from '../../../modules/options.js';\nimport { default as SelectBaseOption } from './SelectBaseOption.js';\n\nconst DisplayDensity = () => /*#__PURE__*/React.createElement(SelectBaseOption, {\n  label: i18n.t('Display density'),\n  option: {\n    name: 'displayDensity',\n    items: [{\n      value: DISPLAY_DENSITY_COMFORTABLE,\n      label: i18n.t('Comfortable')\n    }, {\n      value: DISPLAY_DENSITY_NORMAL,\n      label: i18n.t('Normal')\n    }, {\n      value: DISPLAY_DENSITY_COMPACT,\n      label: i18n.t('Compact')\n    }]\n  }\n});\n\nexport default DisplayDensity;","import i18n from '@dhis2/d2-i18n';\nimport React from 'react';\nimport SelectBaseOption from './SelectBaseOption.js';\n\nconst FontSize = () => /*#__PURE__*/React.createElement(SelectBaseOption, {\n  label: i18n.t('Font size'),\n  option: {\n    name: 'fontSize',\n    items: [{\n      value: 'LARGE',\n      label: i18n.t('Large')\n    }, {\n      value: 'NORMAL',\n      label: i18n.t('Normal')\n    }, {\n      value: 'SMALL',\n      label: i18n.t('Small')\n    }]\n  }\n});\n\nexport default FontSize;","import i18n from '@dhis2/d2-i18n';\nexport default (content => ({\n  key: 'style-tab',\n  label: i18n.t('Style'),\n  content\n}));","import { Checkbox } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { acSetUiOptions } from '../../../actions/ui.js';\nimport { sGetUiOptions } from '../../../reducers/ui.js';\nimport styles from '../styles/VisualizationOptions.module.css';\n\nconst CheckboxBaseOption = _ref => {\n  let {\n    option,\n    label,\n    value,\n    onChange,\n    inverted,\n    dataTest\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.tabSectionOption\n  }, /*#__PURE__*/React.createElement(Checkbox, {\n    checked: inverted ? !value : value,\n    label: label,\n    name: option.name,\n    onChange: _ref2 => {\n      let {\n        checked\n      } = _ref2;\n      return onChange(inverted ? !checked : checked);\n    },\n    dense: true,\n    dataTest: dataTest\n  }));\n};\n\nCheckboxBaseOption.propTypes = {\n  dataTest: PropTypes.string,\n  inverted: PropTypes.bool,\n  label: PropTypes.string,\n  option: PropTypes.object,\n  value: PropTypes.bool,\n  onChange: PropTypes.func\n};\n\nconst mapStateToProps = (state, ownProps) => ({\n  value: sGetUiOptions(state)[ownProps.option.name]\n});\n\nconst mapDispatchToProps = (dispatch, ownProps) => ({\n  onChange: value => dispatch(acSetUiOptions({\n    [ownProps.option.name]: value\n  }))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(CheckboxBaseOption);","import i18n from '@dhis2/d2-i18n';\nimport React from 'react';\nimport CheckboxBaseOption from './CheckboxBaseOption.js';\n\nconst ColSubTotals = () => /*#__PURE__*/React.createElement(CheckboxBaseOption, {\n  label: i18n.t('Column sub-totals'),\n  option: {\n    name: 'colSubTotals'\n  }\n});\n\nexport default ColSubTotals;","import i18n from '@dhis2/d2-i18n';\nimport React from 'react';\nimport CheckboxBaseOption from './CheckboxBaseOption.js';\n\nconst ColTotals = () => /*#__PURE__*/React.createElement(CheckboxBaseOption, {\n  label: i18n.t('Columns totals'),\n  option: {\n    name: 'colTotals'\n  }\n});\n\nexport default ColTotals;","import i18n from '@dhis2/d2-i18n';\nimport React from 'react';\nimport CheckboxBaseOption from './CheckboxBaseOption.js';\n\nconst HideEmptyRows = () => /*#__PURE__*/React.createElement(CheckboxBaseOption, {\n  label: i18n.t('Hide empty rows'),\n  option: {\n    name: 'hideEmptyRows'\n  }\n});\n\nexport default HideEmptyRows;","import i18n from '@dhis2/d2-i18n';\nimport React from 'react';\nimport CheckboxBaseOption from './CheckboxBaseOption.js';\n\nconst RowSubTotals = () => /*#__PURE__*/React.createElement(CheckboxBaseOption, {\n  label: i18n.t('Row sub-totals'),\n  option: {\n    name: 'rowSubTotals'\n  }\n});\n\nexport default RowSubTotals;","import i18n from '@dhis2/d2-i18n';\nimport React from 'react';\nimport CheckboxBaseOption from './CheckboxBaseOption.js';\n\nconst RowTotals = () => /*#__PURE__*/React.createElement(CheckboxBaseOption, {\n  label: i18n.t('Row totals'),\n  option: {\n    name: 'rowTotals'\n  }\n});\n\nexport default RowTotals;","import i18n from '@dhis2/d2-i18n';\nimport React from 'react';\nimport CheckboxBaseOption from './CheckboxBaseOption.js';\n\nconst ShowDimensionLabels = () => /*#__PURE__*/React.createElement(CheckboxBaseOption, {\n  label: i18n.t('Dimension labels'),\n  option: {\n    name: 'showDimensionLabels'\n  }\n});\n\nexport default ShowDimensionLabels;","import i18n from '@dhis2/d2-i18n';\nimport React from 'react';\nimport CheckboxBaseOption from './CheckboxBaseOption.js';\n\nconst ShowHierarchy = () => /*#__PURE__*/React.createElement(CheckboxBaseOption, {\n  label: i18n.t('Display organisation unit hierarchy'),\n  option: {\n    name: 'showHierarchy'\n  }\n});\n\nexport default ShowHierarchy;","import { InputField } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { acSetUiOptions } from '../../../actions/ui.js';\nimport { sGetUiOptions } from '../../../reducers/ui.js';\nimport styles from '../styles/VisualizationOptions.module.css';\n\nconst TextBaseOption = _ref => {\n  let {\n    type,\n    label,\n    placeholder,\n    width,\n    option,\n    value,\n    onChange,\n    disabled,\n    dataTest\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.tabSectionOption\n  }, /*#__PURE__*/React.createElement(InputField, {\n    type: type,\n    label: label,\n    onChange: _ref2 => {\n      let {\n        value\n      } = _ref2;\n      return onChange(value);\n    },\n    name: option.name,\n    value: value,\n    placeholder: placeholder,\n    inputWidth: width,\n    dense: true,\n    disabled: disabled,\n    dataTest: \"\".concat(dataTest, \"-input\")\n  }));\n};\n\nTextBaseOption.defaultProps = {\n  option: {}\n};\nTextBaseOption.propTypes = {\n  dataTest: PropTypes.string,\n  disabled: PropTypes.bool,\n  label: PropTypes.string,\n  option: PropTypes.object,\n  placeholder: PropTypes.string,\n  type: PropTypes.string,\n  value: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  width: PropTypes.string,\n  onChange: PropTypes.func\n};\n\nconst mapStateToProps = (state, ownProps) => ({\n  value: sGetUiOptions(state)[ownProps.option.name]\n});\n\nconst mapDispatchToProps = (dispatch, ownProps) => ({\n  onChange: value => dispatch(acSetUiOptions({\n    [ownProps.option.name]: value\n  }))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(TextBaseOption);","import i18n from '@dhis2/d2-i18n';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport TextBaseOption from './TextBaseOption.js';\n\nconst Title = _ref => {\n  let {\n    label\n  } = _ref;\n  return /*#__PURE__*/React.createElement(TextBaseOption, {\n    type: \"text\",\n    width: \"280px\",\n    label: label,\n    placeholder: i18n.t('Add a title'),\n    option: {\n      name: 'title'\n    }\n  });\n};\n\nTitle.propTypes = {\n  label: PropTypes.string\n};\nexport default Title;","import i18n from '@dhis2/d2-i18n';\nexport default (_ref => {\n  let {\n    content\n  } = _ref;\n  return {\n    key: 'data-display',\n    label: i18n.t('Display'),\n    content\n  };\n});","import i18n from '@dhis2/d2-i18n';\nexport default (_ref => {\n  let {\n    content\n  } = _ref;\n  return {\n    key: 'data-empty-data',\n    label: i18n.t('Empty data'),\n    content\n  };\n});","import i18n from '@dhis2/d2-i18n';\nexport default (_ref => {\n  let {\n    content\n  } = _ref;\n  return {\n    key: 'data-totals',\n    label: i18n.t('Totals'),\n    content\n  };\n});","import { useDataEngine } from '@dhis2/app-runtime';\nimport i18n from '@dhis2/d2-i18n';\nimport { SingleSelectField, SingleSelectOption } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { useState } from 'react';\nimport { connect } from 'react-redux';\nimport { acSetUiOption } from '../../../actions/ui.js';\nimport { OPTION_LEGEND_SET } from '../../../modules/options.js';\nimport { sGetUiOption } from '../../../reducers/ui.js';\nconst query = {\n  legendSets: {\n    resource: 'legendSets',\n    params: {\n      fields: ['id', 'displayName~rename(name)', 'legends[id,displayName~rename(name),startValue,endValue,color]'],\n      paging: 'false'\n    }\n  }\n};\n\nconst LegendSetSelect = _ref => {\n  let {\n    value,\n    loading,\n    options,\n    onFocus,\n    onChange,\n    dataTest\n  } = _ref;\n  return /*#__PURE__*/React.createElement(SingleSelectField, {\n    name: \"legendSetSelect\",\n    label: i18n.t('Legend'),\n    selected: value === null || value === void 0 ? void 0 : value.id,\n    inputWidth: \"280px\",\n    placeholder: i18n.t('Select from legends'),\n    loadingText: i18n.t('Loading legends'),\n    loading: loading,\n    dense: true,\n    onFocus: onFocus,\n    onChange: _ref2 => {\n      let {\n        selected\n      } = _ref2;\n      return onChange({\n        id: selected,\n        displayName: options.find(option => option.value === selected).label\n      });\n    },\n    dataTest: \"\".concat(dataTest, \"-select\")\n  }, options.map(_ref3 => {\n    let {\n      value,\n      label\n    } = _ref3;\n    return /*#__PURE__*/React.createElement(SingleSelectOption, {\n      key: value,\n      value: value,\n      label: label,\n      dataTest: \"\".concat(dataTest, \"-option\")\n    });\n  }));\n};\n\nLegendSetSelect.propTypes = {\n  dataTest: PropTypes.string,\n  loading: PropTypes.bool,\n  options: PropTypes.array,\n  value: PropTypes.object,\n  onChange: PropTypes.func,\n  onFocus: PropTypes.func\n};\n\nconst LegendSet = _ref4 => {\n  let {\n    value,\n    onChange,\n    dataTest\n  } = _ref4;\n  const engine = useDataEngine();\n  const [options, setOptions] = useState([]);\n  const [isLoaded, setIsLoaded] = useState(false);\n\n  if (value && value.id) {\n    if (!options.find(option => option.value === value.id)) {\n      setOptions([...options, {\n        value: value.id,\n        label: value.displayName\n      }]);\n    }\n  }\n\n  const onSelectFocus = async () => {\n    if (!isLoaded) {\n      const {\n        legendSets\n      } = await engine.query(query);\n\n      if (legendSets) {\n        const options = legendSets.legendSets.map(legendSet => ({\n          value: legendSet.id,\n          label: legendSet.name\n        }));\n        setOptions(options);\n      }\n\n      setIsLoaded(true);\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(LegendSetSelect, {\n    loading: !isLoaded,\n    value: value,\n    options: options,\n    onChange: onChange,\n    onFocus: onSelectFocus,\n    dataTest: dataTest\n  });\n};\n\nLegendSet.propTypes = {\n  onChange: PropTypes.func.isRequired,\n  dataTest: PropTypes.string,\n  value: PropTypes.object\n};\n\nconst mapStateToProps = state => ({\n  value: sGetUiOption(state, {\n    id: OPTION_LEGEND_SET\n  })\n});\n\nconst mapDispatchToProps = dispatch => ({\n  onChange: _ref5 => {\n    let {\n      id,\n      displayName\n    } = _ref5;\n    return dispatch(acSetUiOption({\n      value: {\n        id,\n        displayName\n      },\n      optionId: OPTION_LEGEND_SET\n    }));\n  }\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(LegendSet);","import { LEGEND_DISPLAY_STRATEGY_BY_DATA_ITEM, LEGEND_DISPLAY_STRATEGY_FIXED } from '@dhis2/analytics';\nimport i18n from '@dhis2/d2-i18n';\nimport { Radio, Field } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { Fragment } from 'react';\nimport { connect } from 'react-redux';\nimport { acSetUiOption } from '../../../actions/ui.js';\nimport { OPTION_LEGEND_DISPLAY_STRATEGY } from '../../../modules/options.js';\nimport { sGetUiOption } from '../../../reducers/ui.js';\nimport styles from '../styles/VisualizationOptions.module.css';\nimport LegendSet from './LegendSet.js';\n\nconst LegendDisplayStrategy = _ref => {\n  let {\n    value,\n    onChange\n  } = _ref;\n  return /*#__PURE__*/React.createElement(Fragment, null, /*#__PURE__*/React.createElement(Field, {\n    name: OPTION_LEGEND_DISPLAY_STRATEGY,\n    dense: true\n  }, /*#__PURE__*/React.createElement(Radio, {\n    key: LEGEND_DISPLAY_STRATEGY_BY_DATA_ITEM,\n    label: i18n.t('Use pre-defined legend per data item'),\n    value: LEGEND_DISPLAY_STRATEGY_BY_DATA_ITEM,\n    checked: value === LEGEND_DISPLAY_STRATEGY_BY_DATA_ITEM,\n    onChange: onChange,\n    dense: true,\n    dataTest: \"legend-display-strategy-\".concat(LEGEND_DISPLAY_STRATEGY_BY_DATA_ITEM)\n  }), /*#__PURE__*/React.createElement(Radio, {\n    key: LEGEND_DISPLAY_STRATEGY_FIXED,\n    label: i18n.t('Select a single legend for the entire visualization'),\n    value: LEGEND_DISPLAY_STRATEGY_FIXED,\n    checked: value === LEGEND_DISPLAY_STRATEGY_FIXED,\n    onChange: onChange,\n    dense: true,\n    dataTest: \"legend-display-strategy-\".concat(LEGEND_DISPLAY_STRATEGY_FIXED)\n  })), value === LEGEND_DISPLAY_STRATEGY_FIXED ? /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.tabSectionOptionToggleable\n  }, /*#__PURE__*/React.createElement(LegendSet, {\n    dataTest: \"fixed-legend-set\"\n  })) : null);\n};\n\nLegendDisplayStrategy.propTypes = {\n  value: PropTypes.string.isRequired,\n  onChange: PropTypes.func.isRequired\n};\n\nconst mapStateToProps = state => ({\n  value: sGetUiOption(state, {\n    id: OPTION_LEGEND_DISPLAY_STRATEGY\n  })\n});\n\nconst mapDispatchToProps = dispatch => ({\n  onChange: _ref2 => {\n    let {\n      value\n    } = _ref2;\n    return dispatch(acSetUiOption({\n      optionId: OPTION_LEGEND_DISPLAY_STRATEGY,\n      value\n    }));\n  }\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(LegendDisplayStrategy);","import { Field, Radio } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { acSetUiOption, acSetUiOptions } from '../../../actions/ui.js';\nimport { sGetUiOption, sGetUiOptions } from '../../../reducers/ui.js';\n\nconst RadioBaseOption = _ref => {\n  let {\n    option,\n    label,\n    value,\n    onChange,\n    disabled,\n    dataTest\n  } = _ref;\n  return /*#__PURE__*/React.createElement(Field, {\n    name: option.name,\n    label: label,\n    dense: true\n  }, option.items.map(_ref2 => {\n    let {\n      id,\n      label\n    } = _ref2;\n    return /*#__PURE__*/React.createElement(Radio, {\n      key: id,\n      label: label,\n      value: id,\n      checked: value === id,\n      onChange: _ref3 => {\n        let {\n          value\n        } = _ref3;\n        return onChange(value);\n      },\n      disabled: disabled,\n      dense: true,\n      dataTest: \"\".concat(dataTest, \"-option-\").concat(id)\n    });\n  }));\n};\n\nRadioBaseOption.propTypes = {\n  option: PropTypes.object.isRequired,\n  value: PropTypes.oneOfType([PropTypes.string, PropTypes.number]).isRequired,\n  onChange: PropTypes.func.isRequired,\n  dataTest: PropTypes.string,\n  disabled: PropTypes.bool,\n  label: PropTypes.string\n};\n\nconst mapStateToProps = (state, ownProps) => ({\n  value: ownProps.option.id ? sGetUiOption(state, {\n    id: ownProps.option.id\n  }) : sGetUiOptions(state)[ownProps.option.name]\n});\n\nconst mapDispatchToProps = (dispatch, ownProps) => ({\n  onChange: value => ownProps.option.id ? dispatch(acSetUiOption({\n    optionId: ownProps.option.id,\n    value\n  })) : dispatch(acSetUiOptions({\n    [ownProps.option.name]: value\n  }))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(RadioBaseOption);","import { LEGEND_DISPLAY_STYLE_FILL, LEGEND_DISPLAY_STYLE_TEXT } from '@dhis2/analytics';\nimport i18n from '@dhis2/d2-i18n';\nimport React from 'react';\nimport { OPTION_LEGEND_DISPLAY_STYLE } from '../../../modules/options.js';\nimport RadioBaseOption from './RadioBaseOption.js';\n\nconst LegendDisplayStyle = () => /*#__PURE__*/React.createElement(RadioBaseOption, {\n  option: {\n    id: OPTION_LEGEND_DISPLAY_STYLE,\n    items: [{\n      id: LEGEND_DISPLAY_STYLE_FILL,\n      label: i18n.t('Legend changes background color')\n    }, {\n      id: LEGEND_DISPLAY_STYLE_TEXT,\n      label: i18n.t('Legend changes text color')\n    }]\n  },\n  dataTest: 'legend-display-style'\n});\n\nexport default LegendDisplayStyle;","import i18n from '@dhis2/d2-i18n';\nimport React from 'react';\nimport { OPTION_SHOW_LEGEND_KEY } from '../../../modules/options.js';\nimport CheckboxBaseOption from './CheckboxBaseOption.js';\n\nconst ShowLegendKey = () => /*#__PURE__*/React.createElement(CheckboxBaseOption, {\n  label: i18n.t('Show legend key'),\n  option: {\n    id: OPTION_SHOW_LEGEND_KEY\n  },\n  dataTest: 'option-legend-key'\n});\n\nexport default ShowLegendKey;","import { LEGEND_DISPLAY_STRATEGY_BY_DATA_ITEM, LEGEND_DISPLAY_STRATEGY_FIXED, LEGEND_DISPLAY_STYLE_FILL } from '@dhis2/analytics';\nimport i18n from '@dhis2/d2-i18n';\nimport { Checkbox, FieldSet, Legend as UiCoreLegend } from '@dhis2/ui';\nimport cx from 'classnames';\nimport PropTypes from 'prop-types';\nimport React, { useState } from 'react';\nimport { connect } from 'react-redux';\nimport { acSetUiOption } from '../../../actions/ui.js';\nimport { OPTION_LEGEND_DISPLAY_STRATEGY, OPTION_LEGEND_DISPLAY_STYLE, OPTION_LEGEND_SET } from '../../../modules/options.js';\nimport { sGetUiOption } from '../../../reducers/ui.js';\nimport styles from '../styles/VisualizationOptions.module.css';\nimport LegendDisplayStrategy from './LegendDisplayStrategy.js';\nimport LegendDisplayStyle from './LegendDisplayStyle.js';\nimport ShowLegendKey from './ShowLegendKey.js';\n\nconst Legend = _ref => {\n  let {\n    legendSet,\n    legendDisplayStrategy,\n    onChange,\n    hideStyleOptions\n  } = _ref;\n  const [legendEnabled, setLegendEnabled] = useState(!((!legendDisplayStrategy || legendDisplayStrategy === LEGEND_DISPLAY_STRATEGY_FIXED) && !legendSet));\n\n  const onCheckboxChange = _ref2 => {\n    let {\n      checked\n    } = _ref2;\n    setLegendEnabled(checked);\n\n    if (checked) {\n      onChange({\n        optionId: OPTION_LEGEND_DISPLAY_STRATEGY,\n        value: LEGEND_DISPLAY_STRATEGY_BY_DATA_ITEM\n      });\n      onChange({\n        optionId: OPTION_LEGEND_DISPLAY_STYLE,\n        value: LEGEND_DISPLAY_STYLE_FILL\n      });\n    } else {\n      onChange({\n        optionId: OPTION_LEGEND_DISPLAY_STRATEGY,\n        value: LEGEND_DISPLAY_STRATEGY_FIXED\n      });\n      onChange({\n        optionId: OPTION_LEGEND_SET,\n        value: undefined\n      });\n      onChange({\n        optionId: OPTION_LEGEND_DISPLAY_STYLE,\n        value: undefined\n      });\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.tabSectionOptionToggleable\n  }, /*#__PURE__*/React.createElement(Checkbox, {\n    checked: legendEnabled,\n    label: i18n.t('Use legend for chart colors'),\n    onChange: onCheckboxChange,\n    dense: true\n  }), legendEnabled ? /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.tabSectionOptionToggleable\n  }, !hideStyleOptions ? /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.tabSectionOption\n  }, /*#__PURE__*/React.createElement(FieldSet, null, /*#__PURE__*/React.createElement(UiCoreLegend, null, /*#__PURE__*/React.createElement(\"span\", {\n    className: cx(styles.tabSectionTitle, styles.tabSectionTitleMargin)\n  }, i18n.t('Legend style'))), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.tabSectionOption\n  }, /*#__PURE__*/React.createElement(LegendDisplayStyle, null)))) : null, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.tabSectionOption\n  }, /*#__PURE__*/React.createElement(FieldSet, null, /*#__PURE__*/React.createElement(UiCoreLegend, null, /*#__PURE__*/React.createElement(\"span\", {\n    className: cx(styles.tabSectionTitle, {\n      [styles.tabSectionTitleMargin]: hideStyleOptions\n    })\n  }, i18n.t('Legend type'))), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.tabSectionOption\n  }, /*#__PURE__*/React.createElement(LegendDisplayStrategy, null)))), /*#__PURE__*/React.createElement(\"div\", null, /*#__PURE__*/React.createElement(ShowLegendKey, null))) : null);\n};\n\nLegend.propTypes = {\n  onChange: PropTypes.func.isRequired,\n  hideStyleOptions: PropTypes.bool,\n  legendDisplayStrategy: PropTypes.string,\n  legendSet: PropTypes.object\n};\n\nconst mapStateToProps = state => ({\n  legendSet: sGetUiOption(state, {\n    id: OPTION_LEGEND_SET\n  }),\n  legendDisplayStrategy: sGetUiOption(state, {\n    id: OPTION_LEGEND_DISPLAY_STRATEGY\n  })\n});\n\nconst mapDispatchToProps = dispatch => ({\n  onChange: params => dispatch(acSetUiOption(params))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Legend);","function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport i18n from '@dhis2/d2-i18n';\nimport { Button, Input, Label, SingleSelect, SingleSelectOption } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { acSetUiOptions } from '../../../actions/ui.js';\nimport { sGetUiOptions } from '../../../reducers/ui.js';\nimport styles from '../styles/VisualizationOptions.module.css';\n\nconst OperatorSelect = _ref => {\n  let {\n    name,\n    value,\n    onChange\n  } = _ref;\n  const options = [{\n    id: 'EQ',\n    label: '='\n  }, {\n    id: 'GT',\n    label: '>'\n  }, {\n    id: 'GE',\n    label: '>='\n  }, {\n    id: 'LT',\n    label: '<'\n  }, {\n    id: 'LE',\n    label: '<='\n  }];\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      width: '112px'\n    }\n  }, /*#__PURE__*/React.createElement(SingleSelect, {\n    name: name,\n    onChange: _ref2 => {\n      let {\n        selected\n      } = _ref2;\n      onChange(selected);\n    },\n    selected: value,\n    tabIndex: \"0\",\n    inputMaxWidth: \"106px\",\n    dense: true\n  }, options.map(_ref3 => {\n    let {\n      id,\n      label\n    } = _ref3;\n    return /*#__PURE__*/React.createElement(SingleSelectOption, {\n      key: id,\n      value: id,\n      label: label\n    });\n  })));\n};\n\nOperatorSelect.propTypes = {\n  name: PropTypes.string.isRequired,\n  value: PropTypes.string.isRequired,\n  onChange: PropTypes.func.isRequired\n};\n\nconst ValueInput = _ref4 => {\n  let {\n    name,\n    value,\n    onChange\n  } = _ref4;\n  return /*#__PURE__*/React.createElement(Input, {\n    name: name,\n    value: value,\n    type: \"number\",\n    onChange: _ref5 => {\n      let {\n        value\n      } = _ref5;\n      return onChange(value);\n    },\n    width: \"72px\",\n    dense: true\n  });\n};\n\nValueInput.propTypes = {\n  name: PropTypes.string.isRequired,\n  value: PropTypes.string.isRequired,\n  onChange: PropTypes.func.isRequired\n};\n\nclass MeasureCriteria extends Component {\n  constructor(props) {\n    super(props);\n\n    _defineProperty(this, \"onClear\", () => this.setState(this.defaultState, this.props.onChange('')));\n\n    _defineProperty(this, \"onChange\", name => value => {\n      this.setState({\n        [name]: value\n      }, () => {\n        const {\n          op1,\n          v1,\n          op2,\n          v2\n        } = this.state;\n        const value = [];\n\n        if (op1 && v1) {\n          value.push(\"\".concat(op1, \":\").concat(v1));\n        }\n\n        if (op2 && v2) {\n          value.push(\"\".concat(op2, \":\").concat(v2));\n        }\n\n        this.props.onChange(value.length > 0 ? value.join(';') : '');\n      });\n    });\n\n    this.defaultState = {\n      op1: '',\n      v1: '',\n      op2: '',\n      v2: ''\n    };\n    const [_op = '', _v = '', _op2 = '', _v2 = ''] = props.value.split(/[;:]/);\n    this.state = {\n      op1: _op,\n      v1: _v,\n      op2: _op2,\n      v2: _v2\n    };\n  }\n\n  render() {\n    const {\n      op1,\n      v1,\n      op2,\n      v2\n    } = this.state;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: styles.tabSectionOption\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      className: styles.tabSectionOptionText\n    }, i18n.t('You can set a minimum or maximum value. This will apply to the entire visualization, all values outside of the minimum/maximum range will not be displayed')), /*#__PURE__*/React.createElement(\"div\", {\n      className: styles.tabSectionOptionComplexInline\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        width: '250px'\n      }\n    }, /*#__PURE__*/React.createElement(Label, null, i18n.t('Minimum data value')), /*#__PURE__*/React.createElement(\"div\", {\n      className: styles.tabSectionOptionComplexInline\n    }, /*#__PURE__*/React.createElement(OperatorSelect, {\n      name: \"op1\",\n      value: op1,\n      onChange: this.onChange('op1')\n    }), /*#__PURE__*/React.createElement(ValueInput, {\n      name: \"v1\",\n      value: v1,\n      onChange: this.onChange('v1')\n    }))), /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        width: '250px'\n      }\n    }, /*#__PURE__*/React.createElement(Label, null, i18n.t('Maximum data value')), /*#__PURE__*/React.createElement(\"div\", {\n      className: styles.tabSectionOptionComplexInline\n    }, /*#__PURE__*/React.createElement(OperatorSelect, {\n      name: \"op2\",\n      value: op2,\n      onChange: this.onChange('op2')\n    }), /*#__PURE__*/React.createElement(ValueInput, {\n      name: \"v2\",\n      value: v2,\n      onChange: this.onChange('v2')\n    })))), /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        paddingTop: '16px'\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      onClick: this.onClear\n    }, i18n.t('Clear min/max limits'))));\n  }\n\n}\n\nMeasureCriteria.propTypes = {\n  value: PropTypes.string,\n  onChange: PropTypes.func\n};\n\nconst mapStateToProps = state => ({\n  value: sGetUiOptions(state).measureCriteria || ''\n});\n\nconst mapDispatchToProps = dispatch => ({\n  onChange: value => dispatch(acSetUiOptions({\n    measureCriteria: value\n  }))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(MeasureCriteria);","import { VIS_TYPE_PIVOT_TABLE } from '@dhis2/analytics';\nimport lineListConfig from './lineListConfig.js';\nimport pivotTableConfig from './pivotTableConfig.js';\nexport const getOptionsByType = type => {\n  switch (type) {\n    case VIS_TYPE_PIVOT_TABLE:\n      return pivotTableConfig();\n\n    default:\n      return lineListConfig();\n  }\n};","/* eslint-disable react/jsx-key */\nimport i18n from '@dhis2/d2-i18n';\nimport React from 'react';\nimport ColSubTotals from '../../components/VisualizationOptions/Options/ColSubTotals.js';\nimport ColTotals from '../../components/VisualizationOptions/Options/ColTotals.js';\nimport DigitGroupSeparator from '../../components/VisualizationOptions/Options/DigitGroupSeparator.js';\nimport DisplayDensity from '../../components/VisualizationOptions/Options/DisplayDensity.js';\nimport FontSize from '../../components/VisualizationOptions/Options/FontSize.js';\nimport HideEmptyRows from '../../components/VisualizationOptions/Options/HideEmptyRows.js';\nimport RowSubTotals from '../../components/VisualizationOptions/Options/RowSubTotals.js';\nimport RowTotals from '../../components/VisualizationOptions/Options/RowTotals.js';\nimport ShowDimensionLabels from '../../components/VisualizationOptions/Options/ShowDimensionLabels.js';\nimport ShowHierarchy from '../../components/VisualizationOptions/Options/ShowHierarchy.js';\nimport Title from '../../components/VisualizationOptions/Options/Title.js';\nimport getDisplayTemplate from './sections/templates/display.js';\nimport getEmptyDataTemplate from './sections/templates/emptyData.js';\nimport getTotalsTemplate from './sections/templates/totals.js';\nimport getDataTab from './tabs/data.js';\nimport getLegendTab from './tabs/legend.js';\nimport getLimitValuesTab from './tabs/limitValues.js';\nimport getStyleTab from './tabs/style.js';\nexport default (() => [getDataTab([getDisplayTemplate({\n  content: React.Children.toArray([/*#__PURE__*/React.createElement(ShowHierarchy, null), /*#__PURE__*/React.createElement(ShowDimensionLabels, null)])\n}), getTotalsTemplate({\n  content: React.Children.toArray([/*#__PURE__*/React.createElement(ColTotals, null), /*#__PURE__*/React.createElement(ColSubTotals, null), /*#__PURE__*/React.createElement(RowTotals, null), /*#__PURE__*/React.createElement(RowSubTotals, null)])\n}), getEmptyDataTemplate({\n  content: React.Children.toArray([/*#__PURE__*/React.createElement(HideEmptyRows, null) //TODO: hide n/a data\n  ])\n})]), getLegendTab(), getStyleTab([{\n  key: 'style-section-1',\n  content: React.Children.toArray([/*#__PURE__*/React.createElement(Title, {\n    label: i18n.t('Table title')\n  }), /*#__PURE__*/React.createElement(DisplayDensity, null), /*#__PURE__*/React.createElement(FontSize, null), /*#__PURE__*/React.createElement(DigitGroupSeparator, null)])\n}]), getLimitValuesTab() // TODO: include these two options instead\n//Limit the number of rows shown in the table\n//Only show the [top/bottom] x rows\n]);","import i18n from '@dhis2/d2-i18n';\nexport default (content => ({\n  key: 'data-tab',\n  label: i18n.t('Data'),\n  content\n}));","/* eslint-disable react/jsx-key */\nimport i18n from '@dhis2/d2-i18n';\nimport React from 'react';\nimport Legend from '../../../components/VisualizationOptions/Options/Legend.js';\nexport default (() => ({\n  key: 'legend-tab',\n  label: i18n.t('Legend'),\n  content: [{\n    key: 'legend-section-1',\n    content: React.Children.toArray([/*#__PURE__*/React.createElement(Legend, null)])\n  }]\n}));","/* eslint-disable react/jsx-key */\nimport i18n from '@dhis2/d2-i18n';\nimport React from 'react';\nimport MeasureCriteria from '../../../components/VisualizationOptions/Options/MeasureCriteria.js';\nexport default (() => ({\n  key: 'limitValues-tab',\n  label: i18n.t('Limit values'),\n  content: [\n  /*\n  {\n      key: 'limitValues-limit-numbers',\n      label: i18n.t('Limit number of values'),\n      content: [<TopLimit />],\n  },*/\n  {\n    key: 'limitValues-limit-min-max',\n    label: i18n.t('Limit minimum/maximum values'),\n    content: React.Children.toArray([/*#__PURE__*/React.createElement(MeasureCriteria, null)])\n  }]\n}));","/* eslint-disable react/jsx-key */\nimport React from 'react';\nimport DigitGroupSeparator from '../../components/VisualizationOptions/Options/DigitGroupSeparator.js';\nimport DisplayDensity from '../../components/VisualizationOptions/Options/DisplayDensity.js';\nimport FontSize from '../../components/VisualizationOptions/Options/FontSize.js';\nimport getStyleTab from './tabs/style.js';\nexport default (() => [getStyleTab([{\n  key: 'style-section-1',\n  content: React.Children.toArray([/*#__PURE__*/React.createElement(DisplayDensity, null), /*#__PURE__*/React.createElement(FontSize, null), /*#__PURE__*/React.createElement(DigitGroupSeparator, null)])\n}])]);","import { VisualizationOptions } from '@dhis2/analytics';\nimport i18n from '@dhis2/d2-i18n';\nimport React, { useState } from 'react';\nimport { getOptionsByType } from '../../modules/options/config.js';\nimport MenuButton from '../Toolbar/MenuBar/MenuButton.js';\nimport UpdateVisualizationContainer from '../UpdateButton/UpdateVisualizationContainer.js';\n\nconst VisualizationOptionsManager = () => {\n  const [dialogIsOpen, setDialogIsOpen] = useState(false);\n\n  const onClick = handler => {\n    handler();\n    setDialogIsOpen(false);\n  };\n\n  const optionsConfig = getOptionsByType();\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(MenuButton, {\n    \"data-test\": 'app-menubar-options-button',\n    onClick: () => setDialogIsOpen(true)\n  }, i18n.t('Options')), dialogIsOpen && /*#__PURE__*/React.createElement(UpdateVisualizationContainer, {\n    renderComponent: handler => /*#__PURE__*/React.createElement(VisualizationOptions, {\n      optionsConfig: optionsConfig,\n      onUpdate: () => onClick(handler),\n      onClose: () => setDialogIsOpen(false)\n    })\n  }));\n};\n\nexport default VisualizationOptionsManager;","import i18n from '@dhis2/d2-i18n';\nimport { IconChevronRight24, IconChevronLeft24 } from '@dhis2/ui';\nimport React from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { acSetUiDetailsPanelOpen } from '../../../actions/ui.js';\nimport { sGetCurrentId } from '../../../reducers/current.js';\nimport { sGetUiShowDetailsPanel } from '../../../reducers/ui.js';\nimport MenuButton from './MenuButton.js';\nimport styles from './styles/InterpretationsButton.module.css';\nexport const InterpretationsButton = () => {\n  const showDetailsPanel = useSelector(sGetUiShowDetailsPanel);\n  const id = useSelector(sGetCurrentId);\n  const dispatch = useDispatch();\n\n  const onClick = () => {\n    dispatch(acSetUiDetailsPanelOpen(!showDetailsPanel));\n  };\n\n  return /*#__PURE__*/React.createElement(MenuButton, {\n    disabled: !id,\n    onClick: onClick\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.iconWrapper\n  }, showDetailsPanel ? /*#__PURE__*/React.createElement(IconChevronRight24, null) : /*#__PURE__*/React.createElement(IconChevronLeft24, null)), i18n.t('Interpretations'));\n};","import { FileMenu, useCachedDataQuery, VIS_TYPE_LINE_LIST, visTypeDisplayNames } from '@dhis2/analytics';\nimport { useDataMutation, useAlert } from '@dhis2/app-runtime';\nimport i18n from '@dhis2/d2-i18n';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { tSetCurrent } from '../../../actions/current.js';\nimport { acSetVisualization } from '../../../actions/visualization.js';\nimport { getAlertTypeByStatusCode } from '../../../modules/error.js';\nimport history from '../../../modules/history.js';\nimport { aoCreatedInEventReportsApp, layoutHasProgramId } from '../../../modules/layoutValidation.js';\nimport { getVisualizationFromCurrent } from '../../../modules/visualization.js';\nimport { sGetCurrent } from '../../../reducers/current.js';\nimport { sGetVisualization } from '../../../reducers/visualization.js';\nimport { ToolbarDownloadDropdown } from '../../DownloadMenu/index.js';\nimport UpdateButton from '../../UpdateButton/UpdateButton.js';\nimport UpdateVisualizationContainer from '../../UpdateButton/UpdateVisualizationContainer.js';\nimport VisualizationOptionsManager from '../../VisualizationOptions/VisualizationOptionsManager.js';\nimport { InterpretationsButton } from './InterpretationsButton.js';\nimport classes from './styles/MenuBar.module.css';\nconst visualizationSaveMutation = {\n  type: 'create',\n  resource: 'eventVisualizations',\n  data: _ref => {\n    let {\n      visualization\n    } = _ref;\n    return visualization;\n  },\n  params: {\n    skipTranslations: true,\n    skipSharing: true\n  }\n};\nconst visualizationSaveAsMutation = {\n  type: 'update',\n  resource: 'eventVisualizations',\n  id: _ref2 => {\n    let {\n      visualization\n    } = _ref2;\n    return visualization.id;\n  },\n  data: _ref3 => {\n    let {\n      visualization\n    } = _ref3;\n    return visualization;\n  },\n  params: {\n    skipTranslations: true,\n    skipSharing: true\n  }\n};\n\nconst MenuBar = _ref4 => {\n  let {\n    dataTest,\n    current,\n    visualization,\n    apiObjectName,\n    setCurrent,\n    setVisualization\n  } = _ref4;\n  const {\n    currentUser\n  } = useCachedDataQuery();\n  const {\n    show: showAlert\n  } = useAlert(_ref5 => {\n    let {\n      message\n    } = _ref5;\n    return message;\n  }, _ref6 => {\n    let {\n      options\n    } = _ref6;\n    return options;\n  });\n\n  const onOpen = id => {\n    const path = \"/\".concat(id);\n\n    if (history.location.pathname === path) {\n      history.replace({\n        pathname: path\n      }, {\n        isOpening: true\n      });\n    } else {\n      history.push(path);\n    }\n  };\n\n  const onNew = () => {\n    if (history.location.pathname === '/') {\n      history.replace({\n        pathname: '/'\n      }, {\n        isResetting: true\n      });\n    } else {\n      history.push('/');\n    }\n  };\n\n  const onDelete = () => {\n    const deletedVisualization = current.name;\n    history.push('/');\n    showAlert({\n      message: i18n.t('\"{{deletedObject}}\" successfully deleted.', {\n        deletedObject: deletedVisualization\n      }),\n      options: {\n        success: true,\n        duration: 2000\n      }\n    });\n  };\n\n  const onRename = _ref7 => {\n    let {\n      name,\n      description\n    } = _ref7;\n    const updatedVisualization = { ...visualization\n    };\n    const updatedCurrent = { ...current\n    };\n\n    if (name) {\n      updatedVisualization.name = updatedCurrent.name = name;\n    }\n\n    if (description) {\n      updatedVisualization.description = updatedCurrent.description = description;\n    } else {\n      delete updatedVisualization.description;\n      delete updatedCurrent.description;\n    }\n\n    setVisualization(updatedVisualization);\n\n    if (visualization === current) {\n      setCurrent(updatedVisualization);\n    } else {\n      setCurrent(updatedCurrent);\n    }\n\n    showAlert({\n      message: i18n.t('Rename successful'),\n      options: {\n        success: true,\n        duration: 2000\n      }\n    });\n  };\n\n  const onSave = function () {\n    let details = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    let copy = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    const visualization = getVisualizationFromCurrent(current);\n    visualization.name = // name provided in Save dialog\n    details.name || // existing name when saving the same modified visualization\n    visualization.name || // new visualization with no name provided in Save dialog\n    i18n.t('Untitled {{visualizationType}} visualization, {{date}}', {\n      visualizationType: visTypeDisplayNames(VIS_TYPE_LINE_LIST),\n      date: new Date().toLocaleDateString(undefined, {\n        year: 'numeric',\n        month: 'short',\n        day: '2-digit'\n      })\n    });\n\n    if (details.description) {\n      visualization.description = details.description;\n    }\n\n    if (copy) {\n      delete visualization.id;\n      postVisualization({\n        visualization\n      });\n    } else {\n      putVisualization({\n        visualization\n      });\n    }\n  };\n\n  const onSaveComplete = function (res) {\n    let copy = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n    if (res.response.uid) {\n      const locationObject = {\n        pathname: \"/\".concat(res.response.uid)\n      };\n      const locationState = {\n        isSaving: true\n      }; // Save As\n\n      if (copy) {\n        history.push(locationObject, locationState);\n      } // Save\n      else {\n        history.replace(locationObject, locationState);\n      }\n    }\n  };\n\n  const onError = error => {\n    // TODO remove once tested\n    console.log('Error:', error);\n    const message = error.errorCode === 'E4030' ? i18n.t(\"This visualization can't be deleted because it is used on one or more dashboards\") : error.message;\n    showAlert({\n      message,\n      options: {\n        [getAlertTypeByStatusCode(error.httpStatusCode)]: true\n      }\n    });\n  };\n\n  const [postVisualization] = useDataMutation(visualizationSaveMutation, {\n    onComplete: onSaveComplete,\n    onError\n  });\n  const [putVisualization] = useDataMutation(visualizationSaveAsMutation, {\n    onComplete: res => onSaveComplete(res, true),\n    onError\n  });\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.menuBar,\n    \"data-test\": dataTest\n  }, /*#__PURE__*/React.createElement(UpdateVisualizationContainer, {\n    renderComponent: handler => /*#__PURE__*/React.createElement(UpdateButton, {\n      className: classes.updateButton,\n      onClick: handler,\n      small: true\n    })\n  }), /*#__PURE__*/React.createElement(FileMenu, {\n    currentUser: currentUser,\n    fileType: apiObjectName,\n    fileObject: current,\n    defaultFilterVisType: VIS_TYPE_LINE_LIST,\n    onOpen: onOpen,\n    onNew: onNew,\n    onRename: onRename,\n    onSave: layoutHasProgramId(current) && !aoCreatedInEventReportsApp(current) ? onSave : undefined,\n    onSaveAs: details => onSave(details, true),\n    onDelete: onDelete,\n    onError: onError\n  }), /*#__PURE__*/React.createElement(VisualizationOptionsManager, null), /*#__PURE__*/React.createElement(ToolbarDownloadDropdown, null), /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.flexGrow\n  }), /*#__PURE__*/React.createElement(InterpretationsButton, null));\n};\n\nMenuBar.propTypes = {\n  apiObjectName: PropTypes.string,\n  current: PropTypes.object,\n  dataTest: PropTypes.string,\n  setCurrent: PropTypes.func,\n  setVisualization: PropTypes.func,\n  visualization: PropTypes.object\n};\n\nconst mapStateToProps = state => ({\n  current: sGetCurrent(state),\n  visualization: sGetVisualization(state)\n});\n\nconst mapDispatchToProps = {\n  setCurrent: tSetCurrent,\n  setVisualization: acSetVisualization\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(MenuBar);","import { visTypeDisplayNames, VIS_TYPE_LINE_LIST } from '@dhis2/analytics';\nimport { IconVisualizationLinelist16 } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { visTypes } from '../../../modules/visualization.js';\nimport { sGetUiType } from '../../../reducers/ui.js';\nimport classes from './styles/VisualizationTypeSelector.module.css';\n\nconst VisualizationTypeSelector = _ref => {\n  let {\n    visualizationType\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.container\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.button\n  }, visualizationType === VIS_TYPE_LINE_LIST && /*#__PURE__*/React.createElement(IconVisualizationLinelist16, {\n    color: \"#4a5768\"\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    \"data-test\": \"visualization-type-selector-currently-selected-text\"\n  }, visTypeDisplayNames[visualizationType])));\n};\n\nVisualizationTypeSelector.propTypes = {\n  visualizationType: PropTypes.oneOf(visTypes.map(_ref2 => {\n    let {\n      type\n    } = _ref2;\n    return type;\n  }))\n};\n\nconst mapStateToProps = state => ({\n  visualizationType: sGetUiType(state)\n});\n\nexport default connect(mapStateToProps)(VisualizationTypeSelector);","import cx from 'classnames';\nimport React from 'react';\nimport classes from '../App.module.css';\nimport { default as MenuBar } from './MenuBar/MenuBar.js';\nimport { default as VisualizationTypeSelector } from './VisualizationTypeSelector/VisualizationTypeSelector.js';\nconst apiObjectName = 'eventVisualization'; // TODO move to App?\n\nexport const Toolbar = () => {\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(classes.sectionToolbar, classes.flexCt)\n  }, /*#__PURE__*/React.createElement(VisualizationTypeSelector, null), /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(classes.toolbarMenubar, classes.flexGrow1)\n  }, /*#__PURE__*/React.createElement(MenuBar, {\n    apiObjectName: apiObjectName,\n    dataTest: 'app-menubar'\n  })));\n};","import { VisTypeIcon, VIS_TYPE_LINE_LIST, useCachedDataQuery } from '@dhis2/analytics';\nimport { useDataQuery } from '@dhis2/app-runtime';\nimport i18n from '@dhis2/d2-i18n';\nimport { colors } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { acSetLoadError } from '../../actions/loader.js';\nimport { GenericError } from '../../assets/ErrorIcons.js';\nimport { EVENT_TYPE } from '../../modules/dataStatistics.js';\nimport { genericErrorTitle, isVisualizationError } from '../../modules/error.js';\nimport history from '../../modules/history.js';\nimport { sGetLoadError } from '../../reducers/loader.js';\nimport styles from './styles/StartScreen.module.css';\nconst mostViewedQuery = {\n  mostViewed: {\n    resource: 'dataStatistics/favorites',\n    params: _ref => {\n      let {\n        username\n      } = _ref;\n      return {\n        eventType: EVENT_TYPE,\n        pageSize: 6,\n        ...(username ? {\n          username\n        } : {})\n      };\n    }\n  }\n};\nconst visualizationsQuery = {\n  visualizations: {\n    resource: 'eventVisualizations',\n    params: _ref2 => {\n      let {\n        ids\n      } = _ref2;\n      return {\n        filter: \"id:in:[\".concat(ids.join(','), \"]\"),\n        fields: ['id', 'displayName~rename(name)', 'type']\n      };\n    }\n  }\n};\n\nconst useMostViewedVisualizations = (username, error, setLoadError) => {\n  const visualizations = useDataQuery(visualizationsQuery, {\n    lazy: true,\n    onError: error => setLoadError(error)\n  });\n  const mostViewed = useDataQuery(mostViewedQuery, {\n    lazy: !!error,\n    variables: {\n      username\n    },\n    onComplete: data => {\n      visualizations.refetch({\n        ids: data.mostViewed.map(obj => obj.id)\n      });\n    },\n    onError: error => setLoadError(error)\n  });\n  return {\n    mostViewed: visualizations.data ? visualizations.data.visualizations.eventVisualizations : undefined,\n    loading: mostViewed.loading || visualizations.loading,\n    fetching: mostViewed.fetching || visualizations.fetching,\n    error: mostViewed.error || visualizations.error\n  };\n};\n\nconst StartScreen = _ref3 => {\n  var _data$mostViewed;\n\n  let {\n    error,\n    setLoadError\n  } = _ref3;\n  const {\n    currentUser\n  } = useCachedDataQuery();\n  const data = useMostViewedVisualizations(currentUser.username, error, setLoadError);\n  /* TODO remove this when pivot tables are supported */\n\n  const mostViewed = data === null || data === void 0 ? void 0 : (_data$mostViewed = data.mostViewed) === null || _data$mostViewed === void 0 ? void 0 : _data$mostViewed.filter(vis => vis.type === VIS_TYPE_LINE_LIST);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.outer\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.inner\n  }, error ? /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.errorContainer,\n    \"data-test\": \"start-screen-error-container\"\n  }, isVisualizationError(error) ? /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.errorIcon\n  }, error.icon()), /*#__PURE__*/React.createElement(\"p\", {\n    className: styles.errorTitle\n  }, error.title), /*#__PURE__*/React.createElement(\"p\", {\n    className: styles.errorDescription\n  }, error.description)) : /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.errorIcon\n  }, GenericError()), /*#__PURE__*/React.createElement(\"p\", {\n    className: styles.errorTitle\n  }, genericErrorTitle), /*#__PURE__*/React.createElement(\"p\", {\n    className: styles.errorDescription\n  }, error.message || error))) : /*#__PURE__*/React.createElement(\"div\", {\n    \"data-test\": \"start-screen\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.section\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    className: styles.title,\n    \"data-test\": \"start-screen-primary-section-title\"\n  }, i18n.t('Getting started')), /*#__PURE__*/React.createElement(\"ul\", {\n    className: styles.guide\n  }, /*#__PURE__*/React.createElement(\"li\", {\n    className: styles.guideItem\n  }, i18n.t('All dimensions that you can use to build visualizations are shown in the sections in the left sidebar.')), /*#__PURE__*/React.createElement(\"li\", {\n    className: styles.guideItem\n  }, i18n.t('Add dimensions to the layout above.')), /*#__PURE__*/React.createElement(\"li\", {\n    className: styles.guideItem\n  }, i18n.t('Click a dimension to add or remove conditions.')))), (mostViewed === null || mostViewed === void 0 ? void 0 : mostViewed.length) > 0 && /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.section\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    className: styles.title,\n    \"data-test\": \"start-screen-secondary-section-title\"\n  }, i18n.t('Your most viewed line lists')), mostViewed.map((vis, index) => /*#__PURE__*/React.createElement(\"p\", {\n    key: index,\n    className: styles.visualization,\n    onClick: () => history.push(\"/\".concat(vis.id)),\n    \"data-test\": \"start-screen-most-viewed-list-item\"\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: styles.visIcon\n  }, /*#__PURE__*/React.createElement(VisTypeIcon, {\n    type: vis.type,\n    useSmall: true,\n    color: colors.grey600\n  })), /*#__PURE__*/React.createElement(\"span\", null, vis.name)))))));\n};\n\nStartScreen.propTypes = {\n  error: PropTypes.object,\n  setLoadError: PropTypes.func\n};\n\nconst mapStateToProps = state => ({\n  error: sGetLoadError(state)\n});\n\nconst mapDispatchToProps = dispatch => ({\n  setLoadError: error => dispatch(acSetLoadError(error))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(StartScreen);","import { useCachedDataQuery } from '@dhis2/analytics';\nimport { useDataEngine, useDataMutation } from '@dhis2/app-runtime';\nimport { CssVariables } from '@dhis2/ui';\nimport cx from 'classnames';\nimport React, { useState, useEffect, useRef } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { tSetCurrent } from '../actions/current.js';\nimport { acClearAll, acClearLoadError, acSetLoadError, acSetVisualizationLoading } from '../actions/loader.js';\nimport { acAddMetadata, tSetInitMetadata } from '../actions/metadata.js';\nimport { acSetUiFromVisualization, acAddParentGraphMap, acSetShowExpandedLayoutPanel } from '../actions/ui.js';\nimport { acSetVisualization } from '../actions/visualization.js';\nimport { EVENT_TYPE } from '../modules/dataStatistics.js';\nimport { emptyResponseError, genericServerError, visualizationNotFoundError } from '../modules/error.js';\nimport history from '../modules/history.js';\nimport { getDynamicTimeDimensionsMetadata } from '../modules/metadata.js';\nimport { SYSTEM_SETTINGS_DIGIT_GROUP_SEPARATOR } from '../modules/systemSettings.js';\nimport { getParentGraphMapFromVisualization } from '../modules/ui.js';\nimport { DERIVED_USER_SETTINGS_DISPLAY_NAME_PROPERTY } from '../modules/userSettings.js';\nimport { getDimensionMetadataFields, getDimensionMetadataFromVisualization, transformVisualization } from '../modules/visualization.js';\nimport { sGetCurrent } from '../reducers/current.js';\nimport { sGetIsVisualizationLoading, sGetLoadError } from '../reducers/loader.js';\nimport { sGetUiShowDetailsPanel } from '../reducers/ui.js';\nimport classes from './App.module.css';\nimport { default as DetailsPanel } from './DetailsPanel/DetailsPanel.js';\nimport { default as DialogManager } from './Dialogs/DialogManager.js';\nimport DndContext from './DndContext.js';\nimport { InterpretationModal } from './InterpretationModal/index.js';\nimport Layout from './Layout/Layout.js';\nimport LoadingMask from './LoadingMask/LoadingMask.js';\nimport { MainSidebar } from './MainSidebar/index.js';\nimport { default as TitleBar } from './TitleBar/TitleBar.js';\nimport { Toolbar } from './Toolbar/Toolbar.js';\nimport StartScreen from './Visualization/StartScreen.js';\nimport { Visualization } from './Visualization/Visualization.js';\nconst visualizationQuery = {\n  eventVisualization: {\n    resource: 'eventVisualizations',\n    id: _ref => {\n      let {\n        id\n      } = _ref;\n      return id;\n    },\n    // TODO: check if this list is what we need/want (copied from old ER)\n    params: _ref2 => {\n      let {\n        nameProp\n      } = _ref2;\n      return {\n        fields: ['*', 'columns[dimension,dimensionType,filter,programStage[id],optionSet[id],valueType,legendSet[id],repetition,items[dimensionItem~rename(id)]]', 'rows[dimension,dimensionType,filter,programStage[id],optionSet[id],valueType,legendSet[id],repetition,items[dimensionItem~rename(id)]]', 'filters[dimension,dimensionType,filter,programStage[id],optionSet[id],valueType,legendSet[id],repetition,items[dimensionItem~rename(id)]]', \"program[id,programType,\".concat(nameProp, \"~rename(name),displayEnrollmentDateLabel,displayIncidentDateLabel,displayIncidentDate,programStages[id,displayName~rename(name),repeatable]]\"), 'programStage[id,displayName~rename(name),displayExecutionDateLabel,displayDueDateLabel,hideDueDate,repeatable]', 'access,user[displayName,userCredentials[username]]', 'href', ...getDimensionMetadataFields(), 'dataElementDimensions[legendSet[id,name],dataElement[id,name]]', '!interpretations', '!userGroupAccesses', '!publicAccess', '!displayDescription', '!rewindRelativePeriods', '!userOrganisationUnit', '!userOrganisationUnitChildren', '!userOrganisationUnitGrandChildren', '!externalAccess', '!relativePeriods', '!columnDimensions', '!rowDimensions', '!filterDimensions', '!organisationUnitGroups', '!itemOrganisationUnitGroups', '!indicators', '!dataElements', '!dataElementOperands', '!dataElementGroups', '!dataSets', '!periods', '!organisationUnitLevels', '!organisationUnits']\n      };\n    }\n  }\n};\nconst dataStatisticsMutation = {\n  resource: 'dataStatistics',\n  params: _ref3 => {\n    let {\n      id\n    } = _ref3;\n    return {\n      favorite: id,\n      eventType: EVENT_TYPE\n    };\n  },\n  type: 'create'\n};\n\nconst App = () => {\n  const dataEngine = useDataEngine();\n  const [data, setData] = useState();\n  const [previousLocation, setPreviousLocation] = useState();\n  const [initialLoadIsComplete, setInitialLoadIsComplete] = useState(false);\n  const [postDataStatistics] = useDataMutation(dataStatisticsMutation);\n  const dispatch = useDispatch();\n  const current = useSelector(sGetCurrent);\n  const isLoading = useSelector(sGetIsVisualizationLoading);\n  const error = useSelector(sGetLoadError);\n  const showDetailsPanel = useSelector(sGetUiShowDetailsPanel);\n  const {\n    systemSettings,\n    rootOrgUnits,\n    userSettings\n  } = useCachedDataQuery();\n  const digitGroupSeparator = systemSettings[SYSTEM_SETTINGS_DIGIT_GROUP_SEPARATOR];\n  const interpretationsUnitRef = useRef();\n\n  const onInterpretationUpdate = () => {\n    interpretationsUnitRef.current.refresh();\n  };\n\n  const parseLocation = location => {\n    const pathParts = location.pathname.slice(1).split('/');\n    const id = pathParts[0];\n    const interpretationId = pathParts[2];\n    return {\n      id,\n      interpretationId\n    };\n  };\n\n  const loadVisualization = async location => {\n    dispatch(acSetVisualizationLoading(true));\n    const isExisting = location.pathname.length > 1;\n\n    if (isExisting) {\n      // /currentAnalyticalObject\n      // /${id}/\n      // /${id}/interpretation/${interpretationId}\n      const {\n        id\n      } = parseLocation(location);\n\n      try {\n        const data = await dataEngine.query(visualizationQuery, {\n          variables: {\n            id,\n            nameProp: userSettings[DERIVED_USER_SETTINGS_DISPLAY_NAME_PROPERTY]\n          }\n        });\n        setData(data);\n      } catch (fetchError) {\n        if (!error && fetchError) {\n          var _fetchError$details;\n\n          if (((_fetchError$details = fetchError.details) === null || _fetchError$details === void 0 ? void 0 : _fetchError$details.httpStatusCode) === 404) {\n            dispatch(acClearAll({\n              error: visualizationNotFoundError(),\n              digitGroupSeparator,\n              rootOrgUnits\n            }));\n          } else {\n            dispatch(acClearAll({\n              error: fetchError.details.message || genericServerError(),\n              digitGroupSeparator,\n              rootOrgUnits\n            }));\n          }\n        }\n      }\n    } else {\n      dispatch(acClearAll({\n        error: null,\n        digitGroupSeparator,\n        rootOrgUnits\n      }));\n      dispatch(acSetVisualizationLoading(false));\n    }\n\n    dispatch(acSetShowExpandedLayoutPanel(!isExisting));\n    setInitialLoadIsComplete(true);\n    setPreviousLocation(location.pathname);\n  };\n\n  const onResponseReceived = response => {\n    var _response$rows;\n\n    const itemsMetadata = Object.entries(response.metaData.items).reduce((obj, _ref4) => {\n      let [id, item] = _ref4;\n      obj[id] = {\n        id,\n        name: item.name || item.displayName,\n        displayName: item.displayName,\n        dimensionType: item.dimensionType || item.dimensionItemType,\n        code: item.code\n      };\n      return obj;\n    }, {});\n    dispatch(acAddMetadata(itemsMetadata));\n    dispatch(acSetVisualizationLoading(false));\n\n    if (!((_response$rows = response.rows) !== null && _response$rows !== void 0 && _response$rows.length)) {\n      dispatch(acSetLoadError(emptyResponseError()));\n    }\n  };\n\n  useEffect(() => {\n    dispatch(tSetInitMetadata(rootOrgUnits));\n    loadVisualization(history.location);\n    const unlisten = history.listen(_ref5 => {\n      var _location$state, _location$state2, _location$state3, _location$state4, _location$state5;\n\n      let {\n        location\n      } = _ref5;\n      const isSaving = (_location$state = location.state) === null || _location$state === void 0 ? void 0 : _location$state.isSaving;\n      const isOpening = (_location$state2 = location.state) === null || _location$state2 === void 0 ? void 0 : _location$state2.isOpening;\n      const isResetting = (_location$state3 = location.state) === null || _location$state3 === void 0 ? void 0 : _location$state3.isResetting;\n      const isModalOpening = (_location$state4 = location.state) === null || _location$state4 === void 0 ? void 0 : _location$state4.isModalOpening;\n      const isModalClosing = (_location$state5 = location.state) === null || _location$state5 === void 0 ? void 0 : _location$state5.isModalClosing;\n      const isValidLocationChange = previousLocation !== location.pathname && !isModalOpening && !isModalClosing; // TODO navigation confirm dialog\n\n      if (isSaving || isOpening || isResetting || isValidLocationChange) {\n        loadVisualization(location);\n      }\n    });\n    return () => unlisten && unlisten();\n  }, []);\n  useEffect(() => {\n    if (data !== null && data !== void 0 && data.eventVisualization) {\n      dispatch(tSetInitMetadata(rootOrgUnits));\n      const {\n        program,\n        programStage\n      } = data.eventVisualization;\n      const visualization = transformVisualization(data.eventVisualization);\n      const metadata = {\n        [program.id]: program,\n        ...getDimensionMetadataFromVisualization(visualization),\n        ...getDynamicTimeDimensionsMetadata(program, programStage)\n      };\n\n      if (programStage !== null && programStage !== void 0 && programStage.id) {\n        metadata[programStage.id] = programStage;\n      }\n\n      dispatch(acAddParentGraphMap(getParentGraphMapFromVisualization(visualization)));\n      dispatch(acSetVisualization(visualization));\n      dispatch(tSetCurrent(visualization));\n      dispatch(acSetUiFromVisualization(visualization, metadata));\n      postDataStatistics({\n        id: visualization.id\n      });\n      dispatch(acClearLoadError());\n    }\n  }, [data]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(classes.eventReportsApp, classes.flexCt, classes.flexDirCol)\n  }, /*#__PURE__*/React.createElement(Toolbar, null), /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(classes.sectionMain, classes.flexGrow1, classes.flexCt)\n  }, /*#__PURE__*/React.createElement(DndContext, null, /*#__PURE__*/React.createElement(MainSidebar, null), /*#__PURE__*/React.createElement(DialogManager, null), /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(classes.mainCenter, classes.flexGrow1, classes.flexBasis0, classes.flexCt, classes.flexDirCol)\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.mainCenterLayout\n  }, /*#__PURE__*/React.createElement(Layout, null)), /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.mainCenterTitlebar\n  }, /*#__PURE__*/React.createElement(TitleBar, null)), /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(classes.mainCenterCanvas, classes.flexGrow1)\n  }, initialLoadIsComplete && !current && !isLoading || error ? /*#__PURE__*/React.createElement(StartScreen, null) : /*#__PURE__*/React.createElement(React.Fragment, null, isLoading && /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.loadingCover\n  }, /*#__PURE__*/React.createElement(LoadingMask, null)), current && /*#__PURE__*/React.createElement(Visualization, {\n    visualization: current,\n    onResponseReceived: onResponseReceived\n  }), current && /*#__PURE__*/React.createElement(InterpretationModal, {\n    onInterpretationUpdate: onInterpretationUpdate\n  }))))), /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(classes.mainRight, {\n      [classes.hidden]: !showDetailsPanel\n    })\n  }, showDetailsPanel && current && /*#__PURE__*/React.createElement(DetailsPanel, {\n    interpretationsUnitRef: interpretationsUnitRef\n  }))), /*#__PURE__*/React.createElement(CssVariables, {\n    colors: true,\n    spacers: true,\n    theme: true\n  }));\n};\n\nexport default App;","import { combineReducers } from 'redux';\nimport current from './current.js';\nimport loader from './loader.js';\nimport metadata from './metadata.js';\nimport ui from './ui.js';\nimport visualization from './visualization.js'; // Reducers\n\nexport default combineReducers({\n  current,\n  loader,\n  metadata,\n  ui,\n  visualization\n});","import { createStore, applyMiddleware, compose } from 'redux';\nimport { createLogger } from 'redux-logger';\nimport reducer from './reducers/index.js';\n\nconst configureStore = middleware => {\n  // Enable Redux devtools if extension is installed instead of redux-logger\n  // const composeEnhancers =\n  //     window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\n  const composeEnhancers = typeof window === 'object' && window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ ? window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({\n    name: 'line-listing-app'\n  }) : compose;\n\n  if (!window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ && process.env.NODE_ENV !== 'production') {\n    middleware.push(createLogger());\n  }\n\n  return createStore(reducer, composeEnhancers(applyMiddleware(...middleware)));\n};\n\nexport default configureStore;","import { acAddMetadata } from '../actions/metadata.js';\nexport default (_ref => {\n  let {\n    dispatch\n  } = _ref;\n  return next => action => {\n    if (typeof action.metadata === 'object') {\n      if (Array.isArray(action.metadata)) {\n        dispatch(acAddMetadata(action.metadata.reduce((meta, obj) => ({ ...meta,\n          ...obj\n        }), {})));\n      } else {\n        dispatch(acAddMetadata(action.metadata));\n      }\n    }\n\n    next(action);\n  };\n});","//------------------------------------------------------------------------------\n// <auto-generated>\n// This code was generated by d2-i18n-generate.\n//\n// Changes to this file may cause incorrect behavior and will be lost if\n// the code is regenerated.\n// </auto-generated>\n//------------------------------------------------------------------------------\nimport i18n from '@dhis2/d2-i18n';\nimport enTranslations from './en/translations.json';\nconst namespace = 'default';\ni18n.addResources('en', namespace, enTranslations);\nexport default i18n;","import { CachedDataQueryProvider } from '@dhis2/analytics';\nimport { useDataEngine } from '@dhis2/app-runtime';\nimport React from 'react';\nimport { Provider as ReduxProvider } from 'react-redux';\nimport thunk from 'redux-thunk';\nimport App from './components/App.js';\nimport configureStore from './configureStore.js';\nimport metadataMiddleware from './middleware/metadata.js';\nimport { systemSettingsKeys } from './modules/systemSettings.js';\nimport { userSettingsKeys, USER_SETTINGS_DISPLAY_PROPERTY, DERIVED_USER_SETTINGS_DISPLAY_NAME_PROPERTY } from './modules/userSettings.js';\nimport './locales/index.js';\nconst query = {\n  currentUser: {\n    resource: 'me',\n    params: {\n      fields: 'id,username,displayName~rename(name)'\n    }\n  },\n  userSettings: {\n    resource: 'userSettings',\n    params: {\n      key: userSettingsKeys\n    }\n  },\n  systemSettings: {\n    resource: 'systemSettings',\n    params: {\n      key: systemSettingsKeys\n    }\n  },\n  rootOrgUnits: {\n    resource: 'organisationUnits',\n    params: {\n      fields: 'id,displayName,name',\n      userDataViewFallback: true,\n      paging: false\n    }\n  }\n};\n\nconst providerDataTransformation = _ref => {\n  let {\n    currentUser,\n    userSettings,\n    systemSettings,\n    rootOrgUnits\n  } = _ref;\n  return {\n    currentUser,\n    userSettings: { ...userSettings,\n      [DERIVED_USER_SETTINGS_DISPLAY_NAME_PROPERTY]: userSettings[USER_SETTINGS_DISPLAY_PROPERTY] === 'name' ? 'displayName' : 'displayShortName'\n    },\n    systemSettings,\n    rootOrgUnits: rootOrgUnits.organisationUnits\n  };\n};\n/*\n * The redux store is being created here and this should only happen once,\n * because having multiple store instances leads to very unpredictable behaviour.\n * To avoid having multiple stores, ensure this component only renders once,\n * so it should remain stateless and be the app's most outer container.\n */\n\n\nconst AppWrapper = () => {\n  const engine = useDataEngine();\n  const store = configureStore([thunk.withExtraArgument(engine), // FIXME: Not needed for ER? Pointed out by @edoardo\n  metadataMiddleware]);\n\n  if (window.Cypress) {\n    window.store = store;\n  }\n\n  return /*#__PURE__*/React.createElement(ReduxProvider, {\n    store: store\n  }, /*#__PURE__*/React.createElement(CachedDataQueryProvider, {\n    query: query,\n    dataTransformation: providerDataTransformation\n  }, /*#__PURE__*/React.createElement(App, null)));\n};\n\nexport default AppWrapper;","// extracted by mini-css-extract-plugin\nmodule.exports = {\"transferEmptyList\":\"Common_transferEmptyList__3AjGz\",\"transferRightHeader\":\"Common_transferRightHeader__2VlpC\",\"transferLeftHeader\":\"Common_transferLeftHeader__2IGJW\",\"transferLeftTitle\":\"Common_transferLeftTitle__3H4iL\",\"paragraph\":\"Common_paragraph__3VxuR\",\"mainSection\":\"Common_mainSection__2QDHi\",\"verticalCheckbox\":\"Common_verticalCheckbox__2dSan\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"tabBar\":\"VisualizationOptions_tabBar__2-HNI\",\"tabContent\":\"VisualizationOptions_tabContent__1ASSw\",\"tabSection\":\"VisualizationOptions_tabSection__NxL3p\",\"tabSectionContent\":\"VisualizationOptions_tabSectionContent__2cTBK\",\"tabSectionTitle\":\"VisualizationOptions_tabSectionTitle__26556\",\"tabSectionTitleMargin\":\"VisualizationOptions_tabSectionTitleMargin__3D7_X\",\"tabSectionOption\":\"VisualizationOptions_tabSectionOption__17Zgh\",\"inline\":\"VisualizationOptions_inline__1Iud5\",\"tabSectionOptionItem\":\"VisualizationOptions_tabSectionOptionItem__21vD5\",\"tabSectionOptionText\":\"VisualizationOptions_tabSectionOptionText__2njek\",\"tabSectionOptionToggleable\":\"VisualizationOptions_tabSectionOptionToggleable__ZKrUd\",\"tabSectionToggleableSubsection\":\"VisualizationOptions_tabSectionToggleableSubsection__xPFA8\",\"tabSectionOptionComplexInline\":\"VisualizationOptions_tabSectionOptionComplexInline__IBdjM\",\"tabSectionOptionIcon\":\"VisualizationOptions_tabSectionOptionIcon__2sJLj\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"Condition_container__2PHek\",\"caseSensitiveCheckbox\":\"Condition_caseSensitiveCheckbox__3uv1C\",\"checkboxOption\":\"Condition_checkboxOption__S7cPf\",\"legendSelect\":\"Condition_legendSelect___EFUK\",\"textInput\":\"Condition_textInput__AQhDP\",\"legendSetSelect\":\"Condition_legendSetSelect__1dcY7\",\"removeButton\":\"Condition_removeButton__CV_zW\",\"operatorSelect\":\"Condition_operatorSelect__3hqIy\",\"dateInput\":\"Condition_dateInput__3heyt\",\"numericInput\":\"Condition_numericInput__Dyc82\",\"phoneNumberInput\":\"Condition_phoneNumberInput__1lma6\",\"letterInput\":\"Condition_letterInput__f7gHP\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"chip\":\"Chip_chip__cOcF9\",\"content\":\"Chip_content__2Yjkb\",\"chipBase\":\"Chip_chipBase__3HkV9\",\"label\":\"Chip_label__Ev-rO\",\"primary\":\"Chip_primary__2fSQl\",\"secondary\":\"Chip_secondary__2nqee\",\"suffix\":\"Chip_suffix__9hvbv\",\"dragging\":\"Chip_dragging__2Lo-C\",\"active\":\"Chip_active__SU-SK\",\"insertBefore\":\"Chip_insertBefore__cMTwV\",\"insertAfter\":\"Chip_insertAfter__9GWsU\",\"showBlank\":\"Chip_showBlank__2QBy1\",\"isLast\":\"Chip_isLast__2SIaG\",\"chipEmpty\":\"Chip_chipEmpty__2QrQ6\",\"leftIcon\":\"Chip_leftIcon__76u7k\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"eventReportsApp\":\"App_eventReportsApp__1IBE2\",\"flexCt\":\"App_flexCt__1IpfG\",\"flexDirCol\":\"App_flexDirCol__1Cgay\",\"flexGrow1\":\"App_flexGrow1__8jN-Q\",\"flexBasis0\":\"App_flexBasis0__1mO1H\",\"sectionToolbar\":\"App_sectionToolbar__12zaV\",\"sectionMain\":\"App_sectionMain__YyINn\",\"mainRight\":\"App_mainRight__BzcXA\",\"hidden\":\"App_hidden__12ktD\",\"mainCenterCanvas\":\"App_mainCenterCanvas__2pvhq\",\"loadingCover\":\"App_loadingCover__1pu3p\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"infoIcon\":\"ConditionsManager_infoIcon__3srry\",\"separator\":\"ConditionsManager_separator__2T_O2\",\"tooltipReference\":\"ConditionsManager_tooltipReference__ma5Fs\",\"addConditionButton\":\"ConditionsManager_addConditionButton__1jGDJ\",\"tabBar\":\"ConditionsManager_tabBar__248fL\",\"repeatableWrapper\":\"ConditionsManager_repeatableWrapper__cO6PL\",\"repeatableInput\":\"ConditionsManager_repeatableInput__2jnGS\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"content\":\"DefaultAxis_content__VAbLV\",\"lastDropzone\":\"DefaultAxis_lastDropzone__3z6M5\",\"axisContainer\":\"DefaultAxis_axisContainer__q8XYW\",\"axisContainerLeft\":\"DefaultAxis_axisContainerLeft__npnSy\",\"label\":\"DefaultAxis_label__2sa1T\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"span\":\"common_span__Cp0Mh\",\"notAllowed\":\"common_notAllowed__2RH4c\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"panel\":\"DetailsPanel_panel__3HQiD\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"modalContent\":\"DimensionModal_modalContent__2kUc6\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"entry\":\"PeriodDimension_entry__Y5q0C\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"row\":\"StartEndDate_row___qRDM\",\"icon\":\"StartEndDate_icon__2X4KK\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"overlay\":\"DndContext_overlay__2PLTz\",\"dimensionItem\":\"DndContext_dimensionItem__2jlLE\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"dimensionItem\":\"DimensionItemBase_dimensionItem__qu6vh\",\"disabled\":\"DimensionItemBase_disabled__3xO8z\",\"dragging\":\"DimensionItemBase_dragging__2aWod\",\"selected\":\"DimensionItemBase_selected__3uYnx\",\"icon\":\"DimensionItemBase_icon__3_VJF\",\"label\":\"DimensionItemBase_label__1rTul\",\"primary\":\"DimensionItemBase_primary__1vIeP\",\"iconAndLabelWrapper\":\"DimensionItemBase_iconAndLabelWrapper__1ijf5\",\"secondary\":\"DimensionItemBase_secondary__20cw3\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"menuButton\":\"MenuButton_menuButton__1DWzl\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"ModalDownloadDropdown_container__3I5rL\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"Visualization_wrapper__ssRwb\",\"fetchIndicator\":\"Visualization_fetchIndicator__2FWs8\",\"fetching\":\"Visualization_fetching__35syS\",\"rotation\":\"Visualization_rotation__1ex8N\",\"stickyFooter\":\"Visualization_stickyFooter__19-kU\",\"footerCell\":\"Visualization_footerCell__3QmfI\",\"stickyNavigation\":\"Visualization_stickyNavigation__1dHYp\",\"dataTable\":\"Visualization_dataTable__2tAUH\",\"headerCell\":\"Visualization_headerCell__2Lvcq\",\"dimensionModalHandler\":\"Visualization_dimensionModalHandler__4hRkC\",\"fontSizeLarge\":\"Visualization_fontSizeLarge__1daMy\",\"fontSizeNormal\":\"Visualization_fontSizeNormal__2924D\",\"fontSizeSmall\":\"Visualization_fontSizeSmall__1uPuD\",\"sizeComfortable\":\"Visualization_sizeComfortable__1P4l7\",\"sizeNormal\":\"Visualization_sizeNormal__2XjQW\",\"sizeCompact\":\"Visualization_sizeCompact__3CJCt\",\"cell\":\"Visualization_cell__1Nv53\",\"error\":\"Visualization_error__3jNKn\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"iconButton\":\"IconButton_iconButton__2bUtk\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"DimensionMenu_button__2PTUx\",\"hidden\":\"DimensionMenu_hidden__2d8UQ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"tooltip\":\"Tooltip_tooltip__2SB4H\",\"list\":\"Tooltip_list__3YnyU\",\"item\":\"Tooltip_item__2A5po\",\"iconWrapper\":\"Tooltip_iconWrapper__3oGXn\",\"label\":\"Tooltip_label__1OqRb\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"dropZone\":\"DropZone_dropZone__2vr1l\",\"isOver\":\"DropZone_isOver__1Gltw\",\"isEmpty\":\"DropZone_isEmpty__wFgm2\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"ct\":\"DefaultLayout_ct__g44sy\",\"axisGroup\":\"DefaultLayout_axisGroup__1U48b\",\"axisGroupLeft\":\"DefaultLayout_axisGroupLeft__2zBGl\",\"axisGroupRight\":\"DefaultLayout_axisGroupRight__2mIMK\",\"columns\":\"DefaultLayout_columns__2b1mE\",\"rows\":\"DefaultLayout_rows__2OEBn\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"axisGroupLeft\":\"LineListLayout_axisGroupLeft__2V_pu\",\"axisGroupRight\":\"LineListLayout_axisGroupRight__W0bLg\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"Layout_container__iNjNx\",\"overflowContainer\":\"Layout_overflowContainer__NNhEO\",\"expanded\":\"Layout_expanded__1-qxf\",\"button\":\"Layout_button__alBlV\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"progress\":\"LoadingMask_progress__lij90\",\"outer\":\"LoadingMask_outer__WLmB4\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"InputOption_container__LZ-Ch\",\"selected\":\"InputOption_selected__1mHRB\",\"label\":\"InputOption_label__2NFiX\",\"header\":\"InputOption_header__f4LP6\",\"description\":\"InputOption_description__220eS\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"InputPanel_container__1gzZi\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"MainSidebarSection_container__770CK\",\"header\":\"MainSidebarSection_header__1ev0m\",\"list\":\"MainSidebarSection_list__DsSUB\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"MainSidebar_container__pD1UY\",\"main\":\"MainSidebar_main__dduRL\",\"accessory\":\"MainSidebar_accessory__2ZuTp\",\"hidden\":\"MainSidebar_hidden__1YPr-\",\"accessoryInner\":\"MainSidebar_accessoryInner__7uTeb\",\"padded\":\"MainSidebar_padded__2Eout\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"MenuItem_container__1bcNf\",\"selected\":\"MenuItem_selected__3J3UG\",\"icon\":\"MenuItem_icon__3WuSd\",\"label\":\"MenuItem_label__24aSP\",\"count\":\"MenuItem_count__FjJ6I\",\"dashed\":\"MenuItem_dashed__3I5Lv\",\"chevron\":\"MenuItem_chevron__3KRgO\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"ProgramDimensionsFilter_container__3Yn6W\",\"optionIcon\":\"ProgramDimensionsFilter_optionIcon__Eun2W\",\"option\":\"ProgramDimensionsFilter_option__3S4hI\",\"active\":\"ProgramDimensionsFilter_active__1-OyA\",\"disabled\":\"ProgramDimensionsFilter_disabled__1VVL1\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"scrollbox\":\"DimensionsList_scrollbox__2gqbB\",\"list\":\"DimensionsList_list__3YME8\",\"errorWrap\":\"DimensionsList_errorWrap__F02mo\",\"noResults\":\"DimensionsList_noResults__3VG-C\",\"loaderWrap\":\"DimensionsList_loaderWrap__2vHE8\",\"loadMoreWrap\":\"DimensionsList_loadMoreWrap__3hDWV\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"ProgramDimensionsPanel_container__1w1No\",\"section\":\"ProgramDimensionsPanel_section__3ettA\",\"bordered\":\"ProgramDimensionsPanel_bordered__CgudI\",\"helptext\":\"ProgramDimensionsPanel_helptext__3KF_I\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"rows\":\"ProgramSelect_rows__4lzXm\",\"columns\":\"ProgramSelect_columns__t6lxb\",\"stretch\":\"ProgramSelect_stretch__2sQrM\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"search\":\"YourDimensionsPanel_search__3sv7B\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"titleBar\":\"TitleBar_titleBar__2T_Zo\",\"cell\":\"TitleBar_cell__1Hoh9\",\"title\":\"TitleBar_title__feEes\",\"suffix\":\"TitleBar_suffix__ZpeRe\",\"titleUnsaved\":\"TitleBar_titleUnsaved__2QMMQ\",\"titleDirty\":\"TitleBar_titleDirty__1WtZH\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"iconWrapper\":\"InterpretationsButton_iconWrapper__1D7Q_\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"menuBar\":\"MenuBar_menuBar__1bQ7O\",\"updateButton\":\"MenuBar_updateButton__S7DT_\",\"flexGrow\":\"MenuBar_flexGrow__1THGo\"};"],"sourceRoot":""}